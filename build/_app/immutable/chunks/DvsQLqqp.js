var ir=Object.defineProperty;var or=(n,e,t)=>e in n?ir(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var vt=(n,e,t)=>or(n,typeof e!="symbol"?e+"":e,t);import{s as Pe,e as M,k as H,c as E,a as y,d as m,o as j,f as d,i as N,g as p,n as Ie,t as q,b as F,S as We,B as ot,u as ae,h as Z,P as Qe,H as xe,j as Ce,p as Ye,F as _t,q as kt,y as Fe,A as Ze,r as ar,v as fr,w as ur,x as cr,D as Ee,E as De,l as ce,R as gt,C as Be,M as dr,an as hr,V as Lt,O as St,T as mr,U as gr}from"./vexCXLX9.js";import{S as ze,i as Ue,b as Y,d as X,m as $,t as k,a as D,e as x,f as Ke,g as le,c as se,j as Ot}from"./Cdll-xsj.js";import{e as Se,u as Gt,o as Mn,d as _r}from"./DNXpXRYa.js";import{m as At,d as ul,j as En,i as pr,J as vr,K as br,a as zt,c as Dn,T as cl,u as Ut,o as Zt,e as Pt,W as kr,b as dl,C as hl,t as wr,E as yr}from"./DzLIgThl.js";import{t as qe}from"./DMk2eJ1b.js";import{f as Ir,u as Mr,i as Er}from"./-eX2sS6k.js";import{d as Jt,n as Nn,x as Dr,h as bt,t as Ht,l as Vn}from"./hvQ-lebT.js";import{d as at}from"./aTHIJebK.js";import{u as ml,c as Nr}from"./DWqM7rJl.js";import{c as Vr}from"./CP68AaU9.js";import{s as Cr}from"./DUr-hg7t.js";import{i as Tr,E as Br}from"./DJwc5h5t.js";import{P as Cn,N as Kt}from"./DVh6NZqM.js";import{ae as Tn,ah as Sr,af as It,ai as Or,ag as Bn,aj as Rr}from"./c_tn4Eog.js";import{T as He}from"./DzHlmjPS.js";import{T as Lr}from"./BsHho0_v.js";import{S as Mt}from"./Cmi_MrK3.js";import{C as Sn}from"./Cux5bsOp.js";import{C as On}from"./D8_ibWhm.js";import{M as Pr}from"./BoacWIEu.js";import{C as Rn}from"./CzvQehHf.js";import{I as Hr}from"./E_9Yx2fg.js";import{M as Ln}from"./Dq9WPRw5.js";import{B as Qt}from"./B2_kFBW1.js";import{C as jr}from"./BfKRbBRz.js";import{X as Ar}from"./4edIpoVY.js";import{E as zr}from"./BbEqRSGc.js";import{m as jt}from"./_0_gBwjO.js";import{c as gl}from"./4IaybXbe.js";import{F as Ur}from"./BohEa0oT.js";import{L as Wr}from"./Ql21FIhE.js";import{S as qr}from"./BdiJpjKL.js";import{f as Rt}from"./DOlMLN9E.js";import{F as Fr}from"./CU2r43ac.js";import"./B1Cj3nBs.js";function Jr(n){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class Gr{constructor(e="fp32"){vt(this,"worker",null);vt(this,"initialized",!1);vt(this,"dtype");vt(this,"requestQueue",[]);vt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new Jr,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Zr(n){let e,t,l,s,r,i,o,a,f,u,c,h,g,_,w,I,V,b,T,B,C,v,R,P,L,S;return{c(){e=M("div"),t=M("div"),l=M("div"),s=M("div"),i=H(),o=M("div"),a=M("div"),u=H(),c=M("div"),g=H(),_=M("div"),w=M("div"),V=H(),b=M("div"),B=H(),C=M("div"),R=H(),P=M("div"),this.h()},l(O){e=E(O,"DIV",{class:!0});var J=y(e);t=E(J,"DIV",{class:!0});var ee=y(t);l=E(ee,"DIV",{class:!0});var fe=y(l);s=E(fe,"DIV",{class:!0}),y(s).forEach(m),i=j(fe),o=E(fe,"DIV",{class:!0});var te=y(o);a=E(te,"DIV",{class:!0}),y(a).forEach(m),u=j(te),c=E(te,"DIV",{class:!0}),y(c).forEach(m),te.forEach(m),g=j(fe),_=E(fe,"DIV",{class:!0});var Q=y(_);w=E(Q,"DIV",{class:!0}),y(w).forEach(m),V=j(Q),b=E(Q,"DIV",{class:!0}),y(b).forEach(m),B=j(Q),C=E(Q,"DIV",{class:!0}),y(C).forEach(m),Q.forEach(m),R=j(fe),P=E(fe,"DIV",{class:!0}),y(P).forEach(m),fe.forEach(m),ee.forEach(m),J.forEach(m),this.h()},h(){d(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),d(a,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),d(c,"class",h=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),d(o,"class","grid grid-cols-3 gap-4"),d(w,"class",I=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),d(b,"class",T=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),d(C,"class",v=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),d(_,"class","grid grid-cols-4 gap-4"),d(P,"class",L=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),d(l,"class",S=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),d(t,"class","animate-pulse flex w-full"),d(e,"class","w-full mt-2 mb-2")},m(O,J){N(O,e,J),p(e,t),p(t,l),p(l,s),p(l,i),p(l,o),p(o,a),p(o,u),p(o,c),p(l,g),p(l,_),p(_,w),p(_,V),p(_,b),p(_,B),p(_,C),p(l,R),p(l,P)},p(O,[J]){J&1&&r!==(r=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&d(s,"class",r),J&1&&f!==(f=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&d(a,"class",f),J&1&&h!==(h=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&d(c,"class",h),J&1&&I!==(I=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&d(w,"class",I),J&1&&T!==(T=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&d(b,"class",T),J&1&&v!==(v=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&d(C,"class",v),J&1&&L!==(L=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&d(P,"class",L),J&1&&S!==(S=(O[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&d(l,"class",S)},i:Ie,o:Ie,d(O){O&&m(e)}}}function Kr(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Yt extends ze{constructor(e){super(),Ue(this,e,Kr,Zr,Pe,{size:0})}}function _l(n,e,t){const l=n.slice();return l[23]=e[t],l}function pl(n,e,t){const l=n.slice();return l[26]=e[t],l}function vl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=M("div"),l=q(t),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=y(e);l=F(i,t),i.forEach(m),this.h()},h(){d(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){N(r,e,i),p(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&Z(l,t)},d(r){r&&m(e)}}}function bl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=M("button"),l=q(t),s=H(),this.h()},l(u){e=E(u,"BUTTON",{class:!0});var c=y(e);l=F(c,t),s=j(c),c.forEach(m),this.h()},h(){var u,c;d(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){N(u,e,c),p(e,l),p(e,s),o||(a=ae(e,"click",f),o=!0)},p(u,c){var h,g;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&d(e,"class",r),c&2&&i!==(i=((g=(h=n[1])==null?void 0:h.annotation)==null?void 0:g.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),o=!1,a()}}}function kl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Se(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=wl(_l(n,i,a));return{c(){e=M("div"),l=q(t),s=H(),r=M("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0});var f=y(e);l=F(f,t),f.forEach(m),s=j(a),r=E(a,"DIV",{class:!0});var u=y(r);for(let c=0;c<o.length;c+=1)o[c].l(u);u.forEach(m),this.h()},h(){d(e,"class","text-sm mt-1.5 font-medium"),d(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){N(a,e,f),p(e,l),N(a,s,f),N(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&Z(l,t),f&280){i=Se(a[3]);let u;for(u=0;u<i.length;u+=1){const c=_l(a,i,u);o[u]?o[u].p(c,f):(o[u]=wl(c),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(m(e),m(s),m(r)),Qe(o,a)}}}function Qr(n){let e=n[23]+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&Z(t,e)},d(l){l&&m(t)}}}function Yr(n){let e=n[8].t("Other")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&Z(t,e)},d(l){l&&m(t)}}}function Xr(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&Z(t,e)},d(l){l&&m(t)}}}function $r(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&Z(t,e)},d(l){l&&m(t)}}}function xr(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ei(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ti(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&Z(t,e)},d(l){l&&m(t)}}}function li(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&Z(t,e)},d(l){l&&m(t)}}}function si(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ni(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ri(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ii(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&Z(t,e)},d(l){l&&m(t)}}}function oi(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&Z(t,e)},d(l){l&&m(t)}}}function ai(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&Z(t,e)},d(l){l&&m(t)}}}function fi(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&Z(t,e)},d(l){l&&m(t)}}}function wl(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?fi:u[23]==="followed_instructions_perfectly"?ai:u[23]==="showcased_creativity"?oi:u[23]==="positive_attitude"?ii:u[23]==="attention_to_detail"?ri:u[23]==="thorough_explanation"?ni:u[23]==="dont_like_the_style"?si:u[23]==="too_verbose"?li:u[23]==="not_helpful"?ti:u[23]==="not_factually_correct"?ei:u[23]==="didnt_fully_follow_instructions"?xr:u[23]==="refused_when_it_shouldnt_have"?$r:u[23]==="being_lazy"?Xr:u[23]==="other"?Yr:Qr}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=M("button"),a.c(),t=H(),this.h()},l(u){e=E(u,"BUTTON",{class:!0});var c=y(e);a.l(c),t=j(c),c.forEach(m),this.h()},h(){d(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){N(u,e,c),a.m(e,null),p(e,t),s||(r=ae(e,"click",f),s=!0)},p(u,c){n=u,o===(o=i(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&d(e,"class",l)},d(u){u&&m(e),a.d(),s=!1,r()}}}function ui(n){var _e;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,h,g,_,w,I,V,b=n[8].t("Awful")+"",T,B,C,v,R=n[8].t("Amazing")+"",P,L,S,O,J,ee,fe,te,Q,he,de,we,A,G=n[8].t("Save")+"",ue,ke,U,ie,oe,me=((_e=n[1])==null?void 0:_e.arena)&&vl(n),Me=Se(Array.from({length:10}).map(yl)),pe=[];for(let re=0;re<Me.length;re+=1)pe[re]=bl(pl(n,Me,re));let ye=n[3].length>0&&kl(n);return de=new Lr({props:{tags:n[2]}}),de.$on("delete",n[15]),de.$on("add",n[16]),{c(){me&&me.c(),e=H(),t=M("div"),l=M("div"),s=M("div"),i=q(r),o=H(),a=M("button"),a.innerHTML=f,u=H(),c=M("div"),h=M("div"),g=M("div");for(let re=0;re<pe.length;re+=1)pe[re].c();_=H(),w=M("div"),I=M("div"),V=q("1 - "),T=q(b),B=H(),C=M("div"),v=q("10 - "),P=q(R),L=H(),S=M("div"),ye&&ye.c(),O=H(),J=M("div"),ee=M("textarea"),te=H(),Q=M("div"),he=M("div"),Y(de.$$.fragment),we=H(),A=M("button"),ue=q(G),this.h()},l(re){me&&me.l(re),e=j(re),t=E(re,"DIV",{class:!0,id:!0});var ve=y(t);l=E(ve,"DIV",{class:!0});var Oe=y(l);s=E(Oe,"DIV",{class:!0});var Ae=y(s);i=F(Ae,r),Ae.forEach(m),o=j(Oe),a=E(Oe,"BUTTON",{"data-svelte-h":!0}),We(a)!=="svelte-1ew22ui"&&(a.innerHTML=f),Oe.forEach(m),u=j(ve),c=E(ve,"DIV",{class:!0});var K=y(c);h=E(K,"DIV",{class:!0});var z=y(h);g=E(z,"DIV",{class:!0});var ne=y(g);for(let rt=0;rt<pe.length;rt+=1)pe[rt].l(ne);ne.forEach(m),_=j(z),w=E(z,"DIV",{class:!0});var ge=y(w);I=E(ge,"DIV",{});var be=y(I);V=F(be,"1 - "),T=F(be,b),be.forEach(m),B=j(ge),C=E(ge,"DIV",{});var Ve=y(C);v=F(Ve,"10 - "),P=F(Ve,R),Ve.forEach(m),ge.forEach(m),z.forEach(m),K.forEach(m),L=j(ve),S=E(ve,"DIV",{});var Re=y(S);ye&&ye.l(Re),Re.forEach(m),O=j(ve),J=E(ve,"DIV",{class:!0});var Je=y(J);ee=E(Je,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),y(ee).forEach(m),Je.forEach(m),te=j(ve),Q=E(ve,"DIV",{class:!0});var nt=y(Q);he=E(nt,"DIV",{class:!0});var ft=y(he);X(de.$$.fragment,ft),ft.forEach(m),we=j(nt),A=E(nt,"BUTTON",{class:!0});var ut=y(A);ue=F(ut,G),ut.forEach(m),nt.forEach(m),ve.forEach(m),this.h()},h(){d(s,"class","text-sm font-medium"),d(l,"class","flex justify-between items-center"),d(g,"class","mt-1.5 w-fit flex gap-1 pb-5"),d(w,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),d(h,"class","relative w-fit"),d(c,"class","w-full flex justify-center"),d(ee,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),d(ee,"placeholder",fe=n[8].t("Feel free to add specific details")),d(ee,"rows","3"),d(J,"class","mt-2"),d(he,"class","flex items-end group"),d(A,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(Q,"class","mt-2 gap-1.5 flex justify-between"),d(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),d(t,"id",ke="message-feedback-"+n[1].id)},m(re,ve){me&&me.m(re,ve),N(re,e,ve),N(re,t,ve),p(t,l),p(l,s),p(s,i),p(l,o),p(l,a),p(t,u),p(t,c),p(c,h),p(h,g);for(let Oe=0;Oe<pe.length;Oe+=1)pe[Oe]&&pe[Oe].m(g,null);p(h,_),p(h,w),p(w,I),p(I,V),p(I,T),p(w,B),p(w,C),p(C,v),p(C,P),p(t,L),p(t,S),ye&&ye.m(S,null),p(t,O),p(t,J),p(J,ee),ot(ee,n[5]),p(t,te),p(t,Q),p(Q,he),$(de,he,null),p(Q,we),p(Q,A),p(A,ue),U=!0,ie||(oe=[ae(a,"click",n[11]),ae(ee,"input",n[14]),ae(A,"click",n[17])],ie=!0)},p(re,[ve]){var Ae;if((Ae=re[1])!=null&&Ae.arena?me?me.p(re,ve):(me=vl(re),me.c(),me.m(e.parentNode,e)):me&&(me.d(1),me=null),(!U||ve&256)&&r!==(r=re[8].t("How would you rate this response?")+"")&&Z(i,r),ve&66){Me=Se(Array.from({length:10}).map(yl));let K;for(K=0;K<Me.length;K+=1){const z=pl(re,Me,K);pe[K]?pe[K].p(z,ve):(pe[K]=bl(z),pe[K].c(),pe[K].m(g,null))}for(;K<pe.length;K+=1)pe[K].d(1);pe.length=Me.length}(!U||ve&256)&&b!==(b=re[8].t("Awful")+"")&&Z(T,b),(!U||ve&256)&&R!==(R=re[8].t("Amazing")+"")&&Z(P,R),re[3].length>0?ye?ye.p(re,ve):(ye=kl(re),ye.c(),ye.m(S,null)):ye&&(ye.d(1),ye=null),(!U||ve&256&&fe!==(fe=re[8].t("Feel free to add specific details")))&&d(ee,"placeholder",fe),ve&32&&ot(ee,re[5]);const Oe={};ve&4&&(Oe.tags=re[2]),de.$set(Oe),(!U||ve&256)&&G!==(G=re[8].t("Save")+"")&&Z(ue,G),(!U||ve&2&&ke!==(ke="message-feedback-"+re[1].id))&&d(t,"id",ke)},i(re){U||(k(de.$$.fragment,re),U=!0)},o(re){D(de.$$.fragment,re),U=!1},d(re){re&&(m(e),m(t)),me&&me.d(re),Qe(pe,re),ye&&ye.d(),x(de),ie=!1,xe(oe)}}}const yl=(n,e)=>e+1;function ci(n,e,t){let l,s;Ce(n,At,S=>t(18,s=S));const r=Ye("i18n");Ce(n,r,S=>t(8,l=S));const i=_t();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],h=[],g=null,_="",w=null,I=null;const V=()=>{var S,O,J,ee,fe;g||t(4,g=((S=o==null?void 0:o.annotation)==null?void 0:S.reason)??""),_||t(5,_=((O=o==null?void 0:o.annotation)==null?void 0:O.comment)??""),t(2,c=(((J=o==null?void 0:o.annotation)==null?void 0:J.tags)??[]).map(te=>({name:te}))),w||t(6,w=((fe=(ee=o==null?void 0:o.annotation)==null?void 0:ee.details)==null?void 0:fe.rating)??null)};kt(()=>{o!=null&&o.arena&&(t(7,I=s.find(S=>S.id===o.selectedModelId)),qe.success(l.t('This response was generated by "{{model}}"',{model:I?(I==null?void 0:I.name)??I.id:o.selectedModelId})))});const b=()=>{console.log("saveHandler"),i("save",{reason:g,comment:_,tags:c.map(S=>S.name),details:{rating:w}}),qe.success(l.t("Thanks for your feedback!")),t(0,a=!1)},T=()=>{t(0,a=!1)},B=S=>{t(6,w=S)},C=S=>{t(4,g=S)};function v(){_=this.value,t(5,_)}const R=S=>{t(2,c=c.filter(O=>O.name.replaceAll(" ","_").toLowerCase()!==S.detail.replaceAll(" ","_").toLowerCase()))},P=S=>{t(2,c=[...c,{name:S.detail}])},L=()=>{b()};return n.$$set=S=>{"message"in S&&t(1,o=S.message),"show"in S&&t(0,a=S.show)},n.$$.update=()=>{var S,O;n.$$.dirty&2&&(((S=o==null?void 0:o.annotation)==null?void 0:S.rating)===1?t(3,h=f):((O=o==null?void 0:o.annotation)==null?void 0:O.rating)===-1&&t(3,h=u)),n.$$.dirty&2&&o&&V()},[a,o,c,h,g,_,w,I,l,r,b,T,B,C,v,R,P,L]}class di extends ze{constructor(e){super(),Ue(this,e,ci,ui,Pe,{message:1,show:0})}}function Il(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function hi(n){let e,t;return e=new Sn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function mi(n){let e,t;return e=new On({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function gi(n){let e,t,l,s,r;const i=n[2].default,o=ar(i,n,n[4],null),a=[mi,hi],f=[];function u(c,h){return c[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=M("div"),o&&o.c(),t=H(),s.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var h=y(e);o&&o.l(h),t=j(h),s.l(h),h.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,h){N(c,e,h),o&&o.m(e,null),p(e,t),f[l].m(e,null),r=!0},p(c,h){o&&o.p&&(!r||h&16)&&fr(o,i,c,c[4],r?cr(i,c[4],h,null):ur(c[4]),null);let g=l;l=u(c),l!==g&&(le(),D(f[g],1,1,()=>{f[g]=null}),se(),s=f[l],s||(s=f[l]=a[l](c),s.c()),k(s,1),s.m(e,null))},i(c){r||(k(o,c),k(s),r=!0)},o(c){D(o,c),D(s),r=!1},d(c){c&&m(e),o&&o.d(c),f[l].d()}}}function Ml(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,h;return l=new Pr({}),{c(){e=M("a"),t=M("div"),Y(l.$$.fragment),s=H(),r=M("div"),o=q(i),a=H(),f=M("div"),f.innerHTML=u,this.h()},l(g){e=E(g,"A",{href:!0,target:!0,class:!0});var _=y(e);t=E(_,"DIV",{class:!0});var w=y(t);X(l.$$.fragment,w),s=j(w),r=E(w,"DIV",{class:!0});var I=y(r);o=F(I,i),I.forEach(m),w.forEach(m),a=j(_),f=E(_,"DIV",{class:!0,"data-svelte-h":!0}),We(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(m),this.h()},h(){d(r,"class","line-clamp-1"),d(t,"class","flex gap-2 items-center"),d(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",c="https://www.google.com/search?q="+n[0].query),d(e,"target","_blank"),d(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(g,_){N(g,e,_),p(e,t),$(l,t,null),p(t,s),p(t,r),p(r,o),p(e,a),p(e,f),h=!0},p(g,_){(!h||_&1)&&i!==(i=g[0].query+"")&&Z(o,i),(!h||_&1&&c!==(c="https://www.google.com/search?q="+g[0].query))&&d(e,"href",c)},i(g){h||(k(l.$$.fragment,g),h=!0)},o(g){D(l.$$.fragment,g),h=!1},d(g){g&&m(e),x(l)}}}function El(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=M("a"),t=M("div"),s=q(l),r=H(),i=M("div"),i.innerHTML=o,a=H(),this.h()},l(c){e=E(c,"A",{href:!0,target:!0,class:!0});var h=y(e);t=E(h,"DIV",{class:!0});var g=y(t);s=F(g,l),g.forEach(m),r=j(h),i=E(h,"DIV",{class:!0,"data-svelte-h":!0}),We(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=j(h),h.forEach(m),this.h()},h(){d(t,"class","line-clamp-1"),d(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",f=n[5]),d(e,"target","_blank"),d(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,h){N(c,e,h),p(e,t),p(t,s),p(e,r),p(e,i),p(e,a)},p(c,h){h&1&&l!==(l=c[5]+"")&&Z(s,l),h&1&&f!==(f=c[5])&&d(e,"href",f),h&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&d(e,"class",u)},d(c){c&&m(e)}}}function _i(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&Ml(n),r=Se(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=El(Il(n,r,a));return{c(){e=M("div"),s&&s.c(),t=H();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0,slot:!0});var f=y(e);s&&s.l(f),t=j(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){d(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),d(e,"slot","content")},m(a,f){N(a,e,f),s&&s.m(e,null),p(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&k(s,1)):(s=Ml(a),s.c(),k(s,1),s.m(e,t)):s&&(le(),D(s,1,1,()=>{s=null}),se()),f&1){r=Se(a[0].urls);let c;for(c=0;c<r.length;c+=1){const h=Il(a,r,c);i[c]?i[c].p(h,f):(i[c]=El(h),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(a){l||(k(s),l=!0)},o(a){D(s),l=!1},d(a){a&&m(e),s&&s.d(),Qe(i,a)}}}function pi(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[_i],default:[gi]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Tn({props:r}),Fe.push(()=>Ke(e,"open",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Ze(()=>t=!1)),e.$set(a)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function vi(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class bi extends ze{constructor(e){super(),Ue(this,e,vi,pi,Pe,{status:0})}}function ki(n){let e,t;return{c(){e=Ee("svg"),t=Ee("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),p(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:Ie,o:Ie,d(l){l&&m(e)}}}function wi(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class yi extends ze{constructor(e){super(),Ue(this,e,wi,ki,Pe,{className:0,strokeWidth:1})}}function Ii(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",o,a;return l=new Hr({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=M("div"),t=M("div"),Y(l.$$.fragment),s=H(),r=M("div"),o=q(i),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=y(e);t=E(u,"DIV",{class:!0});var c=y(t);X(l.$$.fragment,c),c.forEach(m),s=j(u),r=E(u,"DIV",{class:!0});var h=y(r);o=F(h,i),h.forEach(m),u.forEach(m),this.h()},h(){d(t,"class","self-start mt-0.5"),d(r,"class","self-center text-sm"),d(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){N(f,e,u),p(e,t),$(l,t,null),p(e,s),p(e,r),p(r,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&Z(o,i)},i(f){a||(k(l.$$.fragment,f),a=!0)},o(f){D(l.$$.fragment,f),a=!1},d(f){f&&m(e),x(l)}}}function Mi(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let Ei=class extends ze{constructor(e){super(),Ue(this,e,Mi,Ii,Pe,{content:0})}};function Dl(n,e,t){const l=n.slice();return l[9]=e[t],l[11]=t,l}function Di(n){const e=n.slice(),t=ji(e[9].distance);return e[12]=t,e}function Ni(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=M("div"),l=q(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){N(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&Z(l,t)},i:Ie,o:Ie,d(s){s&&m(e)}}}function Vi(n){let e,t,l,s;e=new He({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Ci]},$$scope:{ctx:n}}});let r=n[2]&&Vl(n);return{c(){Y(e.$$.fragment),t=H(),r&&r.c(),l=ce()},l(i){X(e.$$.fragment,i),t=j(i),r&&r.l(i),l=ce()},m(i,o){$(e,i,o),N(i,t,o),r&&r.m(i,o),N(i,l,o),s=!0},p(i,o){const a={};o&16&&(a.content=i[4].t("Open file")),o&8216&&(a.$$scope={dirty:o,ctx:i}),e.$set(a),i[2]?r?(r.p(i,o),o&4&&k(r,1)):(r=Vl(i),r.c(),k(r,1),r.m(l.parentNode,l)):r&&(le(),D(r,1,1,()=>{r=null}),se())},i(i){s||(k(e.$$.fragment,i),k(r),s=!0)},o(i){D(e.$$.fragment,i),D(r),s=!1},d(i){i&&(m(t),m(l)),x(e,i),r&&r.d(i)}}}function Nl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[9].metadata.page+1+"",o,a;return{c(){e=M("span"),t=q("("),s=q(l),r=H(),o=q(i),a=q(")"),this.h()},l(f){e=E(f,"SPAN",{class:!0});var u=y(e);t=F(u,"("),s=F(u,l),r=j(u),o=F(u,i),a=F(u,")"),u.forEach(m),this.h()},h(){d(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){N(f,e,u),p(e,t),p(e,s),p(e,r),p(e,o),p(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&Z(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&Z(o,i)},d(f){f&&m(e)}}}function Ci(n){var a,f,u,c;let e,t,l=decodeURIComponent(((f=(a=n[9])==null?void 0:a.metadata)==null?void 0:f.name)??n[9].source.name)+"",s,r,i,o=((c=(u=n[9])==null?void 0:u.metadata)==null?void 0:c.page)&&Nl(n);return{c(){e=M("div"),t=M("a"),s=q(l),i=H(),o&&o.c(),this.h()},l(h){e=E(h,"DIV",{class:!0});var g=y(e);t=E(g,"A",{class:!0,href:!0,target:!0});var _=y(t);s=F(_,l),_.forEach(m),i=j(g),o&&o.l(g),g.forEach(m),this.h()},h(){var h,g,_,w,I,V,b,T;d(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),d(t,"href",r=(g=(h=n[9])==null?void 0:h.metadata)!=null&&g.file_id?`${ul}/files/${(w=(_=n[9])==null?void 0:_.metadata)==null?void 0:w.file_id}/content${((V=(I=n[9])==null?void 0:I.metadata)==null?void 0:V.page)!==void 0?`#page=${n[9].metadata.page+1}`:""}`:(T=(b=n[9].source)==null?void 0:b.url)!=null&&T.includes("http")?n[9].source.url:"#"),d(t,"target","_blank"),d(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(h,g){N(h,e,g),p(e,t),p(t,s),p(e,i),o&&o.m(e,null)},p(h,g){var _,w,I,V,b,T,B,C,v,R,P,L;g&8&&l!==(l=decodeURIComponent(((w=(_=h[9])==null?void 0:_.metadata)==null?void 0:w.name)??h[9].source.name)+"")&&Z(s,l),g&8&&r!==(r=(V=(I=h[9])==null?void 0:I.metadata)!=null&&V.file_id?`${ul}/files/${(T=(b=h[9])==null?void 0:b.metadata)==null?void 0:T.file_id}/content${((C=(B=h[9])==null?void 0:B.metadata)==null?void 0:C.page)!==void 0?`#page=${h[9].metadata.page+1}`:""}`:(R=(v=h[9].source)==null?void 0:v.url)!=null&&R.includes("http")?h[9].source.url:"#")&&d(t,"href",r),(L=(P=h[9])==null?void 0:P.metadata)!=null&&L.page?o?o.p(h,g):(o=Nl(h),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(h){h&&m(e),o&&o.d()}}}function Vl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[Bi,Ti],u=[];function c(h,g){return h[9].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=M("div"),l=q(t),s=H(),i.c(),o=ce(),this.h()},l(h){e=E(h,"DIV",{class:!0});var g=y(e);l=F(g,t),g.forEach(m),s=j(h),i.l(h),o=ce(),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(h,g){N(h,e,g),p(e,l),N(h,s,g),u[r].m(h,g),N(h,o,g),a=!0},p(h,g){(!a||g&16)&&t!==(t=h[4].t("Relevance")+"")&&Z(l,t);let _=r;r=c(h),r===_?u[r].p(h,g):(le(),D(u[_],1,1,()=>{u[_]=null}),se(),i=u[r],i?i.p(h,g):(i=u[r]=f[r](h),i.c()),k(i,1),i.m(o.parentNode,o))},i(h){a||(k(i),a=!0)},o(h){D(i),a=!1},d(h){h&&(m(e),m(s),m(o)),u[r].d(h)}}}function Ti(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=M("div"),l=q(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){N(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&Z(l,t)},i:Ie,o:Ie,d(s){s&&m(e)}}}function Bi(n){let e,t;return e=new He({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Oi]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&8202&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Si(n){var s;let e,t=(((s=n[9])==null?void 0:s.distance)??0).toFixed(4)+"",l;return{c(){e=M("span"),l=q(t),this.h()},l(r){e=E(r,"SPAN",{class:!0});var i=y(e);l=F(i,t),i.forEach(m),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(r,i){N(r,e,i),p(e,l)},p(r,i){var o;i&8&&t!==(t=(((o=r[9])==null?void 0:o.distance)??0).toFixed(4)+"")&&Z(l,t)},d(r){r&&m(e)}}}function Cl(n){var a;let e,t,l,s=(((a=n[9])==null?void 0:a.distance)??0).toFixed(4)+"",r,i,o=typeof n[12]=="number"&&Tl(n);return{c(){o&&o.c(),e=H(),t=M("span"),l=q("("),r=q(s),i=q(")"),this.h()},l(f){o&&o.l(f),e=j(f),t=E(f,"SPAN",{class:!0});var u=y(t);l=F(u,"("),r=F(u,s),i=F(u,")"),u.forEach(m),this.h()},h(){d(t,"class","text-gray-500 dark:text-gray-500")},m(f,u){o&&o.m(f,u),N(f,e,u),N(f,t,u),p(t,l),p(t,r),p(t,i)},p(f,u){var c;typeof f[12]=="number"?o?o.p(f,u):(o=Tl(f),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),u&8&&s!==(s=(((c=f[9])==null?void 0:c.distance)??0).toFixed(4)+"")&&Z(r,s)},d(f){f&&(m(e),m(t)),o&&o.d(f)}}}function Tl(n){let e,t=n[12].toFixed(2)+"",l,s,r;return{c(){e=M("span"),l=q(t),s=q("%"),this.h()},l(i){e=E(i,"SPAN",{class:!0});var o=y(e);l=F(o,t),s=F(o,"%"),o.forEach(m),this.h()},h(){d(e,"class",r=`px-1 rounded-sm font-medium ${Ol(n[12])}`)},m(i,o){N(i,e,o),p(e,l),p(e,s)},p(i,o){o&8&&t!==(t=i[12].toFixed(2)+"")&&Z(l,t),o&8&&r!==(r=`px-1 rounded-sm font-medium ${Ol(i[12])}`)&&d(e,"class",r)},d(i){i&&m(e)}}}function Oi(n){let e;function t(i,o){return i[1]?Cl:Si}function l(i,o){return o===Cl?Di(i):i}let s=t(n),r=s(l(n,s));return{c(){e=M("div"),r.c(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=y(e);r.l(o),o.forEach(m),this.h()},h(){d(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){N(i,e,o),r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r.d(1),r=s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function Ri(n){let e,t,l=n[9].document+"",s,r;return{c(){e=M("pre"),t=q("                "),s=q(l),r=q(`
              `),this.h()},l(i){e=E(i,"PRE",{class:!0});var o=y(e);t=F(o,"                "),s=F(o,l),r=F(o,`
              `),o.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){N(i,e,o),p(e,t),p(e,s),p(e,r)},p(i,o){o&8&&l!==(l=i[9].document+"")&&Z(s,l)},d(i){i&&m(e)}}}function Li(n){let e,t,l;return{c(){e=M("iframe"),this.h()},l(s){e=E(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),y(e).forEach(m),this.h()},h(){d(e,"class","w-full border-0 h-auto rounded-none"),d(e,"sandbox","allow-scripts allow-forms allow-same-origin"),d(e,"srcdoc",t=n[9].document),d(e,"title",l=n[4].t("Content"))},m(s,r){N(s,e,r)},p(s,r){r&8&&t!==(t=s[9].document)&&d(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&d(e,"title",l)},d(s){s&&m(e)}}}function Bl(n){let e;return{c(){e=M("hr"),this.h()},l(t){e=E(t,"HR",{class:!0}),this.h()},h(){d(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){N(t,e,l)},d(t){t&&m(e)}}}function Sl(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,c=n[4].t("Content")+"",h,g,_,w,I;const V=[Vi,Ni],b=[];function T(P,L){var S;return(S=P[9].source)!=null&&S.name?0:1}i=T(n),o=b[i]=V[i](n);function B(P,L){var S;return(S=P[9].metadata)!=null&&S.html?Li:Ri}let C=B(n),v=C(n),R=n[11]!==n[3].length-1&&Bl();return{c(){e=M("div"),t=M("div"),s=q(l),r=H(),o.c(),a=H(),f=M("div"),u=M("div"),h=q(c),g=H(),v.c(),_=H(),R&&R.c(),w=ce(),this.h()},l(P){e=E(P,"DIV",{class:!0});var L=y(e);t=E(L,"DIV",{class:!0});var S=y(t);s=F(S,l),S.forEach(m),r=j(L),o.l(L),L.forEach(m),a=j(P),f=E(P,"DIV",{class:!0});var O=y(f);u=E(O,"DIV",{class:!0});var J=y(u);h=F(J,c),J.forEach(m),g=j(O),v.l(O),O.forEach(m),_=j(P),R&&R.l(P),w=ce(),this.h()},h(){d(t,"class","text-sm font-medium dark:text-gray-300"),d(e,"class","flex flex-col w-full"),d(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(f,"class","flex flex-col w-full")},m(P,L){N(P,e,L),p(e,t),p(t,s),p(e,r),b[i].m(e,null),N(P,a,L),N(P,f,L),p(f,u),p(u,h),p(f,g),v.m(f,null),N(P,_,L),R&&R.m(P,L),N(P,w,L),I=!0},p(P,L){(!I||L&16)&&l!==(l=P[4].t("Source")+"")&&Z(s,l);let S=i;i=T(P),i===S?b[i].p(P,L):(le(),D(b[S],1,1,()=>{b[S]=null}),se(),o=b[i],o?o.p(P,L):(o=b[i]=V[i](P),o.c()),k(o,1),o.m(e,null)),(!I||L&16)&&c!==(c=P[4].t("Content")+"")&&Z(h,c),C===(C=B(P))&&v?v.p(P,L):(v.d(1),v=C(P),v&&(v.c(),v.m(f,null))),P[11]!==P[3].length-1?R||(R=Bl(),R.c(),R.m(w.parentNode,w)):R&&(R.d(1),R=null)},i(P){I||(k(o),I=!0)},o(P){D(o),I=!1},d(P){P&&(m(e),m(a),m(f),m(_),m(w)),b[i].d(),v.d(),R&&R.d(P)}}}function Pi(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,h,g,_,w=Se(n[3]),I=[];for(let b=0;b<w.length;b+=1)I[b]=Sl(Dl(n,w,b));const V=b=>D(I[b],1,1,()=>{I[b]=null});return{c(){e=M("div"),t=M("div"),l=M("div"),r=q(s),i=H(),o=M("button"),o.innerHTML=a,f=H(),u=M("div"),c=M("div");for(let b=0;b<I.length;b+=1)I[b].c();this.h()},l(b){e=E(b,"DIV",{});var T=y(e);t=E(T,"DIV",{class:!0});var B=y(t);l=E(B,"DIV",{class:!0});var C=y(l);r=F(C,s),C.forEach(m),i=j(B),o=E(B,"BUTTON",{class:!0,"data-svelte-h":!0}),We(o)!=="svelte-745w2y"&&(o.innerHTML=a),B.forEach(m),f=j(T),u=E(T,"DIV",{class:!0});var v=y(u);c=E(v,"DIV",{class:!0});var R=y(c);for(let P=0;P<I.length;P+=1)I[P].l(R);R.forEach(m),v.forEach(m),T.forEach(m),this.h()},h(){d(l,"class","text-lg font-medium self-center capitalize"),d(o,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(b,T){N(b,e,T),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),p(e,f),p(e,u),p(u,c);for(let B=0;B<I.length;B+=1)I[B]&&I[B].m(c,null);h=!0,g||(_=ae(o,"click",n[7]),g=!0)},p(b,T){if((!h||T&16)&&s!==(s=b[4].t("Citation")+"")&&Z(r,s),T&30){w=Se(b[3]);let B;for(B=0;B<w.length;B+=1){const C=Dl(b,w,B);I[B]?(I[B].p(C,T),k(I[B],1)):(I[B]=Sl(C),I[B].c(),k(I[B],1),I[B].m(c,null))}for(le(),B=w.length;B<I.length;B+=1)V(B);se()}},i(b){if(!h){for(let T=0;T<w.length;T+=1)k(I[T]);h=!0}},o(b){I=I.filter(Boolean);for(let T=0;T<I.length;T+=1)D(I[T]);h=!1},d(b){b&&m(e),Qe(I,b),g=!1,_()}}}function Hi(n){let e,t,l;function s(i){n[8](i)}let r={size:"lg",$$slots:{default:[Pi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Ln({props:r}),Fe.push(()=>Ke(e,"show",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&8223&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function ji(n){return typeof n!="number"?null:n<0?0:n>1?100:Math.round(n*1e4)/100}function Ol(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Ai(n,e,t){let l;const s=Ye("i18n");Ce(n,s,h=>t(4,l=h));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=()=>{t(0,r=!1)};function c(h){r=h,t(0,r)}return n.$$set=h=>{"show"in h&&t(0,r=h.show),"citation"in h&&t(6,i=h.citation),"showPercentage"in h&&t(1,o=h.showPercentage),"showRelevance"in h&&t(2,a=h.showRelevance)},n.$$.update=()=>{var h;n.$$.dirty&72&&i&&(t(3,f=(h=i.document)==null?void 0:h.map((g,_)=>{var w,I;return{source:i.source,document:g,metadata:(w=i.metadata)==null?void 0:w[_],distance:(I=i.distances)==null?void 0:I[_]}})),f.every(g=>g.distance!==void 0)&&t(3,f=f.sort((g,_)=>(_.distance??1/0)-(g.distance??1/0))))},[r,o,a,f,l,s,i,u,c]}class zi extends ze{constructor(e){super(),Ue(this,e,Ai,Hi,Pe,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function Rl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Ll(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Pl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Hl(n){let e,t,l,s;const r=[Wi,Ui],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=M("div"),l.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=y(e);l.l(f),f.forEach(m),this.h()},h(){d(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){N(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),k(l,1),l.m(e,null))},i(a){s||(k(l),s=!0)},o(a){D(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Ui(n){let e,t,l;function s(i){n[17](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Gi],default:[Ji]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new Tn({props:r}),Fe.push(()=>Ke(e,"open",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,o){const a={};o&1&&(a.id=`collapsible-${i[0]}`),o&8388851&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Ze(()=>t=!1)),e.$set(a)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Wi(n){let e,t=Se(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=ql(Pl(n,t,s));return{c(){e=M("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){d(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){N(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&51){t=Se(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Pl(s,t,i);l[i]?l[i].p(o,r):(l[i]=ql(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:Ie,o:Ie,d(s){s&&m(e),Qe(l,s)}}}function jl(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=q(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){N(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Al(n){let e,t=n[1].every(n[12]),l,s,r=decodeURIComponent(n[18].source.name)+"",i,o,a,f,u=t&&jl(n);function c(){return n[16](n[18])}return{c(){e=M("button"),u&&u.c(),l=H(),s=M("div"),i=q(r),o=H(),this.h()},l(h){e=E(h,"BUTTON",{class:!0});var g=y(e);u&&u.l(g),l=j(g),s=E(g,"DIV",{class:!0});var _=y(s);i=F(_,r),_.forEach(m),o=j(g),g.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(h,g){N(h,e,g),u&&u.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),a||(f=[ae(e,"click",c),ae(e,"pointerup",Yi)],a=!0)},p(h,g){n=h,g&2&&(t=n[1].every(n[12])),t?u||(u=jl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),g&2&&r!==(r=decodeURIComponent(n[18].source.name)+"")&&Z(i,r)},d(h){h&&m(e),u&&u.d(),a=!1,xe(f)}}}function qi(n){let e,t;return e=new Sn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Fi(n){let e,t;return e=new On({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ji(n){let e,t,l,s=n[7].t("References from")+"",r,i,o,a,f,u,c,h=n[7].t("and")+"",g,_,w=n[1].length-2+"",I,V,b,T=n[7].t("more")+"",B,C,v,R,P,L,S=Se(n[1].slice(0,2)),O=[];for(let te=0;te<S.length;te+=1)O[te]=Al(Rl(n,S,te));const J=[Fi,qi],ee=[];function fe(te,Q){return te[6]?0:1}return R=fe(n),P=ee[R]=J[R](n),{c(){e=M("div"),t=M("div"),l=M("span"),r=q(s),i=H(),o=M("div"),a=M("div");for(let te=0;te<O.length;te+=1)O[te].c();f=H(),u=M("div"),c=M("span"),g=q(h),_=H(),I=q(w),V=H(),b=M("span"),B=q(T),C=H(),v=M("div"),P.c(),this.h()},l(te){e=E(te,"DIV",{class:!0});var Q=y(e);t=E(Q,"DIV",{class:!0});var he=y(t);l=E(he,"SPAN",{class:!0});var de=y(l);r=F(de,s),de.forEach(m),i=j(he),o=E(he,"DIV",{class:!0});var we=y(o);a=E(we,"DIV",{class:!0});var A=y(a);for(let ie=0;ie<O.length;ie+=1)O[ie].l(A);A.forEach(m),we.forEach(m),f=j(he),u=E(he,"DIV",{class:!0});var G=y(u);c=E(G,"SPAN",{class:!0});var ue=y(c);g=F(ue,h),ue.forEach(m),_=j(G),I=F(G,w),V=j(G),b=E(G,"SPAN",{});var ke=y(b);B=F(ke,T),ke.forEach(m),G.forEach(m),he.forEach(m),C=j(Q),v=E(Q,"DIV",{class:!0});var U=y(v);P.l(U),U.forEach(m),Q.forEach(m),this.h()},h(){d(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),d(a,"class","flex text-xs font-medium items-center"),d(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),d(c,"class","hidden sm:inline"),d(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),d(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),d(v,"class","shrink-0"),d(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(te,Q){N(te,e,Q),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),p(o,a);for(let he=0;he<O.length;he+=1)O[he]&&O[he].m(a,null);p(t,f),p(t,u),p(u,c),p(c,g),p(u,_),p(u,I),p(u,V),p(u,b),p(b,B),p(e,C),p(e,v),ee[R].m(v,null),L=!0},p(te,Q){if((!L||Q&128)&&s!==(s=te[7].t("References from")+"")&&Z(r,s),Q&50){S=Se(te[1].slice(0,2));let de;for(de=0;de<S.length;de+=1){const we=Rl(te,S,de);O[de]?O[de].p(we,Q):(O[de]=Al(we),O[de].c(),O[de].m(a,null))}for(;de<O.length;de+=1)O[de].d(1);O.length=S.length}(!L||Q&128)&&h!==(h=te[7].t("and")+"")&&Z(g,h),(!L||Q&2)&&w!==(w=te[1].length-2+"")&&Z(I,w),(!L||Q&128)&&T!==(T=te[7].t("more")+"")&&Z(B,T);let he=R;R=fe(te),R!==he&&(le(),D(ee[he],1,1,()=>{ee[he]=null}),se(),P=ee[R],P||(P=ee[R]=J[R](te),P.c()),k(P,1),P.m(v,null))},i(te){L||(k(P),L=!0)},o(te){D(P),L=!1},d(te){te&&m(e),Qe(O,te),ee[R].d()}}}function zl(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=q(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){N(s,e,r),p(e,l)},d(s){s&&m(e)}}}function Ul(n){let e,t=n[1].every(n[11]),l,s,r=decodeURIComponent(n[18].source.name)+"",i,o,a,f,u,c=t&&zl(n);function h(){return n[15](n[18])}return{c(){e=M("button"),c&&c.c(),l=H(),s=M("div"),i=q(r),o=H(),this.h()},l(g){e=E(g,"BUTTON",{id:!0,class:!0});var _=y(e);c&&c.l(_),l=j(_),s=E(_,"DIV",{class:!0});var w=y(s);i=F(w,r),w.forEach(m),o=j(_),_.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"id",a=`source-${n[0]}-${n[20]+1}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,_){N(g,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),f||(u=ae(e,"click",h),f=!0)},p(g,_){n=g,_&2&&(t=n[1].every(n[11])),t?c||(c=zl(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=decodeURIComponent(n[18].source.name)+"")&&Z(i,r),_&1&&a!==(a=`source-${n[0]}-${n[20]+1}`)&&d(e,"id",a)},d(g){g&&m(e),c&&c.d(),f=!1,u()}}}function Gi(n){let e,t,l=Se(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Ul(Ll(n,l,r));return{c(){e=M("div"),t=M("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"DIV",{slot:!0});var i=y(e);t=E(i,"DIV",{class:!0});var o=y(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),i.forEach(m),this.h()},h(){d(t,"class","flex text-xs font-medium flex-wrap"),d(e,"slot","content")},m(r,i){N(r,e,i),p(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&51){l=Se(r[1]);let o;for(o=0;o<l.length;o+=1){const a=Ll(r,l,o);s[o]?s[o].p(a,i):(s[o]=Ul(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&m(e),Qe(s,r)}}}function Wl(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=q(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){N(s,e,r),p(e,l)},d(s){s&&m(e)}}}function ql(n){let e,t=n[1].every(n[10]),l,s,r=decodeURIComponent(n[18].source.name)+"",i,o,a,f,u,c=t&&Wl(n);function h(){return n[14](n[18])}return{c(){e=M("button"),c&&c.c(),l=H(),s=M("div"),i=q(r),o=H(),this.h()},l(g){e=E(g,"BUTTON",{id:!0,class:!0});var _=y(e);c&&c.l(_),l=j(_),s=E(_,"DIV",{class:!0});var w=y(s);i=F(w,r),w.forEach(m),o=j(_),_.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),d(e,"id",a=`source-${n[0]}-${n[20]+1}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(g,_){N(g,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),f||(u=ae(e,"click",h),f=!0)},p(g,_){n=g,_&2&&(t=n[1].every(n[10])),t?c||(c=Wl(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=decodeURIComponent(n[18].source.name)+"")&&Z(i,r),_&1&&a!==(a=`source-${n[0]}-${n[20]+1}`)&&d(e,"id",a)},d(g){g&&m(e),c&&c.d(),f=!1,u()}}}function Zi(n){let e,t,l,s,r;function i(f){n[13](f)}let o={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(o.show=n[4]),e=new zi({props:o}),Fe.push(()=>Ke(e,"show",i));let a=n[1].length>0&&Hl(n);return{c(){Y(e.$$.fragment),l=H(),a&&a.c(),s=ce()},l(f){X(e.$$.fragment,f),l=j(f),a&&a.l(f),s=ce()},m(f,u){$(e,f,u),N(f,l,u),a&&a.m(f,u),N(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Ze(()=>t=!1)),e.$set(c),f[1].length>0?a?(a.p(f,u),u&2&&k(a,1)):(a=Hl(f),a.c(),k(a,1),a.m(s.parentNode,s)):a&&(le(),D(a,1,1,()=>{a=null}),se())},i(f){r||(k(e.$$.fragment,f),k(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function Ki(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Qi(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Yi=n=>{n.stopPropagation()};function Xi(n,e,t){let l;const s=Ye("i18n");Ce(n,s,C=>t(7,l=C));let{id:r=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,c=null,h=!1;const g=C=>C.distances!==void 0,_=C=>C.distances!==void 0,w=C=>C.distances!==void 0;function I(C){u=C,t(4,u)}const V=C=>{t(4,u=!0),t(5,c=C)},b=C=>{t(4,u=!0),t(5,c=C)},T=C=>{t(4,u=!0),t(5,c=C)};function B(C){h=C,t(6,h)}return n.$$set=C=>{"id"in C&&t(0,r=C.id),"sources"in C&&t(9,i=C.sources)},n.$$.update=()=>{n.$$.dirty&514&&(console.log("sources",i),t(1,o=i.reduce((C,v)=>(Object.keys(v).length===0||v.document.forEach((R,P)=>{var fe,te,Q;const L=(fe=v.metadata)==null?void 0:fe[P],S=(te=v.distances)==null?void 0:te[P],O=(L==null?void 0:L.source)??((Q=v==null?void 0:v.source)==null?void 0:Q.id)??"N/A";let J=v==null?void 0:v.source;L!=null&&L.name&&(J={...J,name:L.name}),(O.startsWith("http://")||O.startsWith("https://"))&&(J={...J,name:O,url:O});const ee=C.find(he=>he.id===O);ee?(ee.document.push(R),ee.metadata.push(L),S!==void 0&&ee.distances.push(S)):C.push({id:O,source:J,document:[R],metadata:L?[L]:[],distances:S!==void 0?[S]:void 0})}),C),[])),t(3,f=Ki(o)),t(2,a=Qi(o)))},[r,o,a,f,u,c,h,l,s,i,g,_,w,I,V,b,T,B]}class $i extends ze{constructor(e){super(),Ue(this,e,Xi,Zi,Pe,{id:0,sources:9})}}function Fl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Jl(n){let e,t,l,s;const r=[to,eo,xi],i=[];function o(a,f){var u,c;return(u=a[1].result)!=null&&u.error?0:(c=a[1].result)!=null&&c.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=M("div"),l.c()},l(a){e=E(a,"DIV",{});var f=y(e);l.l(f),f.forEach(m)},m(a,f){N(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(le(),D(i[u],1,1,()=>{i[u]=null}),se(),l=i[t],l||(l=i[t]=r[t](a),l.c()),k(l,1),l.m(e,null))},i(a){s||(k(l),s=!0)},o(a){D(l),s=!1},d(a){a&&m(e),i[t].d()}}}function xi(n){let e,t;return e=new Qt({props:{type:"warning",content:"incomplete"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function eo(n){let e,t;return e=new Qt({props:{type:"success",content:"success"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function to(n){let e,t;return e=new Qt({props:{type:"error",content:"error"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Gl(n){let e,t,l;return t=new Mt({props:{className:"size-4"}}),{c(){e=M("div"),Y(t.$$.fragment)},l(s){e=E(s,"DIV",{});var r=y(e);X(t.$$.fragment,r),r.forEach(m)},m(s,r){N(s,e,r),$(t,e,null),l=!0},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function lo(n){let e=n[2].t("Code execution")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&Z(t,e)},d(l){l&&m(t)}}}function so(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=q(e),l=q(": "),r=q(s)},l(o){t=F(o,e),l=F(o,": "),r=F(o,s)},m(o,a){N(o,t,a),N(o,l,a),N(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&Z(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&Z(r,s)},d(o){o&&(m(t),m(l),m(r))}}}function Zl(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&Kl(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&Ql(n);return{c(){e=M("div"),l&&l.c(),t=H(),s&&s.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=y(e);l&&l.l(u),t=j(u),s&&s.l(u),u.forEach(m),this.h()},h(){d(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){N(f,e,u),l&&l.m(e,null),p(e,t),s&&s.m(e,null)},p(f,u){var c,h,g,_;(h=(c=f[1])==null?void 0:c.result)!=null&&h.error?l?l.p(f,u):(l=Kl(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(g=f[1])==null?void 0:g.result)!=null&&_.output?s?s.p(f,u):(s=Ql(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function Kl(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=M("div"),t=M("div"),s=q(l),r=H(),i=M("div"),a=q(o),this.h()},l(c){e=E(c,"DIV",{});var h=y(e);t=E(h,"DIV",{class:!0});var g=y(t);s=F(g,l),g.forEach(m),r=j(h),i=E(h,"DIV",{class:!0});var _=y(i);a=F(_,o),_.forEach(m),h.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,h){N(c,e,h),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(c,h){var g,_;h&4&&l!==(l=c[2].t("ERROR")+"")&&Z(s,l),h&2&&o!==(o=((_=(g=c[1])==null?void 0:g.result)==null?void 0:_.error)+"")&&Z(a,o)},d(c){c&&m(e)}}}function Ql(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=M("div"),t=M("div"),s=q(l),r=H(),i=M("div"),a=q(o),this.h()},l(c){e=E(c,"DIV",{});var h=y(e);t=E(h,"DIV",{class:!0});var g=y(t);s=F(g,l),g.forEach(m),r=j(h),i=E(h,"DIV",{class:!0});var _=y(i);a=F(_,o),_.forEach(m),h.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,h){N(c,e,h),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(c,h){var g,_;h&4&&l!==(l=c[2].t("OUTPUT")+"")&&Z(s,l),h&2&&o!==(o=((_=(g=c[1])==null?void 0:g.result)==null?void 0:_.output)+"")&&Z(a,o)},d(c){c&&m(e)}}}function Yl(n){var c,h;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=Se((h=(c=n[1])==null?void 0:c.result)==null?void 0:h.files),u=[];for(let g=0;g<f.length;g+=1)u[g]=Xl(Fl(n,f,g));return{c(){e=M("div"),t=M("hr"),l=H(),s=M("div"),i=q(r),o=H(),a=M("ul");for(let g=0;g<u.length;g+=1)u[g].c();this.h()},l(g){e=E(g,"DIV",{class:!0});var _=y(e);t=E(_,"HR",{class:!0}),l=j(_),s=E(_,"DIV",{class:!0});var w=y(s);i=F(w,r),w.forEach(m),o=j(_),a=E(_,"UL",{class:!0});var I=y(a);for(let V=0;V<u.length;V+=1)u[V].l(I);I.forEach(m),_.forEach(m),this.h()},h(){d(t,"class","border-gray-100 dark:border-gray-850 my-2"),d(s,"class","text-sm font-medium dark:text-gray-300"),d(a,"class","mt-1 list-disc pl-4 text-xs"),d(e,"class","flex flex-col w-full")},m(g,_){N(g,e,_),p(e,t),p(e,l),p(e,s),p(s,i),p(e,o),p(e,a);for(let w=0;w<u.length;w+=1)u[w]&&u[w].m(a,null)},p(g,_){var w,I;if(_&4&&r!==(r=g[2].t("Files")+"")&&Z(i,r),_&2){f=Se((I=(w=g[1])==null?void 0:w.result)==null?void 0:I.files);let V;for(V=0;V<f.length;V+=1){const b=Fl(g,f,V);u[V]?u[V].p(b,_):(u[V]=Xl(b),u[V].c(),u[V].m(a,null))}for(;V<u.length;V+=1)u[V].d(1);u.length=f.length}},d(g){g&&m(e),Qe(u,g)}}}function Xl(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=M("li"),t=M("a"),s=q(l),i=H(),this.h()},l(o){e=E(o,"LI",{});var a=y(e);t=E(a,"A",{href:!0,target:!0});var f=y(t);s=F(f,l),f.forEach(m),i=j(a),a.forEach(m),this.h()},h(){d(t,"href",r=n[6].url),d(t,"target","_blank")},m(o,a){N(o,e,a),p(e,t),p(t,s),p(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&Z(s,l),a&2&&r!==(r=o[6].url)&&d(t,"href",r)},d(o){o&&m(e)}}}function no(n){var J,ee,fe,te,Q,he,de,we,A,G,ue,ke,U,ie,oe,me,Me,pe,ye;let e,t,l,s,r,i,o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,h,g,_,w,I,V,b,T,B,C=((J=n[1])==null?void 0:J.result)&&Jl(n),v=!((ee=n[1])!=null&&ee.result)&&Gl();function R(_e,re){var ve;return(ve=_e[1])!=null&&ve.name?so:lo}let P=R(n),L=P(n);w=new Sr({props:{id:"code-exec-"+((fe=n[1])==null?void 0:fe.id)+"-code",lang:((te=n[1])==null?void 0:te.language)??"",code:((Q=n[1])==null?void 0:Q.code)??"",className:"",editorClassName:(he=n[1])!=null&&he.result&&((we=(de=n[1])==null?void 0:de.result)!=null&&we.error||(G=(A=n[1])==null?void 0:A.result)!=null&&G.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let S=((ue=n[1])==null?void 0:ue.result)&&(((U=(ke=n[1])==null?void 0:ke.result)==null?void 0:U.error)||((oe=(ie=n[1])==null?void 0:ie.result)==null?void 0:oe.output))&&Zl(n),O=((Me=(me=n[1])==null?void 0:me.result)==null?void 0:Me.files)&&((ye=(pe=n[1])==null?void 0:pe.result)==null?void 0:ye.files.length)>0&&Yl(n);return{c(){e=M("div"),t=M("div"),l=M("div"),C&&C.c(),s=H(),r=M("div"),v&&v.c(),i=H(),o=M("div"),L.c(),a=H(),f=M("button"),f.innerHTML=u,c=H(),h=M("div"),g=M("div"),_=M("div"),Y(w.$$.fragment),I=H(),S&&S.c(),V=H(),O&&O.c(),this.h()},l(_e){e=E(_e,"DIV",{});var re=y(e);t=E(re,"DIV",{class:!0});var ve=y(t);l=E(ve,"DIV",{class:!0});var Oe=y(l);C&&C.l(Oe),s=j(Oe),r=E(Oe,"DIV",{class:!0});var Ae=y(r);v&&v.l(Ae),i=j(Ae),o=E(Ae,"DIV",{});var K=y(o);L.l(K),K.forEach(m),Ae.forEach(m),Oe.forEach(m),a=j(ve),f=E(ve,"BUTTON",{class:!0,"data-svelte-h":!0}),We(f)!=="svelte-vnrwun"&&(f.innerHTML=u),ve.forEach(m),c=j(re),h=E(re,"DIV",{class:!0});var z=y(h);g=E(z,"DIV",{class:!0});var ne=y(g);_=E(ne,"DIV",{class:!0});var ge=y(_);X(w.$$.fragment,ge),ge.forEach(m),I=j(ne),S&&S.l(ne),V=j(ne),O&&O.l(ne),ne.forEach(m),z.forEach(m),re.forEach(m),this.h()},h(){d(r,"class","flex gap-2 items-center"),d(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),d(f,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(_,"class","flex flex-col w-full"),d(g,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(h,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(_e,re){N(_e,e,re),p(e,t),p(t,l),C&&C.m(l,null),p(l,s),p(l,r),v&&v.m(r,null),p(r,i),p(r,o),L.m(o,null),p(t,a),p(t,f),p(e,c),p(e,h),p(h,g),p(g,_),$(w,_,null),p(g,I),S&&S.m(g,null),p(g,V),O&&O.m(g,null),b=!0,T||(B=ae(f,"click",n[4]),T=!0)},p(_e,re){var Oe,Ae,K,z,ne,ge,be,Ve,Re,Je,nt,ft,ut,rt,Et,Dt,Nt,Vt,Ct;(Oe=_e[1])!=null&&Oe.result?C?(C.p(_e,re),re&2&&k(C,1)):(C=Jl(_e),C.c(),k(C,1),C.m(l,s)):C&&(le(),D(C,1,1,()=>{C=null}),se()),(Ae=_e[1])!=null&&Ae.result?v&&(le(),D(v,1,1,()=>{v=null}),se()):v?re&2&&k(v,1):(v=Gl(),v.c(),k(v,1),v.m(r,i)),P===(P=R(_e))&&L?L.p(_e,re):(L.d(1),L=P(_e),L&&(L.c(),L.m(o,null)));const ve={};re&2&&(ve.id="code-exec-"+((K=_e[1])==null?void 0:K.id)+"-code"),re&2&&(ve.lang=((z=_e[1])==null?void 0:z.language)??""),re&2&&(ve.code=((ne=_e[1])==null?void 0:ne.code)??""),re&2&&(ve.editorClassName=(ge=_e[1])!=null&&ge.result&&((Ve=(be=_e[1])==null?void 0:be.result)!=null&&Ve.error||(Je=(Re=_e[1])==null?void 0:Re.result)!=null&&Je.output)?"rounded-b-none":""),w.$set(ve),(nt=_e[1])!=null&&nt.result&&((ut=(ft=_e[1])==null?void 0:ft.result)!=null&&ut.error||(Et=(rt=_e[1])==null?void 0:rt.result)!=null&&Et.output)?S?S.p(_e,re):(S=Zl(_e),S.c(),S.m(g,V)):S&&(S.d(1),S=null),(Nt=(Dt=_e[1])==null?void 0:Dt.result)!=null&&Nt.files&&((Ct=(Vt=_e[1])==null?void 0:Vt.result)==null?void 0:Ct.files.length)>0?O?O.p(_e,re):(O=Yl(_e),O.c(),O.m(g,null)):O&&(O.d(1),O=null)},i(_e){b||(k(C),k(v),k(w.$$.fragment,_e),b=!0)},o(_e){D(C),D(v),D(w.$$.fragment,_e),b=!1},d(_e){_e&&m(e),C&&C.d(),v&&v.d(),L.d(),x(w),S&&S.d(),O&&O.d(),T=!1,B()}}}function ro(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[no]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Ln({props:r}),Fe.push(()=>Ke(e,"show",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function io(n,e,t){let l;const s=Ye("i18n");Ce(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class oo extends ze{constructor(e){super(),Ue(this,e,io,ro,Pe,{show:0,codeExecution:1})}}function $l(n,e,t){const l=n.slice();return l[6]=e[t],l}function xl(n){let e,t=[],l=new Map,s,r=Se(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=$l(n,r,o),f=i(a);l.set(f,t[o]=es(f,a))}return{c(){e=M("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=E(o,"DIV",{class:!0});var a=y(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){d(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){N(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=Se(o[0]),le(),t=Gt(t,a,i,1,o,r,l,e,Mn,es,null,$l),se())},i(o){if(!s){for(let a=0;a<r.length;a+=1)k(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)D(t[a]);s=!1},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ao(n){let e,t;return e=new Mt({props:{className:"size-4"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:Ie,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function fo(n){let e,t,l,s;const r=[ho,co,uo],i=[];function o(a,f){var u,c;return(u=a[6].result)!=null&&u.error?0:(c=a[6].result)!=null&&c.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t||(t=i[e]=r[e](a),t.c()),k(t,1),t.m(l.parentNode,l))},i(a){s||(k(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function uo(n){let e,t;return e=new zr({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function co(n){let e,t;return e=new jr({props:{strokeWidth:"3",className:"size-3"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ho(n){let e,t;return e=new Ar({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function es(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,c,h,g,_,w;const I=[fo,ao],V=[];function b(B,C){var v;return(v=B[6])!=null&&v.result?0:1}r=b(e),i=V[r]=I[r](e);function T(){return e[4](e[6])}return{key:n,first:null,c(){t=M("div"),l=M("button"),s=M("div"),i.c(),o=H(),a=M("div"),u=q(f),h=H(),this.h()},l(B){t=E(B,"DIV",{class:!0});var C=y(t);l=E(C,"BUTTON",{class:!0});var v=y(l);s=E(v,"DIV",{class:!0});var R=y(s);i.l(R),R.forEach(m),o=j(v),a=E(v,"DIV",{class:!0});var P=y(a);u=F(P,f),P.forEach(m),v.forEach(m),h=j(C),C.forEach(m),this.h()},h(){var B;d(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),d(a,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((B=e[6])!=null&&B.result?"":"pulse")+" svelte-1gvtig2"),d(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),d(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(B,C){N(B,t,C),p(t,l),p(l,s),V[r].m(s,null),p(l,o),p(l,a),p(a,u),p(t,h),g=!0,_||(w=ae(l,"click",T),_=!0)},p(B,C){var R;e=B;let v=r;r=b(e),r===v?V[r].p(e,C):(le(),D(V[v],1,1,()=>{V[v]=null}),se(),i=V[r],i?i.p(e,C):(i=V[r]=I[r](e),i.c()),k(i,1),i.m(s,null)),(!g||C&1)&&f!==(f=e[6].name+"")&&Z(u,f),(!g||C&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((R=e[6])!=null&&R.result?"":"pulse")+" svelte-1gvtig2"))&&d(a,"class",c)},i(B){g||(k(i),g=!0)},o(B){D(i),g=!1},d(B){B&&m(t),V[r].d(),_=!1,w()}}}function mo(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new oo({props:o}),Fe.push(()=>Ke(e,"show",i));let a=n[0].length>0&&xl(n);return{c(){Y(e.$$.fragment),l=H(),a&&a.c(),s=ce()},l(f){X(e.$$.fragment,f),l=j(f),a&&a.l(f),s=ce()},m(f,u){$(e,f,u),N(f,l,u),a&&a.m(f,u),N(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Ze(()=>t=!1)),e.$set(c),f[0].length>0?a?(a.p(f,u),u&1&&k(a,1)):(a=xl(f),a.c(),k(a,1),a.m(s.parentNode,s)):a&&(le(),D(a,1,1,()=>{a=null}),se())},i(f){r||(k(e.$$.fragment,f),k(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function go(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class _o extends ze{constructor(e){super(),Ue(this,e,go,mo,Pe,{codeExecutions:0})}}function po(n){let e,t;return{c(){e=Ee("svg"),t=Ee("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),p(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:Ie,o:Ie,d(l){l&&m(e)}}}function vo(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class bo extends ze{constructor(e){super(),Ue(this,e,vo,po,Pe,{className:0,strokeWidth:1})}}function ko(n){let e,t,l,s,r,i,o,a,f,u,c,h;s=new It({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const g=[Io,yo],_=[];function w(V,b){return b&32&&(a=null),a==null&&(a=V[5].trim()===""),a?0:1}f=w(n,-1),u=_[f]=g[f](n);let I=n[6]&&ts(n);return{c(){e=M("div"),t=M("div"),l=M("div"),Y(s.$$.fragment),r=H(),i=M("div"),o=M("div"),u.c(),c=H(),I&&I.c(),this.h()},l(V){e=E(V,"DIV",{class:!0});var b=y(e);t=E(b,"DIV",{class:!0});var T=y(t);l=E(T,"DIV",{class:!0});var B=y(l);X(s.$$.fragment,B),B.forEach(m),T.forEach(m),r=j(b),i=E(b,"DIV",{class:!0});var C=y(i);o=E(C,"DIV",{class:!0,id:!0});var v=y(o);u.l(v),c=j(v),I&&I.l(v),v.forEach(m),C.forEach(m),b.forEach(m),this.h()},h(){d(l,"class","font-medium"),d(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),d(o,"id","response-container"),d(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(V,b){N(V,e,b),p(e,t),p(t,l),$(s,l,null),p(e,r),p(e,i),p(i,o),_[f].m(o,null),p(o,c),I&&I.m(o,null),h=!0},p(V,b){const T={};b&1&&(T.id=`${V[0]}-float-prompt`),b&16&&(T.content=V[4]),s.$set(T);let B=f;f=w(V,b),f===B?_[f].p(V,b):(le(),D(_[B],1,1,()=>{_[B]=null}),se(),u=_[f],u?u.p(V,b):(u=_[f]=g[f](V),u.c()),k(u,1),u.m(o,c)),V[6]?I?I.p(V,b):(I=ts(V),I.c(),I.m(o,null)):I&&(I.d(1),I=null)},i(V){h||(k(s.$$.fragment,V),k(u),h=!0)},o(V){D(s.$$.fragment,V),D(u),h=!1},d(V){V&&m(e),x(s),_[f].d(),I&&I.d()}}}function wo(n){let e,t,l,s;const r=[Eo,Mo],i=[];function o(a,f){return a[1]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),k(t,1),t.m(l.parentNode,l))},i(a){s||(k(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function yo(n){let e,t;return e=new It({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Io(n){let e,t;return e=new Yt({props:{size:"sm"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:Ie,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ts(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=M("div"),t=M("button"),s=q(l),this.h()},l(o){e=E(o,"DIV",{class:!0});var a=y(e);t=E(a,"BUTTON",{class:!0});var f=y(t);s=F(f,l),f.forEach(m),a.forEach(m),this.h()},h(){d(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){N(o,e,a),p(e,t),p(t,s),r||(i=ae(t,"click",n[11]),r=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&Z(s,l)},d(o){o&&m(e),r=!1,i()}}}function Mo(n){let e,t,l,s,r,i,o,a,f,u,c;return{c(){e=M("div"),t=M("input"),s=H(),r=M("div"),i=M("button"),o=Ee("svg"),a=Ee("path"),this.h()},l(h){e=E(h,"DIV",{class:!0});var g=y(e);t=E(g,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=j(g),r=E(g,"DIV",{class:!0});var _=y(r);i=E(_,"BUTTON",{class:!0});var w=y(i);o=De(w,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var I=y(o);a=De(I,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),y(a).forEach(m),I.forEach(m),w.forEach(m),_.forEach(m),g.forEach(m),this.h()},h(){d(t,"type","text"),d(t,"id","floating-message-input"),d(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),d(t,"placeholder",l=n[7].t("Ask a question")),d(a,"fill-rule","evenodd"),d(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),d(a,"clip-rule","evenodd"),d(o,"xmlns","http://www.w3.org/2000/svg"),d(o,"viewBox","0 0 16 16"),d(o,"fill","currentColor"),d(o,"class","size-4"),d(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),d(r,"class","ml-1 mr-2"),d(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(h,g){N(h,e,g),p(e,t),ot(t,n[3]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,a),u||(c=[ae(t,"input",n[18]),ae(t,"keydown",n[19]),ae(i,"click",n[20])],u=!0)},p(h,g){g&128&&l!==(l=h[7].t("Ask a question"))&&d(t,"placeholder",l),g&8&&t.value!==h[3]&&ot(t,h[3]),g&8&&f!==(f=(h[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&d(i,"class",f)},i:Ie,o:Ie,d(h){h&&m(e),u=!1,xe(c)}}}function Eo(n){let e,t,l,s,r,i=n[7].t("Ask")+"",o,a,f,u,c,h,g=n[7].t("Explain")+"",_,w,I,V;return l=new bo({props:{className:"size-3 shrink-0"}}),u=new Or({props:{className:"size-3 shrink-0"}}),{c(){e=M("div"),t=M("button"),Y(l.$$.fragment),s=H(),r=M("div"),o=q(i),a=H(),f=M("button"),Y(u.$$.fragment),c=H(),h=M("div"),_=q(g),this.h()},l(b){e=E(b,"DIV",{class:!0});var T=y(e);t=E(T,"BUTTON",{class:!0});var B=y(t);X(l.$$.fragment,B),s=j(B),r=E(B,"DIV",{class:!0});var C=y(r);o=F(C,i),C.forEach(m),B.forEach(m),a=j(T),f=E(T,"BUTTON",{class:!0});var v=y(f);X(u.$$.fragment,v),c=j(v),h=E(v,"DIV",{class:!0});var R=y(h);_=F(R,g),R.forEach(m),v.forEach(m),T.forEach(m),this.h()},h(){d(r,"class","shrink-0"),d(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(h,"class","shrink-0"),d(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(b,T){N(b,e,T),p(e,t),$(l,t,null),p(t,s),p(t,r),p(r,o),p(e,a),p(e,f),$(u,f,null),p(f,c),p(f,h),p(h,_),w=!0,I||(V=[ae(t,"click",n[16]),ae(f,"click",n[17])],I=!0)},p(b,T){(!w||T&128)&&i!==(i=b[7].t("Ask")+"")&&Z(o,i),(!w||T&128)&&g!==(g=b[7].t("Explain")+"")&&Z(_,g)},i(b){w||(k(l.$$.fragment,b),k(u.$$.fragment,b),w=!0)},o(b){D(l.$$.fragment,b),D(u.$$.fragment,b),w=!1},d(b){b&&m(e),x(l),x(u),I=!1,xe(V)}}}function Do(n){let e,t,l,s,r;const i=[wo,ko],o=[];function a(f,u){return f[5]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=M("div"),l.c(),this.h()},l(f){e=E(f,"DIV",{id:!0,class:!0,style:!0});var u=y(e);l.l(u),u.forEach(m),this.h()},h(){d(e,"id",s=`floating-buttons-${n[0]}`),d(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),gt(e,"display","none")},m(f,u){N(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let c=t;t=a(f),t===c?o[t].p(f,u):(le(),D(o[c],1,1,()=>{o[c]=null}),se(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),k(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&d(e,"id",s)},i(f){r||(k(l),r=!0)},o(f){D(l),r=!1},d(f){f&&m(e),o[t].d()}}}function No(n,e,t){let l;const s=Ye("i18n");Ce(n,s,L=>t(7,l=L));let{id:r=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",c="",h="",g=null,_=!1;const w=async()=>{const L=document.getElementById("response-container");L.scrollHeight-L.clientHeight<=L.scrollTop+50&&(L.scrollTop=L.scrollHeight)},I=async()=>{if(!i){qe.error("Model not selected");return}t(4,h=`${c}
\`\`\`
${u}
\`\`\``),t(3,c=""),t(5,g="");const[L,S]=await gl(localStorage.token,{model:i,messages:[...o,{role:"user",content:h}].map(O=>({role:O.role,content:O.content})),stream:!0});if(L&&L.ok){const O=L.body.getReader(),J=new TextDecoder;await(async()=>{var fe,te;for(;;){const{done:Q,value:he}=await O.read();if(Q)break;const we=J.decode(he,{stream:!0}).split(`
`).filter(A=>A.trim()!=="");for(const A of we)if(A.startsWith("data: "))if(A.startsWith("data: [DONE]")){t(6,_=!0),await Be(),w();continue}else try{const G=JSON.parse(A.slice(6));G.choices&&((te=(fe=G.choices[0])==null?void 0:fe.delta)!=null&&te.content)&&(t(5,g+=G.choices[0].delta.content),w())}catch(G){console.error(G)}}})()}else qe.error("An error occurred while fetching the explanation")},V=async()=>{if(!i){qe.error("Model not selected");return}const L=l.t("Explain this section to me in more detail");t(4,h=`${L}

\`\`\`
${u}
\`\`\``),t(5,g="");const[S,O]=await gl(localStorage.token,{model:i,messages:[...o,{role:"user",content:h}].map(J=>({role:J.role,content:J.content})),stream:!0});if(S&&S.ok){const J=S.body.getReader(),ee=new TextDecoder;await(async()=>{var te,Q;for(;;){const{done:he,value:de}=await J.read();if(he)break;const A=ee.decode(de,{stream:!0}).split(`
`).filter(G=>G.trim()!=="");for(const G of A)if(G.startsWith("data: "))if(G.startsWith("data: [DONE]")){t(6,_=!0),await Be(),w();continue}else try{const ue=JSON.parse(G.slice(6));ue.choices&&((Q=(te=ue.choices[0])==null?void 0:te.delta)!=null&&Q.content)&&(t(5,g+=ue.choices[0].delta.content),w())}catch(ue){console.error(ue)}}})()}else qe.error("An error occurred while fetching the explanation")},b=async()=>{a({modelId:i,parentId:r,messages:[{role:"user",content:h},{role:"assistant",content:g}]})},T=()=>{t(5,g=null),t(6,_=!1),t(1,f=!1),t(3,c="")},B=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Be(),setTimeout(()=>{const L=document.getElementById("floating-message-input");L&&L.focus()},0)},C=()=>{t(2,u=window.getSelection().toString()),V()};function v(){c=this.value,t(3,c)}const R=L=>{L.key==="Enter"&&I()},P=()=>{I()};return n.$$set=L=>{"id"in L&&t(0,r=L.id),"model"in L&&t(12,i=L.model),"messages"in L&&t(13,o=L.messages),"onAdd"in L&&t(14,a=L.onAdd)},[r,f,u,c,h,g,_,l,s,I,V,b,i,o,a,T,B,C,v,R,P]}class Vo extends ze{constructor(e){super(),Ue(this,e,No,Do,Pe,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function ls(n){var s;let e,t,l={id:n[0],model:(s=n[3])==null?void 0:s.id,messages:Jt(n[2],n[0]),onAdd:n[20]};return e=new Vo({props:l}),n[21](e),{c(){Y(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,i){$(e,r,i),t=!0},p(r,i){var a;const o={};i&1&&(o.id=r[0]),i&8&&(o.model=(a=r[3])==null?void 0:a.id),i&5&&(o.messages=Jt(r[2],r[0])),i&512&&(o.onAdd=r[20]),e.$set(o)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){n[21](null),x(e,r)}}}function Co(n){let e,t,l,s,r;t=new It({props:{id:n[0],content:n[1],model:n[3],save:n[5],sourceIds:(n[4]??[]).reduce(n[16],[]),onSourceClick:n[7],onTaskClick:n[8]}}),t.$on("update",n[17]),t.$on("code",n[18]);let i=n[6]&&n[3]&&ls(n);return{c(){e=M("div"),Y(t.$$.fragment),l=H(),i&&i.c(),s=ce()},l(o){e=E(o,"DIV",{});var a=y(e);X(t.$$.fragment,a),a.forEach(m),l=j(o),i&&i.l(o),s=ce()},m(o,a){N(o,e,a),$(t,e,null),n[19](e),N(o,l,a),i&&i.m(o,a),N(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&8&&(f.model=o[3]),a&32&&(f.save=o[5]),a&24&&(f.sourceIds=(o[4]??[]).reduce(o[16],[])),a&128&&(f.onSourceClick=o[7]),a&256&&(f.onTaskClick=o[8]),t.$set(f),o[6]&&o[3]?i?(i.p(o,a),a&72&&k(i,1)):(i=ls(o),i.c(),k(i,1),i.m(s.parentNode,s)):i&&(le(),D(i,1,1,()=>{i=null}),se())},i(o){r||(k(t.$$.fragment,o),k(i),r=!0)},o(o){D(t.$$.fragment,o),D(i),r=!1},d(o){o&&(m(e),m(l),m(s)),x(t),n[19](null),i&&i.d(o)}}}function To(n,e,t){let l,s;Ce(n,En,O=>t(12,l=O)),Ce(n,pr,O=>t(13,s=O)),Ye("i18n");const r=_t();let{id:i}=e,{content:o}=e,{history:a}=e,{model:f=null}=e,{sources:u=null}=e,{save:c=!1}=e,{floatingButtons:h=!0}=e,{onSourceClick:g=()=>{}}=e,{onTaskClick:_=()=>{}}=e,{onAddMessages:w=()=>{}}=e,I,V;const b=O=>{const J=document.getElementById(`floating-buttons-${i}`);if(!(I!=null&&I.contains(O.target))&&!(J!=null&&J.contains(O.target))){T();return}setTimeout(async()=>{if(await Be(),!(I!=null&&I.contains(O.target)))return;let ee=window.getSelection();if(ee.toString().trim().length>0){const te=ee.getRangeAt(0).getBoundingClientRect(),Q=I.getBoundingClientRect(),he=te.bottom-Q.top,de=te.left-Q.left;if(J){J.style.display="block";const we=Q.width-de;let A=l?window.innerWidth/2:window.innerWidth/3;if(we<A){const G=Q.right-te.right;J.style.right=`${G}px`,J.style.left="auto"}else J.style.left=`${de}px`,J.style.right="auto";J.style.top=`${he+5}px`}}else T()},0)},T=()=>{const O=document.getElementById(`floating-buttons-${i}`);O&&(O.style.display="none"),V&&typeof(V==null?void 0:V.closeHandler)=="function"&&(V==null||V.closeHandler())},B=O=>{O.key==="Escape"&&T()};kt(()=>{h&&(I==null||I.addEventListener("mouseup",b),document.addEventListener("mouseup",b),document.addEventListener("keydown",B))}),dr(()=>{h&&(I==null||I.removeEventListener("mouseup",b),document.removeEventListener("mouseup",b),document.removeEventListener("keydown",B))});const C=(O,J)=>{let ee=[];return J.document.forEach((fe,te)=>{var de,we,A,G,ue;if(((A=(we=(de=f==null?void 0:f.info)==null?void 0:de.meta)==null?void 0:we.capabilities)==null?void 0:A.citations)==!1)return ee.push("N/A"),ee;const Q=(G=J.metadata)==null?void 0:G[te],he=(Q==null?void 0:Q.source)??"N/A";return Q!=null&&Q.name?(ee.push(Q.name),ee):(he.startsWith("http://")||he.startsWith("https://")?ee.push(he):ee.push(((ue=J==null?void 0:J.source)==null?void 0:ue.name)??he),ee)}),O=[...O,...ee],O.filter((fe,te)=>O.indexOf(fe)===te)},v=O=>{r("update",O.detail)},R=O=>{const{lang:J,code:ee}=O.detail;(["html","svg"].includes(J)||J==="xml"&&ee.includes("svg"))&&!l&&s&&(vr.set(!0),br.set(!0))};function P(O){Fe[O?"unshift":"push"](()=>{I=O,t(10,I)})}const L=({modelId:O,parentId:J,messages:ee})=>{console.log(O,J,ee),w({modelId:O,parentId:J,messages:ee}),T()};function S(O){Fe[O?"unshift":"push"](()=>{V=O,t(11,V)})}return n.$$set=O=>{"id"in O&&t(0,i=O.id),"content"in O&&t(1,o=O.content),"history"in O&&t(2,a=O.history),"model"in O&&t(3,f=O.model),"sources"in O&&t(4,u=O.sources),"save"in O&&t(5,c=O.save),"floatingButtons"in O&&t(6,h=O.floatingButtons),"onSourceClick"in O&&t(7,g=O.onSourceClick),"onTaskClick"in O&&t(8,_=O.onTaskClick),"onAddMessages"in O&&t(9,w=O.onAddMessages)},[i,o,a,f,u,c,h,g,_,w,I,V,l,s,r,T,C,v,R,P,L,S]}class Bo extends ze{constructor(e){super(),Ue(this,e,To,Co,Pe,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function ss(n,e,t){const l=n.slice();return l[89]=e[t],l}function Wt(n){var l,s,r;const e=n.slice(),t=(((l=e[13])==null?void 0:l.statusHistory)??[...(s=e[13])!=null&&s.status?[(r=e[13])==null?void 0:r.status]:[]]).at(-1);return e[92]=t,e}function ns(n,e,t){const l=n.slice();return l[93]=e[t],l}function So(n){var s;let e,t=(((s=n[17])==null?void 0:s.name)??n[13].model)+"",l;return{c(){e=M("span"),l=q(t),this.h()},l(r){e=E(r,"SPAN",{class:!0});var i=y(e);l=F(i,t),i.forEach(m),this.h()},h(){d(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){N(r,e,i),p(e,l)},p(r,i){var o;i[0]&139264&&t!==(t=(((o=r[17])==null?void 0:o.name)??r[13].model)+"")&&Z(l,t)},d(r){r&&m(e)}}}function rs(n){let e,t,l;return t=new He({props:{content:at(n[13].timestamp*1e3).format("LLLL"),$$slots:{default:[Oo]},$$scope:{ctx:n}}}),{c(){e=M("div"),Y(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);X(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&8192&&(i.content=at(s[13].timestamp*1e3).format("LLLL")),r[0]&8192|r[3]&8&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Oo(n){let e,t=Ht(n[13].timestamp*1e3)+"",l;return{c(){e=M("span"),l=q(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){N(s,e,r),p(e,l)},p(s,r){r[0]&8192&&t!==(t=Ht(s[13].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&m(e)}}}function Ro(n){var i;let e,t,l,s;e=new He({props:{content:((i=n[17])==null?void 0:i.name)??n[13].model,placement:"top-start",$$slots:{default:[So]},$$scope:{ctx:n}}});let r=n[13].timestamp&&rs(n);return{c(){Y(e.$$.fragment),t=H(),r&&r.c(),l=ce()},l(o){X(e.$$.fragment,o),t=j(o),r&&r.l(o),l=ce()},m(o,a){$(e,o,a),N(o,t,a),r&&r.m(o,a),N(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&139264&&(f.content=((u=o[17])==null?void 0:u.name)??o[13].model),a[0]&139264|a[3]&8&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[13].timestamp?r?(r.p(o,a),a[0]&8192&&k(r,1)):(r=rs(o),r.c(),k(r,1),r.m(l.parentNode,l)):r&&(le(),D(r,1,1,()=>{r=null}),se())},i(o){s||(k(e.$$.fragment,o),k(r),s=!0)},o(o){D(e.$$.fragment,o),D(r),s=!1},d(o){o&&(m(t),m(l)),x(e,o),r&&r.d(o)}}}function is(n){let e,t,l=Se(n[13].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=as(ns(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=M("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=y(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){N(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&8192){l=Se(i[13].files);let a;for(a=0;a<l.length;a+=1){const f=ns(i,l,a);s[a]?(s[a].p(f,o),k(s[a],1)):(s[a]=as(f),s[a].c(),k(s[a],1),s[a].m(e,null))}for(le(),a=l.length;a<s.length;a+=1)r(a);se()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)k(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&m(e),Qe(s,i)}}}function os(n){let e,t;return e=new Bn({props:{src:n[93].url,alt:n[13].content}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.src=l[93].url),s[0]&8192&&(r.alt=l[13].content),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function as(n){let e,t,l,s=n[93].type==="image"&&os(n);return{c(){e=M("div"),s&&s.c(),t=H()},l(r){e=E(r,"DIV",{});var i=y(e);s&&s.l(i),t=j(i),i.forEach(m)},m(r,i){N(r,e,i),s&&s.m(e,null),p(e,t),l=!0},p(r,i){r[93].type==="image"?s?(s.p(r,i),i[0]&8192&&k(s,1)):(s=os(r),s.c(),k(s,1),s.m(e,t)):s&&(le(),D(s,1,1,()=>{s=null}),se())},i(r){l||(k(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s&&s.d()}}}function fs(n){var s;let e,t,l=!((s=n[92])!=null&&s.hidden)&&us(n);return{c(){l&&l.c(),e=ce()},l(r){l&&l.l(r),e=ce()},m(r,i){l&&l.m(r,i),N(r,e,i),t=!0},p(r,i){var o;(o=r[92])!=null&&o.hidden?l&&(le(),D(l,1,1,()=>{l=null}),se()):l?(l.p(r,i),i[0]&8192&&k(l,1)):(l=us(r),l.c(),k(l,1),l.m(e.parentNode,e))},i(r){t||(k(l),t=!0)},o(r){D(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function us(n){var u;let e,t,l,s,r,i=((u=n[92])==null?void 0:u.done)===!1&&cs();const o=[Ho,Po,Lo],a=[];function f(c,h){var g,_,w;return((g=c[92])==null?void 0:g.action)==="web_search"&&((_=c[92])!=null&&_.urls)?0:((w=c[92])==null?void 0:w.action)==="knowledge_search"?1:2}return l=f(n),s=a[l]=o[l](n),{c(){e=M("div"),i&&i.c(),t=H(),s.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var h=y(e);i&&i.l(h),t=j(h),s.l(h),h.forEach(m),this.h()},h(){d(e,"class","status-description flex items-center gap-2 py-0.5")},m(c,h){N(c,e,h),i&&i.m(e,null),p(e,t),a[l].m(e,null),r=!0},p(c,h){var _;((_=c[92])==null?void 0:_.done)===!1?i?h[0]&8192&&k(i,1):(i=cs(),i.c(),k(i,1),i.m(e,t)):i&&(le(),D(i,1,1,()=>{i=null}),se());let g=l;l=f(c),l===g?a[l].p(c,h):(le(),D(a[g],1,1,()=>{a[g]=null}),se(),s=a[l],s?s.p(c,h):(s=a[l]=o[l](c),s.c()),k(s,1),s.m(e,null))},i(c){r||(k(i),k(s),r=!0)},o(c){D(i),D(s),r=!1},d(c){c&&m(e),i&&i.d(),a[l].d()}}}function cs(n){let e,t,l;return t=new Mt({props:{className:"size-4"}}),{c(){e=M("div"),Y(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);X(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","")},m(s,r){N(s,e,r),$(t,e,null),l=!0},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Lo(n){let e,t,l,s;function r(a,f){var u,c,h;return f[0]&8192&&(l=null),l==null&&(l=!!((u=a[92])!=null&&u.description.includes("{{searchQuery}}"))),l?Uo:((c=a[92])==null?void 0:c.description)==="No search query generated"?zo:((h=a[92])==null?void 0:h.description)==="Generating search query"?Ao:jo}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=M("div"),t=M("div"),o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=y(e);t=E(f,"DIV",{class:!0});var u=y(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[92])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){N(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&8192&&s!==(s=(((u=a[92])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",s)},i:Ie,o:Ie,d(a){a&&m(e),o.d()}}}function Po(n){let e,t,l=n[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[92].query})+"",s,r;return{c(){e=M("div"),t=M("div"),s=q(l),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=y(e);t=E(o,"DIV",{class:!0});var a=y(t);s=F(a,l),a.forEach(m),o.forEach(m),this.h()},h(){var i;d(t,"class",r=(((i=n[92])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){N(i,e,o),p(e,t),p(t,s)},p(i,o){var a;o[0]&268443648&&l!==(l=i[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[92].query})+"")&&Z(s,l),o[0]&8192&&r!==(r=(((a=i[92])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",r)},i:Ie,o:Ie,d(i){i&&m(e)}}}function Ho(n){let e,t;return e=new bi({props:{status:n[92],$$slots:{default:[Go]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.status=l[92]),s[0]&268443648|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function jo(n){var l;let e=((l=n[92])==null?void 0:l.description)+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){N(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[92])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&m(t)}}}function Ao(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&Z(t,e)},d(l){l&&m(t)}}}function zo(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&Z(t,e)},d(l){l&&m(t)}}}function Uo(n){var l,s;let e=n[28].t((l=n[92])==null?void 0:l.description,{searchQuery:(s=n[92])==null?void 0:s.query})+"",t;return{c(){t=q(e)},l(r){t=F(r,e)},m(r,i){N(r,t,i)},p(r,i){var o,a;i[0]&268443648&&e!==(e=r[28].t((o=r[92])==null?void 0:o.description,{searchQuery:(a=r[92])==null?void 0:a.query})+"")&&Z(t,e)},d(r){r&&m(t)}}}function Wo(n){var l;let e=((l=n[92])==null?void 0:l.description)+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){N(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[92])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&m(t)}}}function qo(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&Z(t,e)},d(l){l&&m(t)}}}function Fo(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&Z(t,e)},d(l){l&&m(t)}}}function Jo(n){var l,s;let e=n[28].t((l=n[92])==null?void 0:l.description,{count:(s=n[92])==null?void 0:s.urls.length})+"",t;return{c(){t=q(e)},l(r){t=F(r,e)},m(r,i){N(r,t,i)},p(r,i){var o,a;i[0]&268443648&&e!==(e=r[28].t((o=r[92])==null?void 0:o.description,{count:(a=r[92])==null?void 0:a.urls.length})+"")&&Z(t,e)},d(r){r&&m(t)}}}function Go(n){let e,t,l,s;function r(a,f){var u,c,h;return f[0]&8192&&(l=null),l==null&&(l=!!((u=a[92])!=null&&u.description.includes("{{count}}"))),l?Jo:((c=a[92])==null?void 0:c.description)==="No search query generated"?Fo:((h=a[92])==null?void 0:h.description)==="Generating search query"?qo:Wo}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=M("div"),t=M("div"),o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=y(e);t=E(f,"DIV",{class:!0});var u=y(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[92])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){N(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&8192&&s!==(s=(((u=a[92])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&d(t,"class",s)},d(a){a&&m(e),o.d()}}}function Zo(n){var _,w,I,V,b,T,B;let e,t,l,s,r,i,o;const a=[Yo,Qo],f=[];function u(C,v){return C[13].content===""&&!C[13].error?0:C[13].content&&C[13].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let c=((_=n[13])==null?void 0:_.error)&&ds(n),h=(((w=n[13])==null?void 0:w.sources)||((I=n[13])==null?void 0:I.citations))&&(((B=(T=(b=(V=n[17])==null?void 0:V.info)==null?void 0:b.meta)==null?void 0:T.capabilities)==null?void 0:B.citations)??!0)&&hs(n),g=n[13].code_executions&&ms(n);return{c(){e=M("div"),l&&l.c(),s=H(),c&&c.c(),r=H(),h&&h.c(),i=H(),g&&g.c(),this.h()},l(C){e=E(C,"DIV",{class:!0,id:!0});var v=y(e);l&&l.l(v),s=j(v),c&&c.l(v),r=j(v),h&&h.l(v),i=j(v),g&&g.l(v),v.forEach(m),this.h()},h(){d(e,"class","w-full flex flex-col relative"),d(e,"id","response-content-container")},m(C,v){N(C,e,v),~t&&f[t].m(e,null),p(e,s),c&&c.m(e,null),p(e,r),h&&h.m(e,null),p(e,i),g&&g.m(e,null),o=!0},p(C,v){var P,L,S,O,J,ee,fe;let R=t;t=u(C),t===R?~t&&f[t].p(C,v):(l&&(le(),D(f[R],1,1,()=>{f[R]=null}),se()),~t?(l=f[t],l?l.p(C,v):(l=f[t]=a[t](C),l.c()),k(l,1),l.m(e,s)):l=null),(P=C[13])!=null&&P.error?c?(c.p(C,v),v[0]&8192&&k(c,1)):(c=ds(C),c.c(),k(c,1),c.m(e,r)):c&&(le(),D(c,1,1,()=>{c=null}),se()),((L=C[13])!=null&&L.sources||(S=C[13])!=null&&S.citations)&&(((fe=(ee=(J=(O=C[17])==null?void 0:O.info)==null?void 0:J.meta)==null?void 0:ee.capabilities)==null?void 0:fe.citations)??!0)?h?(h.p(C,v),v[0]&139264&&k(h,1)):(h=hs(C),h.c(),k(h,1),h.m(e,i)):h&&(le(),D(h,1,1,()=>{h=null}),se()),C[13].code_executions?g?(g.p(C,v),v[0]&8192&&k(g,1)):(g=ms(C),g.c(),k(g,1),g.m(e,null)):g&&(le(),D(g,1,1,()=>{g=null}),se())},i(C){o||(k(l),k(c),k(h),k(g),o=!0)},o(C){D(l),D(c),D(h),D(g),o=!1},d(C){C&&m(e),~t&&f[t].d(),c&&c.d(),h&&h.d(),g&&g.d()}}}function Ko(n){let e,t,l,s,r,i,o,a=n[28].t("Save As Copy")+"",f,u,c,h,g=n[28].t("Cancel")+"",_,w,I,V=n[28].t("Save")+"",b,T,B;return{c(){e=M("div"),t=M("textarea"),s=H(),r=M("div"),i=M("div"),o=M("button"),f=q(a),u=H(),c=M("div"),h=M("button"),_=q(g),w=H(),I=M("button"),b=q(V),this.h()},l(C){e=E(C,"DIV",{class:!0});var v=y(e);t=E(v,"TEXTAREA",{id:!0,class:!0}),y(t).forEach(m),s=j(v),r=E(v,"DIV",{class:!0});var R=y(r);i=E(R,"DIV",{});var P=y(i);o=E(P,"BUTTON",{id:!0,class:!0});var L=y(o);f=F(L,a),L.forEach(m),P.forEach(m),u=j(R),c=E(R,"DIV",{class:!0});var S=y(c);h=E(S,"BUTTON",{id:!0,class:!0});var O=y(h);_=F(O,g),O.forEach(m),w=j(S),I=E(S,"BUTTON",{id:!0,class:!0});var J=y(I);b=F(J,V),J.forEach(m),S.forEach(m),R.forEach(m),v.forEach(m),this.h()},h(){d(t,"id",l="message-edit-"+n[13].id),d(t,"class","bg-transparent outline-hidden w-full resize-none"),d(o,"id","save-new-message-button"),d(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(h,"id","close-edit-message-button"),d(h,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(I,"id","confirm-edit-message-button"),d(I,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(c,"class","flex space-x-1.5"),d(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(C,v){N(C,e,v),p(e,t),n[51](t),ot(t,n[18]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,f),p(r,u),p(r,c),p(c,h),p(h,_),p(c,w),p(c,I),p(I,b),T||(B=[ae(t,"input",n[52]),ae(t,"input",va),ae(t,"keydown",n[53]),ae(o,"click",n[54]),ae(h,"click",n[55]),ae(I,"click",n[56])],T=!0)},p(C,v){v[0]&8192&&l!==(l="message-edit-"+C[13].id)&&d(t,"id",l),v[0]&262144&&ot(t,C[18]),v[0]&268435456&&a!==(a=C[28].t("Save As Copy")+"")&&Z(f,a),v[0]&268435456&&g!==(g=C[28].t("Cancel")+"")&&Z(_,g),v[0]&268435456&&V!==(V=C[28].t("Save")+"")&&Z(b,V)},i:Ie,o:Ie,d(C){C&&m(e),n[51](null),T=!1,xe(B)}}}function Qo(n){var l;let e,t;return e=new Bo({props:{id:n[13].id,history:n[0],content:n[13].content,sources:n[13].sources,floatingButtons:((l=n[13])==null?void 0:l.done)&&!n[12],save:!n[12],model:n[17],onTaskClick:n[57],onSourceClick:n[58],onAddMessages:n[59]}}),e.$on("update",n[60]),e.$on("select",n[61]),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&8192&&(i.id=s[13].id),r[0]&1&&(i.history=s[0]),r[0]&8192&&(i.content=s[13].content),r[0]&8192&&(i.sources=s[13].sources),r[0]&12288&&(i.floatingButtons=((o=s[13])==null?void 0:o.done)&&!s[12]),r[0]&4096&&(i.save=!s[12]),r[0]&131072&&(i.model=s[17]),r[0]&8192&&(i.onSourceClick=s[58]),r[0]&1024&&(i.onAddMessages=s[59]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Yo(n){let e,t;return e=new Yt({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:Ie,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ds(n){var l,s;let e,t;return e=new Ei({props:{content:((s=(l=n[13])==null?void 0:l.error)==null?void 0:s.content)??n[13].content}}),{c(){Y(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,i){$(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&8192&&(o.content=((f=(a=r[13])==null?void 0:a.error)==null?void 0:f.content)??r[13].content),e.$set(o)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function hs(n){var l,s,r;let e,t;return e=new $i({props:{id:(l=n[13])==null?void 0:l.id,sources:((s=n[13])==null?void 0:s.sources)??((r=n[13])==null?void 0:r.citations)}}),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&8192&&(a.id=(f=i[13])==null?void 0:f.id),o[0]&8192&&(a.sources=((u=i[13])==null?void 0:u.sources)??((c=i[13])==null?void 0:c.citations)),e.$set(a)},i(i){t||(k(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){x(e,i)}}}function ms(n){let e,t;return e=new _o({props:{codeExecutions:n[13].code_executions}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.codeExecutions=l[13].code_executions),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function gs(n){let e,t,l,s,r=(n[13].done||n[1].length>1)&&_s(n),i=n[13].done&&n[24]&&Cs(n);return{c(){e=M("div"),r&&r.c(),t=H(),i&&i.c(),l=ce(),this.h()},l(o){e=E(o,"DIV",{class:!0});var a=y(e);r&&r.l(a),a.forEach(m),t=j(o),i&&i.l(o),l=ce(),this.h()},h(){d(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(o,a){N(o,e,a),r&&r.m(e,null),n[78](e),N(o,t,a),i&&i.m(o,a),N(o,l,a),s=!0},p(o,a){o[13].done||o[1].length>1?r?(r.p(o,a),a[0]&8194&&k(r,1)):(r=_s(o),r.c(),k(r,1),r.m(e,null)):r&&(le(),D(r,1,1,()=>{r=null}),se()),o[13].done&&o[24]?i?(i.p(o,a),a[0]&16785408&&k(i,1)):(i=Cs(o),i.c(),k(i,1),i.m(l.parentNode,l)):i&&(le(),D(i,1,1,()=>{i=null}),se())},i(o){s||(k(r),k(i),s=!0)},o(o){D(r),D(i),s=!1},d(o){o&&(m(e),m(t),m(l)),r&&r.d(),n[78](null),i&&i.d(o)}}}function _s(n){let e,t,l,s=n[1].length>1&&ps(n),r=n[13].done&&vs(n);return{c(){s&&s.c(),e=H(),r&&r.c(),t=ce()},l(i){s&&s.l(i),e=j(i),r&&r.l(i),t=ce()},m(i,o){s&&s.m(i,o),N(i,e,o),r&&r.m(i,o),N(i,t,o),l=!0},p(i,o){i[1].length>1?s?s.p(i,o):(s=ps(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[13].done?r?(r.p(i,o),o[0]&8192&&k(r,1)):(r=vs(i),r.c(),k(r,1),r.m(t.parentNode,t)):r&&(le(),D(r,1,1,()=>{r=null}),se())},i(i){l||(k(r),l=!0)},o(i){D(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function ps(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(g,_){return g[20]?$o:Xo}let c=u(n),h=c(n);return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=H(),h.c(),r=H(),i=M("button"),i.innerHTML=o,this.h()},l(g){e=E(g,"DIV",{class:!0,dir:!0});var _=y(e);t=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),We(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=j(_),h.l(_),r=j(_),i=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),We(i)!=="svelte-107ksnk"&&(i.innerHTML=o),_.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center min-w-fit"),d(e,"dir","ltr")},m(g,_){N(g,e,_),p(e,t),p(e,s),h.m(e,null),p(e,r),p(e,i),a||(f=[ae(t,"click",n[62]),ae(i,"click",n[66])],a=!0)},p(g,_){c===(c=u(g))&&h?h.p(g,_):(h.d(1),h=c(g),h&&(h.c(),h.m(e,r)))},d(g){g&&m(e),h.d(),a=!1,xe(f)}}}function Xo(n){let e,t=n[1].indexOf(n[13].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=M("div"),l=q(t),s=q("/"),i=q(r),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=y(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){N(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ae(e,"dblclick",n[65]),o=!0)},p(f,u){u[0]&8194&&t!==(t=f[1].indexOf(f[13].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&m(e),o=!1,a()}}}function $o(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=M("div"),t=M("input"),i=q("/"),a=q(o),this.h()},l(c){e=E(c,"DIV",{class:!0});var h=y(e);t=E(h,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(h,"/"),a=F(h,o),h.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[13].id),d(t,"type","number"),t.value=s=n[1].indexOf(n[13].id)+1,d(t,"min","1"),d(t,"max",r=n[1].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,h){N(c,e,h),p(e,t),p(e,i),p(e,a),f||(u=[ae(t,"focus",ba),ae(t,"blur",n[63]),ae(t,"keydown",n[64])],f=!0)},p(c,h){h[0]&8192&&l!==(l="message-index-input-"+c[13].id)&&d(t,"id",l),h[0]&8194&&s!==(s=c[1].indexOf(c[13].id)+1)&&t.value!==s&&(t.value=s),h[0]&2&&r!==(r=c[1].length)&&d(t,"max",r),h[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&m(e),f=!1,xe(u)}}}function vs(n){var _,w,I,V,b;let e,t,l,s,r,i,o,a,f,u=!n[12]&&bs(n);t=new He({props:{content:n[28].t("Copy"),placement:"bottom",$$slots:{default:[ea]},$$scope:{ctx:n}}}),s=new He({props:{content:n[28].t("Read Aloud ttttt"),placement:"bottom",$$slots:{default:[na]},$$scope:{ctx:n}}});let c=((_=n[27])==null?void 0:_.features.enable_image_generation)&&(((w=n[29])==null?void 0:w.role)==="admin"||((b=(V=(I=n[29])==null?void 0:I.permissions)==null?void 0:V.features)==null?void 0:b.image_generation))&&!n[12]&&ws(n),h=n[13].usage&&ys(n),g=!n[12]&&Is(n);return{c(){u&&u.c(),e=H(),Y(t.$$.fragment),l=H(),Y(s.$$.fragment),r=H(),c&&c.c(),i=H(),h&&h.c(),o=H(),g&&g.c(),a=ce()},l(T){u&&u.l(T),e=j(T),X(t.$$.fragment,T),l=j(T),X(s.$$.fragment,T),r=j(T),c&&c.l(T),i=j(T),h&&h.l(T),o=j(T),g&&g.l(T),a=ce()},m(T,B){u&&u.m(T,B),N(T,e,B),$(t,T,B),N(T,l,B),$(s,T,B),N(T,r,B),c&&c.m(T,B),N(T,i,B),h&&h.m(T,B),N(T,o,B),g&&g.m(T,B),N(T,a,B),f=!0},p(T,B){var R,P,L,S,O;T[12]?u&&(le(),D(u,1,1,()=>{u=null}),se()):u?(u.p(T,B),B[0]&4096&&k(u,1)):(u=bs(T),u.c(),k(u,1),u.m(e.parentNode,e));const C={};B[0]&268435456&&(C.content=T[28].t("Copy")),B[0]&10240|B[3]&8&&(C.$$scope={dirty:B,ctx:T}),t.$set(C);const v={};B[0]&268435456&&(v.content=T[28].t("Read Aloud ttttt")),B[0]&6301696|B[3]&8&&(v.$$scope={dirty:B,ctx:T}),s.$set(v),(R=T[27])!=null&&R.features.enable_image_generation&&(((P=T[29])==null?void 0:P.role)==="admin"||(O=(S=(L=T[29])==null?void 0:L.permissions)==null?void 0:S.features)!=null&&O.image_generation)&&!T[12]?c?(c.p(T,B),B[0]&671092736&&k(c,1)):(c=ws(T),c.c(),k(c,1),c.m(i.parentNode,i)):c&&(le(),D(c,1,1,()=>{c=null}),se()),T[13].usage?h?(h.p(T,B),B[0]&8192&&k(h,1)):(h=ys(T),h.c(),k(h,1),h.m(o.parentNode,o)):h&&(le(),D(h,1,1,()=>{h=null}),se()),T[12]?g&&(le(),D(g,1,1,()=>{g=null}),se()):g?(g.p(T,B),B[0]&4096&&k(g,1)):(g=Is(T),g.c(),k(g,1),g.m(a.parentNode,a))},i(T){f||(k(u),k(t.$$.fragment,T),k(s.$$.fragment,T),k(c),k(h),k(g),f=!0)},o(T){D(u),D(t.$$.fragment,T),D(s.$$.fragment,T),D(c),D(h),D(g),f=!1},d(T){T&&(m(e),m(l),m(r),m(i),m(o),m(a)),u&&u.d(T),x(t,T),x(s,T),c&&c.d(T),h&&h.d(T),g&&g.d(T)}}}function bs(n){var s,r,i,o;let e,t,l=(((s=n[29])==null?void 0:s.role)==="user"?((o=(i=(r=n[29])==null?void 0:r.permissions)==null?void 0:i.chat)==null?void 0:o.edit)??!0:!0)&&ks(n);return{c(){l&&l.c(),e=ce()},l(a){l&&l.l(a),e=ce()},m(a,f){l&&l.m(a,f),N(a,e,f),t=!0},p(a,f){var u,c,h,g;((u=a[29])==null?void 0:u.role)!=="user"||(((g=(h=(c=a[29])==null?void 0:c.permissions)==null?void 0:h.chat)==null?void 0:g.edit)??!0)?l?(l.p(a,f),f[0]&536870912&&k(l,1)):(l=ks(a),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(a){t||(k(l),t=!0)},o(a){D(l),t=!1},d(a){a&&m(e),l&&l.d(a)}}}function ks(n){let e,t;return e=new He({props:{content:n[28].t("Edit"),placement:"bottom",$$slots:{default:[xo]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Edit")),s[0]&2048|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function xo(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=y(e);t=De(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=De(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,a){N(o,e,a),p(e,t),p(t,l),r||(i=ae(e,"click",n[67]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function ea(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=y(e);t=De(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=De(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(o,a){N(o,e,a),p(e,t),p(t,l),r||(i=ae(e,"click",n[68]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function ta(n){let e,t;return{c(){e=Ee("svg"),t=Ee("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){N(l,e,s),p(e,t)},d(l){l&&m(e)}}}function la(n){let e,t;return{c(){e=Ee("svg"),t=Ee("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){N(l,e,s),p(e,t)},d(l){l&&m(e)}}}function sa(n){let e,t,l,s,r,i;return{c(){e=Ee("svg"),t=Ee("style"),l=q(`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),s=Ee("circle"),r=Ee("circle"),i=Ee("circle"),this.h()},l(o){e=De(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=y(e);t=De(a,"style",{});var f=y(t);l=F(f,`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),f.forEach(m),s=De(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(s).forEach(m),r=De(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(r).forEach(m),i=De(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){N(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&m(e)}}}function na(n){let e,t,l,s,r;function i(f,u){return f[22]?sa:f[21]?la:ta}let o=i(n),a=o(n);return{c(){e=M("button"),a.c(),this.h()},l(f){e=E(f,"BUTTON",{id:!0,class:!0});var u=y(e);a.l(u),u.forEach(m),this.h()},h(){d(e,"id",t="speak-button-"+n[13].id),d(e,"class",l=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){N(f,e,u),a.m(e,null),s||(r=ae(e,"click",n[69]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&8192&&t!==(t="speak-button-"+f[13].id)&&d(e,"id",t),u[0]&2048&&l!==(l=(f[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",l)},d(f){f&&m(e),a.d(),s=!1,r()}}}function ws(n){let e,t;return e=new He({props:{content:n[28].t("Generate Image"),placement:"bottom",$$slots:{default:[oa]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Generate Image")),s[0]&8398848|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ra(n){let e,t;return{c(){e=Ee("svg"),t=Ee("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){N(l,e,s),p(e,t)},d(l){l&&m(e)}}}function ia(n){let e,t,l,s,r,i;return{c(){e=Ee("svg"),t=Ee("style"),l=q(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=Ee("circle"),r=Ee("circle"),i=Ee("circle"),this.h()},l(o){e=De(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=y(e);t=De(a,"style",{});var f=y(t);l=F(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=De(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(s).forEach(m),r=De(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(r).forEach(m),i=De(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){N(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&m(e)}}}function oa(n){let e,t,l,s;function r(a,f){return a[23]?ia:ra}let i=r(n),o=i(n);return{c(){e=M("button"),o.c(),this.h()},l(a){e=E(a,"BUTTON",{class:!0});var f=y(e);o.l(f),f.forEach(m),this.h()},h(){d(e,"class",t=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){N(a,e,f),o.m(e,null),l||(s=ae(e,"click",n[70]),l=!0)},p(a,f){i!==(i=r(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null))),f[0]&2048&&t!==(t=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",t)},d(a){a&&m(e),o.d(),l=!1,s()}}}function ys(n){let e,t;return e=new He({props:{content:n[13].usage?`<pre>${bt(JSON.stringify(n[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[aa]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].usage?`<pre>${bt(JSON.stringify(l[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:""),s[0]&10240|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function aa(n){let e,t,l,s,r,i,o;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),this.h()},l(a){e=E(a,"BUTTON",{class:!0,id:!0});var f=y(e);t=De(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=y(t);l=De(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),d(e,"id",r="info-"+n[13].id)},m(a,f){N(a,e,f),p(e,t),p(t,l),i||(o=ae(e,"click",n[71]),i=!0)},p(a,f){f[0]&2048&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&d(e,"class",s),f[0]&8192&&r!==(r="info-"+a[13].id)&&d(e,"id",r)},d(a){a&&m(e),i=!1,o()}}}function Is(n){var h;let e,t,l,s,r,i,o,a=!n[30]&&(((h=n[27])==null?void 0:h.features.enable_message_rating)??!0)&&Ms(n),f=n[11]&&Es(n);l=new He({props:{content:n[28].t("Regenerate"),placement:"bottom",$$slots:{default:[da]},$$scope:{ctx:n}}});let u=n[1].length>1&&Ds(n),c=n[11]&&Ns(n);return{c(){a&&a.c(),e=H(),f&&f.c(),t=H(),Y(l.$$.fragment),s=H(),u&&u.c(),r=H(),c&&c.c(),i=ce()},l(g){a&&a.l(g),e=j(g),f&&f.l(g),t=j(g),X(l.$$.fragment,g),s=j(g),u&&u.l(g),r=j(g),c&&c.l(g),i=ce()},m(g,_){a&&a.m(g,_),N(g,e,_),f&&f.m(g,_),N(g,t,_),$(l,g,_),N(g,s,_),u&&u.m(g,_),N(g,r,_),c&&c.m(g,_),N(g,i,_),o=!0},p(g,_){var I;!g[30]&&(((I=g[27])==null?void 0:I.features.enable_message_rating)??!0)?a?(a.p(g,_),_[0]&1207959552&&k(a,1)):(a=Ms(g),a.c(),k(a,1),a.m(e.parentNode,e)):a&&(le(),D(a,1,1,()=>{a=null}),se()),g[11]?f?(f.p(g,_),_[0]&2048&&k(f,1)):(f=Es(g),f.c(),k(f,1),f.m(t.parentNode,t)):f&&(le(),D(f,1,1,()=>{f=null}),se());const w={};_[0]&268435456&&(w.content=g[28].t("Regenerate")),_[0]&16919040|_[3]&8&&(w.$$scope={dirty:_,ctx:g}),l.$set(w),g[1].length>1?u?(u.p(g,_),_[0]&2&&k(u,1)):(u=Ds(g),u.c(),k(u,1),u.m(r.parentNode,r)):u&&(le(),D(u,1,1,()=>{u=null}),se()),g[11]?c?(c.p(g,_),_[0]&2048&&k(c,1)):(c=Ns(g),c.c(),k(c,1),c.m(i.parentNode,i)):c&&(le(),D(c,1,1,()=>{c=null}),se())},i(g){o||(k(a),k(f),k(l.$$.fragment,g),k(u),k(c),o=!0)},o(g){D(a),D(f),D(l.$$.fragment,g),D(u),D(c),o=!1},d(g){g&&(m(e),m(t),m(s),m(r),m(i)),a&&a.d(g),f&&f.d(g),x(l,g),u&&u.d(g),c&&c.d(g)}}}function Ms(n){let e,t,l,s;return e=new He({props:{content:n[28].t("Good Response"),placement:"bottom",$$slots:{default:[fa]},$$scope:{ctx:n}}}),l=new He({props:{content:n[28].t("Bad Response"),placement:"bottom",$$slots:{default:[ua]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment),t=H(),Y(l.$$.fragment)},l(r){X(e.$$.fragment,r),t=j(r),X(l.$$.fragment,r)},m(r,i){$(e,r,i),N(r,t,i),$(l,r,i),s=!0},p(r,i){const o={};i[0]&268435456&&(o.content=r[28].t("Good Response")),i[0]&33564672|i[3]&8&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[0]&268435456&&(a.content=r[28].t("Bad Response")),i[0]&33564672|i[3]&8&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(k(e.$$.fragment,r),k(l.$$.fragment,r),s=!0)},o(r){D(e.$$.fragment,r),D(l.$$.fragment,r),s=!1},d(r){r&&m(t),x(e,r),x(l,r)}}}function fa(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=y(e);t=De(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=y(t);l=De(f,"path",{d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;d(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[13])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(o,a){N(o,e,a),p(e,t),p(t,l),r||(i=ae(e,"click",n[72]),r=!0)},p(o,a){var f,u;a[0]&10240&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&33554432&&(e.disabled=o[25])},d(o){o&&m(e),r=!1,i()}}}function ua(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=y(e);t=De(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=y(t);l=De(f,"path",{d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;d(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[13])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(o,a){N(o,e,a),p(e,t),p(t,l),r||(i=ae(e,"click",n[73]),r=!0)},p(o,a){var f,u;a[0]&10240&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&33554432&&(e.disabled=o[25])},d(o){o&&m(e),r=!1,i()}}}function Es(n){let e,t;return e=new He({props:{content:n[28].t("Continue Response"),placement:"bottom",$$slots:{default:[ca]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Continue Response")),s[0]&2304|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ca(n){let e,t,l,s,r,i,o;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),s=Ee("path"),this.h()},l(a){e=E(a,"BUTTON",{type:!0,id:!0,class:!0});var f=y(e);t=De(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=y(t);l=De(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),s=De(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(s).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",r=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){N(a,e,f),p(e,t),p(t,l),p(t,s),i||(o=ae(e,"click",n[74]),i=!0)},p(a,f){f[0]&2048&&r!==(r=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function da(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),this.h()},l(o){e=E(o,"BUTTON",{type:!0,class:!0});var a=y(e);t=De(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=De(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){N(o,e,a),p(e,t),p(t,l),r||(i=ae(e,"click",n[75]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Ds(n){let e,t;return e=new He({props:{content:n[28].t("Delete"),placement:"bottom",$$slots:{default:[ha]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Delete")),s[0]&67584|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ha(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=Ee("svg"),l=Ee("path"),this.h()},l(o){e=E(o,"BUTTON",{type:!0,id:!0,class:!0});var a=y(e);t=De(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=De(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","delete-response-button"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){N(o,e,a),p(e,t),p(t,l),r||(i=ae(e,"click",n[76]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&m(e),r=!1,i()}}}function Ns(n){var i;let e,t,l=Se(((i=n[17])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Vs(ss(n,l,o));const r=o=>D(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ce()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=ce()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);N(o,e,a),t=!0},p(o,a){var f;if(a[0]&141376){l=Se(((f=o[17])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=ss(o,l,u);s[u]?(s[u].p(c,a),k(s[u],1)):(s[u]=Vs(c),s[u].c(),k(s[u],1),s[u].m(e.parentNode,e))}for(le(),u=l.length;u<s.length;u+=1)r(u);se()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)k(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(o){o&&m(e),Qe(s,o)}}}function ma(n){let e,t;return e=new yi({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:Ie,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ga(n){let e,t,l,s,r;return{c(){e=M("div"),t=M("img"),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=y(e);t=E(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(m),this.h()},h(){Lt(t.src,l=n[89].icon_url)||d(t,"src",l),d(t,"class",s="w-4 h-4 "+(n[89].icon_url.includes("svg")?"dark:invert-[80%]":"")),gt(t,"fill","currentColor"),d(t,"alt",r=n[89].name),d(e,"class","size-4")},m(i,o){N(i,e,o),p(e,t)},p(i,o){o[0]&131072&&!Lt(t.src,l=i[89].icon_url)&&d(t,"src",l),o[0]&131072&&s!==(s="w-4 h-4 "+(i[89].icon_url.includes("svg")?"dark:invert-[80%]":""))&&d(t,"class",s),o[0]&131072&&r!==(r=i[89].name)&&d(t,"alt",r)},i:Ie,o:Ie,d(i){i&&m(e)}}}function _a(n){let e,t,l,s,r,i,o,a;const f=[ga,ma],u=[];function c(g,_){return g[89].icon_url?0:1}t=c(n),l=u[t]=f[t](n);function h(){return n[77](n[89])}return{c(){e=M("button"),l.c(),r=H(),this.h()},l(g){e=E(g,"BUTTON",{type:!0,class:!0});var _=y(e);l.l(_),_.forEach(m),r=j(g),this.h()},h(){d(e,"type","button"),d(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(g,_){N(g,e,_),u[t].m(e,null),N(g,r,_),i=!0,o||(a=ae(e,"click",h),o=!0)},p(g,_){n=g;let w=t;t=c(n),t===w?u[t].p(n,_):(le(),D(u[w],1,1,()=>{u[w]=null}),se(),l=u[t],l?l.p(n,_):(l=u[t]=f[t](n),l.c()),k(l,1),l.m(e,null)),(!i||_[0]&2048&&s!==(s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&d(e,"class",s)},i(g){i||(k(l),i=!0)},o(g){D(l),i=!1},d(g){g&&(m(e),m(r)),u[t].d(),o=!1,a()}}}function Vs(n){let e,t;return e=new He({props:{content:n[89].name,placement:"bottom",$$slots:{default:[_a]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.content=l[89].name),s[0]&141376|s[3]&8&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Cs(n){let e,t,l,s;function r(a){n[79](a)}function i(a){n[80](a)}let o={};return n[13]!==void 0&&(o.message=n[13]),n[24]!==void 0&&(o.show=n[24]),e=new di({props:o}),Fe.push(()=>Ke(e,"message",r)),Fe.push(()=>Ke(e,"show",i)),e.$on("save",n[81]),{c(){Y(e.$$.fragment)},l(a){X(e.$$.fragment,a)},m(a,f){$(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&8192&&(t=!0,u.message=a[13],Ze(()=>t=!1)),!l&&f[0]&16777216&&(l=!0,u.show=a[24],Ze(()=>l=!1)),e.$set(u)},i(a){s||(k(e.$$.fragment,a),s=!0)},o(a){D(e.$$.fragment,a),s=!1},d(a){x(e,a)}}}function Ts(n){var J,ee,fe,te,Q,he,de,we;let e,t,l,s,r,i,o,a,f=((J=n[13])==null?void 0:J.files)&&((ee=n[13].files)==null?void 0:ee.filter(Bs).length)>0,u,c,h,g,_,w,I,V,b,T,B,C;l=new Cn({props:{src:((Q=(te=(fe=n[17])==null?void 0:fe.info)==null?void 0:te.meta)==null?void 0:Q.profile_image_url)??(n[28].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`),className:"size-8"}}),i=new Kt({props:{$$slots:{default:[Ro]},$$scope:{ctx:n}}});let v=f&&is(n),R=(((he=n[13])==null?void 0:he.statusHistory)??[...(de=n[13])!=null&&de.status?[(we=n[13])==null?void 0:we.status]:[]]).length>0&&fs(Wt(n));const P=[Ko,Zo],L=[];function S(A,G){return A[14]===!0?0:1}_=S(n),w=L[_]=P[_](n);let O=!n[14]&&gs(n);return{c(){e=M("div"),t=M("div"),Y(l.$$.fragment),s=H(),r=M("div"),Y(i.$$.fragment),o=H(),a=M("div"),v&&v.c(),u=H(),c=M("div"),h=M("div"),R&&R.c(),g=H(),w.c(),V=H(),O&&O.c(),this.h()},l(A){e=E(A,"DIV",{class:!0,id:!0,dir:!0});var G=y(e);t=E(G,"DIV",{class:!0});var ue=y(t);X(l.$$.fragment,ue),ue.forEach(m),s=j(G),r=E(G,"DIV",{class:!0});var ke=y(r);X(i.$$.fragment,ke),o=j(ke),a=E(ke,"DIV",{});var U=y(a);v&&v.l(U),u=j(U),c=E(U,"DIV",{class:!0});var ie=y(c);h=E(ie,"DIV",{});var oe=y(h);R&&R.l(oe),g=j(oe),w.l(oe),oe.forEach(m),ie.forEach(m),V=j(U),O&&O.l(U),U.forEach(m),ke.forEach(m),G.forEach(m),this.h()},h(){d(t,"class",hr("shrink-0 ltr:mr-3 rtl:ml-3")+" svelte-1u5gq5j"),d(c,"class",I="chat-"+n[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),d(r,"class","flex-auto w-0 pl-1"),d(e,"class",b="flex w-full message-"+n[13].id+" svelte-1u5gq5j"),d(e,"id",T="message-"+n[13].id),d(e,"dir",B=n[26].chatDirection)},m(A,G){N(A,e,G),p(e,t),$(l,t,null),p(e,s),p(e,r),$(i,r,null),p(r,o),p(r,a),v&&v.m(a,null),p(a,u),p(a,c),p(c,h),R&&R.m(h,null),p(h,g),L[_].m(h,null),p(a,V),O&&O.m(a,null),C=!0},p(A,G){var ie,oe,me,Me,pe,ye,_e,re;const ue={};G[0]&268566528&&(ue.src=((me=(oe=(ie=A[17])==null?void 0:ie.info)==null?void 0:oe.meta)==null?void 0:me.profile_image_url)??(A[28].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`)),l.$set(ue);const ke={};G[0]&139264|G[3]&8&&(ke.$$scope={dirty:G,ctx:A}),i.$set(ke),G[0]&8192&&(f=((Me=A[13])==null?void 0:Me.files)&&((pe=A[13].files)==null?void 0:pe.filter(Bs).length)>0),f?v?(v.p(A,G),G[0]&8192&&k(v,1)):(v=is(A),v.c(),k(v,1),v.m(a,u)):v&&(le(),D(v,1,1,()=>{v=null}),se()),(((ye=A[13])==null?void 0:ye.statusHistory)??[...(_e=A[13])!=null&&_e.status?[(re=A[13])==null?void 0:re.status]:[]]).length>0?R?(R.p(Wt(A),G),G[0]&8192&&k(R,1)):(R=fs(Wt(A)),R.c(),k(R,1),R.m(h,g)):R&&(le(),D(R,1,1,()=>{R=null}),se());let U=_;_=S(A),_===U?L[_].p(A,G):(le(),D(L[U],1,1,()=>{L[U]=null}),se(),w=L[_],w?w.p(A,G):(w=L[_]=P[_](A),w.c()),k(w,1),w.m(h,null)),(!C||G[0]&8192&&I!==(I="chat-"+A[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&d(c,"class",I),A[14]?O&&(le(),D(O,1,1,()=>{O=null}),se()):O?(O.p(A,G),G[0]&16384&&k(O,1)):(O=gs(A),O.c(),k(O,1),O.m(a,null)),(!C||G[0]&8192&&b!==(b="flex w-full message-"+A[13].id+" svelte-1u5gq5j"))&&d(e,"class",b),(!C||G[0]&8192&&T!==(T="message-"+A[13].id))&&d(e,"id",T),(!C||G[0]&67108864&&B!==(B=A[26].chatDirection))&&d(e,"dir",B)},i(A){C||(k(l.$$.fragment,A),k(i.$$.fragment,A),k(v),k(R),k(w),k(O),C=!0)},o(A){D(l.$$.fragment,A),D(i.$$.fragment,A),D(v),D(R),D(w),D(O),C=!1},d(A){A&&m(e),x(l),x(i),v&&v.d(),R&&R.d(),L[_].d(),O&&O.d()}}}function pa(n){let e,t,l,s=n[13].id,r,i;function o(u){n[49](u)}let a={title:n[28].t("Delete message?")};n[16]!==void 0&&(a.show=n[16]),e=new Rn({props:a}),Fe.push(()=>Ke(e,"show",o)),e.$on("confirm",n[50]);let f=Ts(n);return{c(){Y(e.$$.fragment),l=H(),f.c(),r=ce()},l(u){X(e.$$.fragment,u),l=j(u),f.l(u),r=ce()},m(u,c){$(e,u,c),N(u,l,c),f.m(u,c),N(u,r,c),i=!0},p(u,c){const h={};c[0]&268435456&&(h.title=u[28].t("Delete message?")),!t&&c[0]&65536&&(t=!0,h.show=u[16],Ze(()=>t=!1)),e.$set(h),c[0]&8192&&Pe(s,s=u[13].id)?(le(),D(f,1,1,Ie),se(),f=Ts(u),f.c(),k(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(k(e.$$.fragment,u),k(f),i=!0)},o(u){D(e.$$.fragment,u),D(f),i=!1},d(u){u&&(m(l),m(r)),x(e,u),f.d(u)}}}const Bs=n=>n.type==="image",va=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},ba=n=>{n.target.select()},Ss=n=>n.slice(2),Os=n=>n.endsWith(",")?n.slice(0,-1):n;function ka(n,e,t){let l,s,r,i,o,a,f;Ce(n,At,W=>t(48,l=W)),Ce(n,zt,W=>t(26,s=W)),Ce(n,Dn,W=>t(27,r=W)),Ce(n,cl,W=>t(85,i=W)),Ce(n,Ut,W=>t(29,a=W)),Ce(n,Zt,W=>t(30,f=W));const u=Ye("i18n");Ce(n,u,W=>t(28,o=W));const c=_t();let{chatId:h=""}=e,{history:g}=e,{messageId:_}=e,w=JSON.parse(JSON.stringify(g.messages[_]));console.log("message",w);let{siblings:I}=e,{gotoMessage:V=()=>{}}=e,{showPreviousMessage:b}=e,{showNextMessage:T}=e,{updateChat:B}=e,{editMessage:C}=e,{saveMessage:v}=e,{rateMessage:R}=e,{actionMessage:P}=e,{deleteMessage:L}=e,{submitMessage:S}=e,{continueResponse:O}=e,{regenerateResponse:J}=e,{addMessages:ee}=e,{isLastMessage:fe=!0}=e,{readOnly:te=!1}=e,Q,he=!1,de=null,we=!1,A="",G,ue=!1,ke={},U=!1,ie,oe=!1,me=!1,Me=!1;const pe=async W=>{await Nn(W)&&qe.success(o.t("Copying to clipboard was successful!"))},ye=W=>new Promise(Te=>{ie=W;const Ne=ke[W];if(!Ne)return Te();Ne.play(),Ne.onended=async()=>{await new Promise(Le=>setTimeout(Le,300)),Object.keys(ke).length-1===W&&t(21,U=!1),Te()}}),_e=async()=>{var W,Te,Ne,Le,Xe,lt,Tt,ct,wt,je,$e,it,yt,Bt,Xt,$t,xt,el,tl,ll,sl,nl,rl;if(U){try{speechSynthesis.cancel(),ie!==void 0&&ke[ie]&&(ke[ie].pause(),ke[ie].currentTime=0)}catch{}t(21,U=!1),ie=void 0;return}if(!((w==null?void 0:w.content)??"").trim().length){qe.info(o.t("No content to speak"));return}if(t(21,U=!0),r.audio.tts.engine===""){let et=[];const pt=setInterval(()=>{var tt,dt,st;if(et=speechSynthesis.getVoices(),et.length>0){clearInterval(pt);const Ge=((tt=et==null?void 0:et.filter(mt=>{var il,ol,al,fl;return mt.voiceURI===(((ol=(il=s==null?void 0:s.audio)==null?void 0:il.tts)==null?void 0:ol.voice)??((fl=(al=r==null?void 0:r.audio)==null?void 0:al.tts)==null?void 0:fl.voice))}))==null?void 0:tt.at(0))??void 0;console.log(Ge);const ht=new SpeechSynthesisUtterance(w.content);ht.rate=((st=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:st.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(21,U=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},Ge&&(ht.voice=Ge),speechSynthesis.speak(ht)}},100)}else{t(22,oe=!0);const et=Dr(w.content,((Te=(W=r==null?void 0:r.audio)==null?void 0:W.tts)==null?void 0:Te.split_on)??"punctuation");if(!et.length){console.log("No content to speak"),qe.info(o.t("No content to speak")),t(21,U=!1),t(22,oe=!1);return}console.debug("Prepared message content for TTS",et),ke=et.reduce((tt,dt,st)=>(tt[st]=null,tt),{});let pt=Promise.resolve();if(((Le=(Ne=s.audio)==null?void 0:Ne.tts)==null?void 0:Le.engine)==="browser-kokoro"){i||(await cl.set(new Gr({dtype:((Tt=(lt=(Xe=s.audio)==null?void 0:Xe.tts)==null?void 0:lt.engineConfig)==null?void 0:Tt.dtype)??"fp32"})),await i.init());for(const[tt,dt]of et.entries()){const st=await i.generate({text:dt,voice:((wt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:wt.voice)??(($e=(je=r==null?void 0:r.audio)==null?void 0:je.tts)==null?void 0:$e.voice)}).catch(Ge=>{console.error(Ge),qe.error(`${Ge}`),t(21,U=!1),t(22,oe=!1)});if(st){const Ge=new Audio(st);Ge.playbackRate=((yt=(it=s.audio)==null?void 0:it.tts)==null?void 0:yt.playbackRate)??1,ke[tt]=Ge,t(22,oe=!1),pt=pt.then(()=>ye(tt))}}}else for(const[tt,dt]of et.entries()){const st=await Cr(localStorage.token,((Xt=(Bt=s==null?void 0:s.audio)==null?void 0:Bt.tts)==null?void 0:Xt.defaultVoice)===r.audio.tts.voice?((xt=($t=s==null?void 0:s.audio)==null?void 0:$t.tts)==null?void 0:xt.voice)??((tl=(el=r==null?void 0:r.audio)==null?void 0:el.tts)==null?void 0:tl.voice):(sl=(ll=r==null?void 0:r.audio)==null?void 0:ll.tts)==null?void 0:sl.voice,dt).catch(Ge=>{console.error(Ge),qe.error(`${Ge}`),t(21,U=!1),t(22,oe=!1)});if(st){const Ge=await st.blob(),ht=URL.createObjectURL(Ge),mt=new Audio(ht);mt.playbackRate=((rl=(nl=s.audio)==null?void 0:nl.tts)==null?void 0:rl.playbackRate)??1,ke[tt]=mt,t(22,oe=!1),pt=pt.then(()=>ye(tt))}}}};let re=[];function ve(W){const Te=[];let Ne=0;return W=W.replace(/<details[\s\S]*?<\/details>/gi,Le=>(Te.push(Le),`<details id="__DETAIL_${Ne++}__"/>`)),re=Te,W}function Oe(W){return W.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(Ne,Le)=>re[parseInt(Le)]||"")}const Ae=async()=>{t(14,we=!0),t(18,A=ve(w.content)),await Be(),t(19,G.style.height="",G),t(19,G.style.height=`${G.scrollHeight}px`,G)},K=async()=>{const W=Oe(A||"");C(w.id,W,!1),t(14,we=!1),t(18,A=""),await Be()},z=async()=>{const W=Oe(A||"");C(w.id,W),t(14,we=!1),t(18,A=""),await Be()},ne=async()=>{t(14,we=!1),t(18,A=""),await Be()},ge=async W=>{t(23,me=!0);const Te=await Tr(localStorage.token,W.content).catch(Ne=>{qe.error(`${Ne}`)});if(Te){const Ne=Te.map(Le=>({type:"image",url:`${Le.url}`}));v(W.id,{...W,files:Ne})}t(23,me=!1)};let be=!1;const Ve=async(W=null,Te=null)=>{var wt;t(25,be=!0),console.log("Feedback",W,Te);const Ne={...w,annotation:{...(w==null?void 0:w.annotation)??{},...W!==null?{rating:W}:{},...Te||{}}},Le=await Ir(localStorage.token,h).catch(je=>{qe.error(`${je}`)});if(!Le)return;const Xe=Jt(g,w.id);let lt={type:"rating",data:{...Ne!=null&&Ne.annotation?Ne.annotation:{},model_id:(w==null?void 0:w.selectedModelId)??w.model,...g.messages[w.parentId].childrenIds.length>1?{sibling_model_ids:g.messages[w.parentId].childrenIds.filter(je=>je!==w.id).map(je=>{var $e;return(($e=g.messages[je])==null?void 0:$e.selectedModelId)??g.messages[je].model})}:{}},meta:{arena:w?w.arena:!1,model_id:w.model,message_id:w.id,message_index:Xe.length,chat_id:h},snapshot:{chat:Le}};const Tt=[lt.data.model_id,...lt.data.sibling_model_ids??[]].reduce((je,$e)=>{var yt;const it=l.find(Bt=>Bt.id===$e);return it?je[it.id]=((yt=it==null?void 0:it.info)==null?void 0:yt.base_model_id)??null:console.warn(`Model with ID ${$e} not found`),je},{});lt.meta.base_models=Tt;let ct=null;if(w!=null&&w.feedbackId?ct=await ml(localStorage.token,w.feedbackId,lt).catch(je=>{qe.error(`${je}`)}):(ct=await Nr(localStorage.token,lt).catch(je=>{qe.error(`${je}`)}),ct&&(Ne.feedbackId=ct.id)),console.log(Ne),v(w.id,Ne),await Be(),!Te&&(t(24,Me=!0),!((wt=Ne.annotation)!=null&&wt.tags))){const je=await Vr(localStorage.token,w.model,Xe,h).catch($e=>(console.error($e),[]));console.log(je),je&&(Ne.annotation.tags=je,lt.data.tags=je,v(w.id,Ne),await ml(localStorage.token,Ne.feedbackId,lt).catch($e=>{qe.error(`${$e}`)}))}t(25,be=!1)},Re=async()=>{L(w.id)};kt(async()=>{await Be(),Q&&(console.log(Q),Q.addEventListener("wheel",function(W){W.preventDefault(),W.deltaY!==0&&t(15,Q.scrollLeft+=W.deltaY,Q)}))});function Je(W){he=W,t(16,he)}const nt=()=>{Re()};function ft(W){Fe[W?"unshift":"push"](()=>{G=W,t(19,G)})}function ut(){A=this.value,t(18,A)}const rt=W=>{var Le,Xe;W.key==="Escape"&&((Le=document.getElementById("close-edit-message-button"))==null||Le.click());const Te=W.metaKey||W.ctrlKey,Ne=W.key==="Enter";Te&&Ne&&((Xe=document.getElementById("confirm-edit-message-button"))==null||Xe.click())},Et=()=>{z()},Dt=()=>{ne()},Nt=()=>{K()},Vt=async W=>{console.log(W)},Ct=async(W,Te)=>{console.log(W,Te);let Ne=document.getElementById(`source-${w.id}-${Te}`);const Le=document.getElementById(`collapsible-${w.id}`);Ne?Ne.click():Le&&(Le.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(Xe=>{requestAnimationFrame(()=>{requestAnimationFrame(Xe)})}),Ne=document.getElementById(`source-${w.id}-${Te}`),Ne&&Ne.click())},Hn=({modelId:W,parentId:Te,messages:Ne})=>{ee({modelId:W,parentId:Te,messages:Ne})},jn=W=>{const{raw:Te,oldContent:Ne,newContent:Le}=W.detail;t(0,g.messages[w.id].content=g.messages[w.id].content.replace(Te,Te.replace(Ne,Le)),g),B()},An=W=>{var Le;const{type:Te,content:Ne}=W.detail;if(Te==="explain")S(w.id,`Explain this section to me in more detail

\`\`\`
${Ne}
\`\`\``);else if(Te==="ask"){const Xe=((Le=W.detail)==null?void 0:Le.input)??"";S(w.id,`\`\`\`
${Ne}
\`\`\`
${Xe}`)}},zn=()=>{b(w)},Un=W=>{V(w,W.target.value-1),t(20,ue=!1)},Wn=W=>{W.key==="Enter"&&(V(w,W.target.value-1),t(20,ue=!1))},qn=async()=>{t(20,ue=!0),await Be();const W=document.getElementById(`message-index-input-${w.id}`);W&&(W.focus(),W.select())},Fn=()=>{T(w)},Jn=()=>{Ae()},Gn=()=>{pe(w.content)},Zn=()=>{oe||_e()},Kn=()=>{me||ge(w)},Qn=()=>{console.log(w)},Yn=async()=>{await Ve(1),window.setTimeout(()=>{var W;(W=document.getElementById(`message-feedback-${w.id}`))==null||W.scrollIntoView()},0)},Xn=async()=>{await Ve(-1),window.setTimeout(()=>{var W;(W=document.getElementById(`message-feedback-${w.id}`))==null||W.scrollIntoView()},0)},$n=()=>{O()},xn=()=>{t(24,Me=!1),J(w),((de==null?void 0:de.actions)??[]).forEach(W=>{c("action",{id:W.id,event:{id:"regenerate-response",data:{messageId:w.id}}})})},er=()=>{t(16,he=!0)},tr=W=>{P(W.id,w)};function lr(W){Fe[W?"unshift":"push"](()=>{Q=W,t(15,Q)})}function sr(W){w=W,t(13,w),t(0,g),t(43,_)}function nr(W){Me=W,t(24,Me)}const rr=async W=>{await Ve(null,{...W.detail})};return n.$$set=W=>{"chatId"in W&&t(42,h=W.chatId),"history"in W&&t(0,g=W.history),"messageId"in W&&t(43,_=W.messageId),"siblings"in W&&t(1,I=W.siblings),"gotoMessage"in W&&t(2,V=W.gotoMessage),"showPreviousMessage"in W&&t(3,b=W.showPreviousMessage),"showNextMessage"in W&&t(4,T=W.showNextMessage),"updateChat"in W&&t(5,B=W.updateChat),"editMessage"in W&&t(44,C=W.editMessage),"saveMessage"in W&&t(45,v=W.saveMessage),"rateMessage"in W&&t(46,R=W.rateMessage),"actionMessage"in W&&t(6,P=W.actionMessage),"deleteMessage"in W&&t(47,L=W.deleteMessage),"submitMessage"in W&&t(7,S=W.submitMessage),"continueResponse"in W&&t(8,O=W.continueResponse),"regenerateResponse"in W&&t(9,J=W.regenerateResponse),"addMessages"in W&&t(10,ee=W.addMessages),"isLastMessage"in W&&t(11,fe=W.isLastMessage),"readOnly"in W&&t(12,te=W.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&8193|n.$$.dirty[1]&4096&&g.messages&&JSON.stringify(w)!==JSON.stringify(g.messages[_])&&t(13,w=JSON.parse(JSON.stringify(g.messages[_]))),n.$$.dirty[0]&8192|n.$$.dirty[1]&131072&&t(17,de=l.find(W=>W.id===w.model)),n.$$.dirty[0]&16384&&(we||(async()=>await Be())())},[g,I,V,b,T,B,P,S,O,J,ee,fe,te,w,we,Q,he,de,A,G,ue,U,oe,me,Me,be,s,r,o,a,f,u,c,pe,_e,Ae,K,z,ne,ge,Ve,Re,h,_,C,v,R,L,l,Je,nt,ft,ut,rt,Et,Dt,Nt,Vt,Ct,Hn,jn,An,zn,Un,Wn,qn,Fn,Jn,Gn,Zn,Kn,Qn,Yn,Xn,$n,xn,er,tr,lr,sr,nr,rr]}class Pn extends ze{constructor(e){super(),Ue(this,e,ka,pa,Pe,{chatId:42,history:0,messageId:43,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,updateChat:5,editMessage:44,saveMessage:45,rateMessage:46,actionMessage:6,deleteMessage:47,submitMessage:7,continueResponse:8,regenerateResponse:9,addMessages:10,isLastMessage:11,readOnly:12},null,[-1,-1,-1,-1])}}function wa(n){let e,t;return{c(){e=Ee("svg"),t=Ee("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){N(l,e,s),p(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:Ie,o:Ie,d(l){l&&m(e)}}}function ya(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ia extends ze{constructor(e){super(),Ue(this,e,ya,wa,Pe,{className:0,strokeWidth:1})}}function qt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function Rs(n,e,t){const l=n.slice();return l[38]=e[t],l}function Ft(n){const e=n.slice(),t=e[19][e[38]].messageIds[e[20][e[38]]];return e[41]=t,e}function Ls(n){let e,t,l,s,r,i=Se(Object.keys(n[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=As(Rs(n,i,u));const a=u=>D(o[u],1,1,()=>{o[u]=null});let f=!n[4]&&zs(n);return{c(){e=M("div"),t=M("div");for(let u=0;u<o.length;u+=1)o[u].c();s=H(),f&&f.c(),this.h()},l(u){e=E(u,"DIV",{});var c=y(e);t=E(c,"DIV",{class:!0,id:!0});var h=y(t);for(let g=0;g<o.length;g+=1)o[g].l(h);h.forEach(m),s=j(c),f&&f.l(c),c.forEach(m),this.h()},h(){d(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),d(t,"id",l="responses-container-"+n[1]+"-"+n[18].id)},m(u,c){N(u,e,c),p(e,t);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null);p(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&121241591){i=Se(Object.keys(u[19]));let h;for(h=0;h<i.length;h+=1){const g=Rs(u,i,h);o[h]?(o[h].p(g,c),k(o[h],1)):(o[h]=As(g),o[h].c(),k(o[h],1),o[h].m(t,null))}for(le(),h=i.length;h<o.length;h+=1)a(h);se()}(!r||c[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&d(t,"id",l),u[4]?f&&(le(),D(f,1,1,()=>{f=null}),se()):f?(f.p(u,c),c[0]&16&&k(f,1)):(f=zs(u),f.c(),k(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)k(o[c]);k(f),r=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)D(o[c]);D(f),r=!1},d(u){u&&m(e),Qe(o,u),f&&f.d()}}}function Ps(n){let e,t=n[0].currentId,l,s,r,i,o,a=js(n);function f(){return n[34](n[41])}return{c(){e=M("div"),a.c(),l=H(),this.h()},l(u){e=E(u,"DIV",{class:!0});var c=y(e);a.l(c),l=j(c),c.forEach(m),this.h()},h(){var u;d(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[38]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){N(u,e,c),a.m(e,null),p(e,l),r=!0,i||(o=ae(e,"click",f),i=!0)},p(u,c){var h;n=u,c[0]&1&&Pe(t,t=n[0].currentId)?(le(),D(a,1,1,Ie),se(),a=js(n),a.c(),k(a,1),a.m(e,l)):a.p(n,c),(!r||c[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((h=n[0].messages[n[2]])==null?void 0:h.modelIdx)==n[38]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&d(e,"class",s)},i(u){r||(k(a),r=!0)},o(u){D(a),r=!1},d(u){u&&m(e),a.d(u),i=!1,o()}}}function Hs(n){let e,t;function l(...o){return n[30](n[38],...o)}function s(){return n[31](n[38])}function r(){return n[32](n[38])}function i(...o){return n[33](n[38],...o)}return e=new Pn({props:{chatId:n[1],history:n[0],messageId:n[41],isLastMessage:!0,siblings:n[19][n[38]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:i,addMessages:n[14],readOnly:n[4]}}),{c(){Y(e.$$.fragment)},l(o){X(e.$$.fragment,o)},m(o,a){$(e,o,a),t=!0},p(o,a){n=o;const f={};a[0]&2&&(f.chatId=n[1]),a[0]&1&&(f.history=n[0]),a[0]&1572864&&(f.messageId=n[41]),a[0]&524288&&(f.siblings=n[19][n[38]].messageIds),a[0]&524288&&(f.gotoMessage=l),a[0]&524288&&(f.showPreviousMessage=s),a[0]&524288&&(f.showNextMessage=r),a[0]&32&&(f.updateChat=n[5]),a[0]&64&&(f.editMessage=n[6]),a[0]&128&&(f.saveMessage=n[7]),a[0]&256&&(f.rateMessage=n[8]),a[0]&2048&&(f.deleteMessage=n[11]),a[0]&512&&(f.actionMessage=n[9]),a[0]&1024&&(f.submitMessage=n[10]),a[0]&4096&&(f.continueResponse=n[12]),a[0]&1581056&&(f.regenerateResponse=i),a[0]&16384&&(f.addMessages=n[14]),a[0]&16&&(f.readOnly=n[4]),e.$set(f)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){x(e,o)}}}function js(n){let e,t,l=n[16]&&Hs(n);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,r){s[16]?l?(l.p(s,r),r[0]&65536&&k(l,1)):(l=Hs(s),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(s){t||(k(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function As(n){let e,t,l=n[20][n[38]]!==void 0&&n[19][n[38]].messageIds.length>0&&Ps(Ft(n));return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,r){s[20][s[38]]!==void 0&&s[19][s[38]].messageIds.length>0?l?(l.p(Ft(s),r),r[0]&1572864&&k(l,1)):(l=Ps(Ft(s)),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(s){t||(k(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function zs(n){let e=!Object.keys(n[19]).find(n[29]),t,l,s=e&&Us(n);return{c(){s&&s.c(),t=ce()},l(r){s&&s.l(r),t=ce()},m(r,i){s&&s.m(r,i),N(r,t,i),l=!0},p(r,i){i[0]&1572865&&(e=!Object.keys(r[19]).find(r[29])),e?s?(s.p(r,i),i[0]&1572865&&k(s,1)):(s=Us(r),s.c(),k(s,1),s.m(t.parentNode,t)):s&&(le(),D(s,1,1,()=>{s=null}),se())},i(r){l||(k(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function Us(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&Ws(qt(n)),i=n[3]&&Fs(n);return{c(){e=M("div"),t=M("div"),r&&r.c(),l=H(),i&&i.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=y(e);t=E(u,"DIV",{class:!0});var c=y(t);r&&r.l(c),c.forEach(m),l=j(u),i&&i.l(u),u.forEach(m),this.h()},h(){d(t,"class","w-full"),d(e,"class","flex justify-end")},m(f,u){N(f,e,u),p(e,t),r&&r.m(t,null),p(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,h;(h=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&h.status?r?(r.p(qt(f),u),u[0]&5&&k(r,1)):(r=Ws(qt(f)),r.c(),k(r,1),r.m(t,null)):r&&(le(),D(r,1,1,()=>{r=null}),se()),f[3]?i?(i.p(f,u),u[0]&8&&k(i,1)):(i=Fs(f),i.c(),k(i,1),i.m(e,null)):i&&(le(),D(i,1,1,()=>{i=null}),se())},i(f){s||(k(r),k(i),s=!0)},o(f){D(r),D(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function Ws(n){let e,t,l,s,r,i,o;t=new Kt({props:{$$slots:{default:[Ma]},$$scope:{ctx:n}}});const a=[Da,Ea],f=[];function u(c,h){var g;return(((g=c[16])==null?void 0:g.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=M("div"),Y(t.$$.fragment),l=H(),s=M("div"),i.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var h=y(e);X(t.$$.fragment,h),l=j(h),s=E(h,"DIV",{class:!0});var g=y(s);i.l(g),g.forEach(m),h.forEach(m),this.h()},h(){d(s,"class","mt-1 markdown-prose w-full min-w-full"),d(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,h){N(c,e,h),$(t,e,null),p(e,l),p(e,s),f[r].m(s,null),o=!0},p(c,h){const g={};h[0]&5|h[1]&2048&&(g.$$scope={dirty:h,ctx:c}),t.$set(g);let _=r;r=u(c),r===_?f[r].p(c,h):(le(),D(f[_],1,1,()=>{f[_]=null}),se(),i=f[r],i?i.p(c,h):(i=f[r]=a[r](c),i.c()),k(i,1),i.m(s,null))},i(c){o||(k(t.$$.fragment,c),k(i),o=!0)},o(c){D(t.$$.fragment,c),D(i),o=!1},d(c){c&&m(e),x(t),f[r].d()}}}function qs(n){let e,t=at(n[16].timestamp*1e3).format("LT")+"",l;return{c(){e=M("span"),l=q(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){N(s,e,r),p(e,l)},p(s,r){r[0]&5&&t!==(t=at(s[16].timestamp*1e3).format("LT")+"")&&Z(l,t)},d(s){s&&m(e)}}}function Ma(n){let e,t,l=n[16].timestamp&&qs(n);return{c(){e=q(`Merged Response

									`),l&&l.c(),t=ce()},l(s){e=F(s,`Merged Response

									`),l&&l.l(s),t=ce()},m(s,r){N(s,e,r),l&&l.m(s,r),N(s,t,r)},p(s,r){s[16].timestamp?l?l.p(s,r):(l=qs(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(m(e),m(t)),l&&l.d(s)}}}function Ea(n){let e,t;return e=new It({props:{id:"merged",content:n[16].content??""}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[16].content??""),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Da(n){let e,t;return e=new Yt({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:Ie,i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Fs(n){let e,t,l;return t=new He({props:{content:n[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[Na]},$$scope:{ctx:n}}}),{c(){e=M("div"),Y(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);X(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&4194304&&(i.content=s[22].t("Merge Responses")),r[1]&2048&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Na(n){let e,t,l,s,r;return t=new Ia({props:{className:" size-5 "}}),{c(){e=M("button"),Y(t.$$.fragment),this.h()},l(i){e=E(i,"BUTTON",{type:!0,id:!0,class:!0});var o=y(e);X(t.$$.fragment,o),o.forEach(m),this.h()},h(){d(e,"type","button"),d(e,"id","merge-response-button"),d(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){N(i,e,o),$(t,e,null),l=!0,s||(r=ae(e,"click",n[35]),s=!0)},p:Ie,i(i){l||(k(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&m(e),x(t),s=!1,r()}}}function Va(n){let e,t,l=n[18]&&Ls(n);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&k(l,1)):(l=Ls(s),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(le(),D(l,1,1,()=>{l=null}),se())},i(s){t||(k(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Ca(n,e,t){let l,s;Ce(n,En,U=>t(21,l=U));const r=Ye("i18n");Ce(n,r,U=>t(22,s=U)),at.extend(Vn);let{chatId:i}=e,{history:o}=e,{messageId:a}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:c}=e,{editMessage:h}=e,{saveMessage:g}=e,{rateMessage:_}=e,{actionMessage:w}=e,{submitMessage:I}=e,{deleteMessage:V}=e,{continueResponse:b}=e,{regenerateResponse:T}=e,{mergeResponses:B}=e,{addMessages:C}=e,{triggerScroll:v}=e;_t();let R,P,L={},S={},O=JSON.parse(JSON.stringify(o.messages[a]));const J=async(U,ie)=>{t(20,S[U]=Math.max(0,Math.min(ie,L[U].messageIds.length-1)),S);let oe=L[U].messageIds[S[U]];console.log(oe);let me=o.messages[oe].childrenIds;for(;me.length!==0;)oe=me.at(-1),me=o.messages[oe].childrenIds;t(0,o.currentId=oe,o),await Be(),await c(),v()},ee=async U=>{t(20,S[U]=Math.max(0,S[U]-1),S);let ie=L[U].messageIds[S[U]];console.log(ie);let oe=o.messages[ie].childrenIds;for(;oe.length!==0;)ie=oe.at(-1),oe=o.messages[ie].childrenIds;t(0,o.currentId=ie,o),await Be(),await c(),v()},fe=async U=>{t(20,S[U]=Math.min(L[U].messageIds.length-1,S[U]+1),S);let ie=L[U].messageIds[S[U]];console.log(ie);let oe=o.messages[ie].childrenIds;for(;oe.length!==0;)ie=oe.at(-1),oe=o.messages[ie].childrenIds;t(0,o.currentId=ie,o),await Be(),await c(),v()},te=async()=>{console.log("multiresponse:initHandler"),await Be(),t(17,R=a),t(18,P=o.messages[a].parentId?o.messages[o.messages[a].parentId]:null),t(19,L=P==null?void 0:P.models.reduce((U,ie,oe)=>{let me=P==null?void 0:P.childrenIds.map(Me=>o.messages[Me]).filter(Me=>(Me==null?void 0:Me.modelIdx)===oe).map(Me=>Me.id);if(me.length===0){let Me=P==null?void 0:P.childrenIds.map(pe=>o.messages[pe]).filter(pe=>(pe==null?void 0:pe.model)===ie);Me.forEach(pe=>{pe.modelIdx=oe}),me=Me.map(pe=>pe.id)}return{...U,[oe]:{messageIds:me}}},{})),t(20,S=P==null?void 0:P.models.reduce((U,ie,oe)=>{const me=L[oe].messageIds.findIndex(Me=>Me===a);return me!==-1?{...U,[oe]:me}:{...U,[oe]:L[oe].messageIds.length-1}},{})),console.log(L,S),await Be()},Q=async()=>{const U=Object.keys(L).map(ie=>{const{messageIds:oe}=L[ie],me=oe[S[ie]];return o.messages[me].content});B(a,U,i)};kt(async()=>{await te(),await Be();const U=document.getElementById(`message-${a}`);U&&U.scrollIntoView({block:"start"})});const he=U=>{var me;const{messageIds:ie}=L[U],oe=ie[S[U]];return!((me=o.messages[oe])!=null&&me.done)},de=(U,ie,oe)=>J(U,oe),we=U=>ee(U),A=U=>fe(U),G=async(U,ie)=>{T(ie),await Be(),t(20,S[U]=L[U].messageIds.length-1,S)},ue=async U=>{if(a!=U){let ie=U,oe=o.messages[ie].childrenIds;for(;oe.length!==0;)ie=oe.at(-1),oe=o.messages[ie].childrenIds;t(0,o.currentId=ie,o),await Be(),await c(),v()}},ke=()=>{Q()};return n.$$set=U=>{"chatId"in U&&t(1,i=U.chatId),"history"in U&&t(0,o=U.history),"messageId"in U&&t(2,a=U.messageId),"isLastMessage"in U&&t(3,f=U.isLastMessage),"readOnly"in U&&t(4,u=U.readOnly),"updateChat"in U&&t(5,c=U.updateChat),"editMessage"in U&&t(6,h=U.editMessage),"saveMessage"in U&&t(7,g=U.saveMessage),"rateMessage"in U&&t(8,_=U.rateMessage),"actionMessage"in U&&t(9,w=U.actionMessage),"submitMessage"in U&&t(10,I=U.submitMessage),"deleteMessage"in U&&t(11,V=U.deleteMessage),"continueResponse"in U&&t(12,b=U.continueResponse),"regenerateResponse"in U&&t(13,T=U.regenerateResponse),"mergeResponses"in U&&t(28,B=U.mergeResponses),"addMessages"in U&&t(14,C=U.addMessages),"triggerScroll"in U&&t(15,v=U.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&65541&&o.messages&&JSON.stringify(O)!==JSON.stringify(o.messages[a])&&t(16,O=JSON.parse(JSON.stringify(o.messages[a])))},[o,i,a,f,u,c,h,g,_,w,I,V,b,T,C,v,O,R,P,L,S,l,s,r,J,ee,fe,Q,B,he,de,we,A,G,ue,ke]}class Ta extends ze{constructor(e){super(),Ue(this,e,Ca,Va,Pe,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:28,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Js(n,e,t){const l=n.slice();return l[49]=e[t],l}function Gs(n){var s,r,i,o;let e,t,l;return t=new Cn({props:{src:n[7].user?((i=(r=(s=n[15].find(n[29]))==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:i.profile_image_url)??"/user.png":((o=n[0])==null?void 0:o.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=M("div"),Y(t.$$.fragment),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=y(e);X(t.$$.fragment,f),f.forEach(m),this.h()},h(){d(e,"class","shrink-0 ltr:mr-3 rtl:ml-3")},m(a,f){N(a,e,f),$(t,e,null),l=!0},p(a,f){var c,h,g,_;const u={};f[0]&32897&&(u.src=a[7].user?((g=(h=(c=a[15].find(a[29]))==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:g.profile_image_url)??"/user.png":((_=a[0])==null?void 0:_.profile_image_url)??"/user.png"),t.$set(u)},i(a){l||(k(t.$$.fragment,a),l=!0)},o(a){D(t.$$.fragment,a),l=!1},d(a){a&&m(e),x(t)}}}function Zs(n){let e,t,l;return t=new Kt({props:{$$slots:{default:[La]},$$scope:{ctx:n}}}),{c(){e=M("div"),Y(t.$$.fragment)},l(s){e=E(s,"DIV",{});var r=y(e);X(t.$$.fragment,r),r.forEach(m)},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&90241|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Ba(n){let e=n[13].t("You")+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&8192&&e!==(e=l[13].t("You")+"")&&Z(t,e)},d(l){l&&m(t)}}}function Sa(n){let e=n[0].name+"",t;return{c(){t=q(e)},l(l){t=F(l,e)},m(l,s){N(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&Z(t,e)},d(l){l&&m(t)}}}function Oa(n){var o;let e=n[13].t("You")+"",t,l,s,r=(((o=n[7])==null?void 0:o.user)??"")+"",i;return{c(){t=q(e),l=H(),s=M("span"),i=q(r),this.h()},l(a){t=F(a,e),l=j(a),s=E(a,"SPAN",{class:!0});var f=y(s);i=F(f,r),f.forEach(m),this.h()},h(){d(s,"class","text-gray-500 text-sm font-medium")},m(a,f){N(a,t,f),N(a,l,f),N(a,s,f),p(s,i)},p(a,f){var u;f[0]&8192&&e!==(e=a[13].t("You")+"")&&Z(t,e),f[0]&128&&r!==(r=(((u=a[7])==null?void 0:u.user)??"")+"")&&Z(i,r)},d(a){a&&(m(t),m(l),m(s))}}}function Ks(n){let e,t,l;return t=new He({props:{content:at(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[Ra]},$$scope:{ctx:n}}}),{c(){e=M("div"),Y(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);X(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){N(s,e,r),$(t,e,null),l=!0},p(s,r){const i={};r[0]&128&&(i.content=at(s[7].timestamp*1e3).format("LLLL")),r[0]&128|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(k(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Ra(n){let e,t=Ht(n[7].timestamp*1e3)+"",l;return{c(){e=M("span"),l=q(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){N(s,e,r),p(e,l)},p(s,r){r[0]&128&&t!==(t=Ht(s[7].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&m(e)}}}function La(n){let e,t,l;function s(a,f){return a[7].user?Oa:a[14].showUsername||a[16].name!==a[0].name?Sa:Ba}let r=s(n),i=r(n),o=n[7].timestamp&&Ks(n);return{c(){i.c(),e=H(),o&&o.c(),t=ce()},l(a){i.l(a),e=j(a),o&&o.l(a),t=ce()},m(a,f){i.m(a,f),N(a,e,f),o&&o.m(a,f),N(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[7].timestamp?o?(o.p(a,f),f[0]&128&&k(o,1)):(o=Ks(a),o.c(),k(o,1),o.m(t.parentNode,t)):o&&(le(),D(o,1,1,()=>{o=null}),se())},i(a){l||(k(o),l=!0)},o(a){D(o),l=!1},d(a){a&&(m(e),m(t)),i.d(a),o&&o.d(a)}}}function Qs(n){let e,t,l=Se(n[7].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Ys(Js(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=M("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=y(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){N(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&16512){l=Se(i[7].files);let a;for(a=0;a<l.length;a+=1){const f=Js(i,l,a);s[a]?(s[a].p(f,o),k(s[a],1)):(s[a]=Ys(f),s[a].c(),k(s[a],1),s[a].m(e,null))}for(le(),a=l.length;a<s.length;a+=1)r(a);se()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)k(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&m(e),Qe(s,i)}}}function Pa(n){var l;let e,t;return e=new Ur({props:{item:n[49],url:n[49].url,name:n[49].name,type:n[49].type,size:(l=n[49])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&128&&(i.item=s[49]),r[0]&128&&(i.url=s[49].url),r[0]&128&&(i.name=s[49].name),r[0]&128&&(i.type=s[49].type),r[0]&128&&(i.size=(o=s[49])==null?void 0:o.size),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Ha(n){let e,t;return e=new Bn({props:{src:n[49].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.src=l[49].url),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ys(n){let e,t,l,s,r,i;const o=[Ha,Pa],a=[];function f(u,c){return u[49].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=M("div"),l.c(),s=H(),this.h()},l(u){e=E(u,"DIV",{class:!0});var c=y(e);l.l(c),s=j(c),c.forEach(m),this.h()},h(){var u;d(e,"class",r=((u=n[14])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){N(u,e,c),a[t].m(e,null),p(e,s),i=!0},p(u,c){var g;let h=t;t=f(u),t===h?a[t].p(u,c):(le(),D(a[h],1,1,()=>{a[h]=null}),se(),l=a[t],l?l.p(u,c):(l=a[t]=o[t](u),l.c()),k(l,1),l.m(e,s)),(!i||c[0]&16384&&r!==(r=((g=u[14])==null?void 0:g.chatBubble)??!0?"self-end":""))&&d(e,"class",r)},i(u){i||(k(l),i=!0)},o(u){D(l),i=!1},d(u){u&&m(e),a[t].d()}}}function Xs(n){let e,t,l,s;const r=[Aa,ja],i=[];function o(a,f){return a[10]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),k(t,1),t.m(l.parentNode,l))},i(a){s||(k(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function ja(n){var B,C;let e,t,l,s,r,i,o,a,f,u,c,h,g,_,w=n[7].content&&$s(n),I=!(((B=n[14])==null?void 0:B.chatBubble)??!0)&&xs(n),V=!n[6]&&tn(n);u=new He({props:{content:n[13].t("Copy"),placement:"bottom",$$slots:{default:[qa]},$$scope:{ctx:n}}});let b=!n[6]&&(!n[5]||n[1].length>1)&&ln(n),T=(((C=n[14])==null?void 0:C.chatBubble)??!0)&&sn(n);return{c(){e=M("div"),t=M("div"),l=M("div"),w&&w.c(),i=H(),o=M("div"),I&&I.c(),a=H(),V&&V.c(),f=H(),Y(u.$$.fragment),c=H(),b&&b.c(),h=H(),T&&T.c(),this.h()},l(v){e=E(v,"DIV",{class:!0});var R=y(e);t=E(R,"DIV",{class:!0});var P=y(t);l=E(P,"DIV",{class:!0});var L=y(l);w&&w.l(L),L.forEach(m),P.forEach(m),i=j(R),o=E(R,"DIV",{class:!0});var S=y(o);I&&I.l(S),a=j(S),V&&V.l(S),f=j(S),X(u.$$.fragment,S),c=j(S),b&&b.l(S),h=j(S),T&&T.l(S),S.forEach(m),R.forEach(m),this.h()},h(){var v,R,P;d(l,"class",s="rounded-3xl "+(((v=n[14])==null?void 0:v.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[7].files?"rounded-tr-lg":""}`:" w-full")),d(t,"class",r="flex "+(((R=n[14])==null?void 0:R.chatBubble)??!0?"justify-end pb-1":"w-full")),d(o,"class",g="flex "+(((P=n[14])==null?void 0:P.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),d(e,"class","w-full")},m(v,R){N(v,e,R),p(e,t),p(t,l),w&&w.m(l,null),p(e,i),p(e,o),I&&I.m(o,null),p(o,a),V&&V.m(o,null),p(o,f),$(u,o,null),p(o,c),b&&b.m(o,null),p(o,h),T&&T.m(o,null),_=!0},p(v,R){var L,S,O,J,ee;v[7].content?w?(w.p(v,R),R[0]&128&&k(w,1)):(w=$s(v),w.c(),k(w,1),w.m(l,null)):w&&(le(),D(w,1,1,()=>{w=null}),se()),(!_||R[0]&16512&&s!==(s="rounded-3xl "+(((L=v[14])==null?void 0:L.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${v[7].files?"rounded-tr-lg":""}`:" w-full")))&&d(l,"class",s),(!_||R[0]&16384&&r!==(r="flex "+(((S=v[14])==null?void 0:S.chatBubble)??!0?"justify-end pb-1":"w-full")))&&d(t,"class",r),((O=v[14])==null?void 0:O.chatBubble)??!0?I&&(I.d(1),I=null):I?I.p(v,R):(I=xs(v),I.c(),I.m(o,a)),v[6]?V&&(le(),D(V,1,1,()=>{V=null}),se()):V?(V.p(v,R),R[0]&64&&k(V,1)):(V=tn(v),V.c(),k(V,1),V.m(o,f));const P={};R[0]&8192&&(P.content=v[13].t("Copy")),R[0]&128|R[1]&2097152&&(P.$$scope={dirty:R,ctx:v}),u.$set(P),!v[6]&&(!v[5]||v[1].length>1)?b?(b.p(v,R),R[0]&98&&k(b,1)):(b=ln(v),b.c(),k(b,1),b.m(o,h)):b&&(le(),D(b,1,1,()=>{b=null}),se()),((J=v[14])==null?void 0:J.chatBubble)??!0?T?T.p(v,R):(T=sn(v),T.c(),T.m(o,null)):T&&(T.d(1),T=null),(!_||R[0]&16384&&g!==(g="flex "+(((ee=v[14])==null?void 0:ee.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&d(o,"class",g)},i(v){_||(k(w),k(V),k(u.$$.fragment,v),k(b),_=!0)},o(v){D(w),D(V),D(u.$$.fragment,v),D(b),_=!1},d(v){v&&m(e),w&&w.d(),I&&I.d(),V&&V.d(),x(u),b&&b.d(),T&&T.d()}}}function Aa(n){let e,t,l,s,r,i,o,a,f=n[13].t("Save")+"",u,c,h,g,_=n[13].t("Cancel")+"",w,I,V,b=n[13].t("Send")+"",T,B,C;return{c(){e=M("div"),t=M("div"),l=M("textarea"),r=H(),i=M("div"),o=M("div"),a=M("button"),u=q(f),c=H(),h=M("div"),g=M("button"),w=q(_),I=H(),V=M("button"),T=q(b),this.h()},l(v){e=E(v,"DIV",{class:!0});var R=y(e);t=E(R,"DIV",{class:!0});var P=y(t);l=E(P,"TEXTAREA",{id:!0,class:!0}),y(l).forEach(m),P.forEach(m),r=j(R),i=E(R,"DIV",{class:!0});var L=y(i);o=E(L,"DIV",{});var S=y(o);a=E(S,"BUTTON",{id:!0,class:!0});var O=y(a);u=F(O,f),O.forEach(m),S.forEach(m),c=j(L),h=E(L,"DIV",{class:!0});var J=y(h);g=E(J,"BUTTON",{id:!0,class:!0});var ee=y(g);w=F(ee,_),ee.forEach(m),I=j(J),V=E(J,"BUTTON",{id:!0,class:!0});var fe=y(V);T=F(fe,b),fe.forEach(m),J.forEach(m),L.forEach(m),R.forEach(m),this.h()},h(){d(l,"id",s="message-edit-"+n[7].id),d(l,"class","bg-transparent outline-hidden w-full resize-none"),d(t,"class","max-h-96 overflow-auto"),d(a,"id","save-edit-message-button"),d(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(g,"id","close-edit-message-button"),d(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(V,"id","confirm-edit-message-button"),d(V,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(h,"class","flex space-x-1.5"),d(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(v,R){N(v,e,R),p(e,t),p(t,l),n[30](l),ot(l,n[11]),p(e,r),p(e,i),p(i,o),p(o,a),p(a,u),p(i,c),p(i,h),p(h,g),p(g,w),p(h,I),p(h,V),p(V,T),B||(C=[ae(l,"input",n[31]),ae(l,"input",Ka),ae(l,"keydown",n[32]),ae(a,"click",n[33]),ae(g,"click",n[34]),ae(V,"click",n[35])],B=!0)},p(v,R){R[0]&128&&s!==(s="message-edit-"+v[7].id)&&d(l,"id",s),R[0]&2048&&ot(l,v[11]),R[0]&8192&&f!==(f=v[13].t("Save")+"")&&Z(u,f),R[0]&8192&&_!==(_=v[13].t("Cancel")+"")&&Z(w,_),R[0]&8192&&b!==(b=v[13].t("Send")+"")&&Z(T,b)},i:Ie,o:Ie,d(v){v&&m(e),n[30](null),B=!1,xe(C)}}}function $s(n){let e,t;return e=new It({props:{id:n[7].id,content:n[7].content}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.id=l[7].id),s[0]&128&&(r.content=l[7].content),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function xs(n){let e,t=n[1].length>1&&en(n);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=en(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function en(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(g,_){return g[9]?Ua:za}let c=u(n),h=c(n);return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=H(),h.c(),r=H(),i=M("button"),i.innerHTML=o,this.h()},l(g){e=E(g,"DIV",{class:!0,dir:!0});var _=y(e);t=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),We(t)!=="svelte-buado9"&&(t.innerHTML=l),s=j(_),h.l(_),r=j(_),i=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),We(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(g,_){N(g,e,_),p(e,t),p(e,s),h.m(e,null),p(e,r),p(e,i),a||(f=[ae(t,"click",n[36]),ae(i,"click",n[40])],a=!0)},p(g,_){c===(c=u(g))&&h?h.p(g,_):(h.d(1),h=c(g),h&&(h.c(),h.m(e,r)))},d(g){g&&m(e),h.d(),a=!1,xe(f)}}}function za(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=M("div"),l=q(t),s=q("/"),i=q(r),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=y(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){N(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ae(e,"dblclick",n[39]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&m(e),o=!1,a()}}}function Ua(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=M("div"),t=M("input"),i=q("/"),a=q(o),this.h()},l(c){e=E(c,"DIV",{class:!0});var h=y(e);t=E(h,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(h,"/"),a=F(h,o),h.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[7].id),d(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,d(t,"min","1"),d(t,"max",r=n[1].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,h){N(c,e,h),p(e,t),p(e,i),p(e,a),f||(u=[ae(t,"focus",Qa),ae(t,"blur",n[37]),ae(t,"keydown",n[38])],f=!0)},p(c,h){h[0]&128&&l!==(l="message-index-input-"+c[7].id)&&d(t,"id",l),h[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),h[0]&2&&r!==(r=c[1].length)&&d(t,"max",r),h[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&m(e),f=!1,xe(u)}}}function tn(n){let e,t;return e=new He({props:{content:n[13].t("Edit"),placement:"bottom",$$slots:{default:[Wa]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Edit")),s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Wa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),We(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){N(r,e,i),l||(s=ae(e,"click",n[41]),l=!0)},p:Ie,d(r){r&&m(e),l=!1,s()}}}function qa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),We(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){N(r,e,i),l||(s=ae(e,"click",n[42]),l=!0)},p:Ie,d(r){r&&m(e),l=!1,s()}}}function ln(n){let e,t;return e=new He({props:{content:n[13].t("Delete"),placement:"bottom",$$slots:{default:[Fa]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Delete")),s[0]&256|s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Fa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),We(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){N(r,e,i),l||(s=ae(e,"click",n[43]),l=!0)},p:Ie,d(r){r&&m(e),l=!1,s()}}}function sn(n){let e,t=n[1].length>1&&nn(n);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=nn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function nn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(g,_){return g[9]?Ga:Ja}let c=u(n),h=c(n);return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=H(),h.c(),r=H(),i=M("button"),i.innerHTML=o,this.h()},l(g){e=E(g,"DIV",{class:!0,dir:!0});var _=y(e);t=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),We(t)!=="svelte-buado9"&&(t.innerHTML=l),s=j(_),h.l(_),r=j(_),i=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),We(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(g,_){N(g,e,_),p(e,t),p(e,s),h.m(e,null),p(e,r),p(e,i),a||(f=[ae(t,"click",n[44]),ae(i,"click",n[48])],a=!0)},p(g,_){c===(c=u(g))&&h?h.p(g,_):(h.d(1),h=c(g),h&&(h.c(),h.m(e,r)))},d(g){g&&m(e),h.d(),a=!1,xe(f)}}}function Ja(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=M("div"),l=q(t),s=q("/"),i=q(r),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=y(e);l=F(u,t),s=F(u,"/"),i=F(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){N(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ae(e,"dblclick",n[47]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&m(e),o=!1,a()}}}function Ga(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=M("div"),t=M("input"),i=q("/"),a=q(o),this.h()},l(c){e=E(c,"DIV",{class:!0});var h=y(e);t=E(h,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=F(h,"/"),a=F(h,o),h.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[7].id),d(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,d(t,"min","1"),d(t,"max",r=n[1].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,h){N(c,e,h),p(e,t),p(e,i),p(e,a),f||(u=[ae(t,"focus",Ya),ae(t,"blur",n[45]),ae(t,"keydown",n[46])],f=!0)},p(c,h){h[0]&128&&l!==(l="message-index-input-"+c[7].id)&&d(t,"id",l),h[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),h[0]&2&&r!==(r=c[1].length)&&d(t,"max",r),h[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&m(e),f=!1,xe(u)}}}function Za(n){var B,C;let e,t,l,s,r,i,o,a,f,u,c,h,g;function _(v){n[27](v)}let w={title:n[13].t("Delete message?")};n[8]!==void 0&&(w.show=n[8]),e=new Rn({props:w}),Fe.push(()=>Ke(e,"show",_)),e.$on("confirm",n[28]);let I=!(((B=n[14])==null?void 0:B.chatBubble)??!0)&&Gs(n),V=!(((C=n[14])==null?void 0:C.chatBubble)??!0)&&Zs(n),b=n[7].files&&Qs(n),T=n[7].content!==""&&Xs(n);return{c(){Y(e.$$.fragment),l=H(),s=M("div"),I&&I.c(),r=H(),i=M("div"),V&&V.c(),o=H(),a=M("div"),b&&b.c(),f=H(),T&&T.c(),this.h()},l(v){X(e.$$.fragment,v),l=j(v),s=E(v,"DIV",{class:!0,dir:!0,id:!0});var R=y(s);I&&I.l(R),r=j(R),i=E(R,"DIV",{class:!0});var P=y(i);V&&V.l(P),o=j(P),a=E(P,"DIV",{class:!0});var L=y(a);b&&b.l(L),f=j(L),T&&T.l(L),L.forEach(m),P.forEach(m),R.forEach(m),this.h()},h(){d(a,"class",u="chat-"+n[7].role+" w-full min-w-full markdown-prose"),d(i,"class","flex-auto w-0 max-w-full pl-1"),d(s,"class","flex w-full user-message"),d(s,"dir",c=n[14].chatDirection),d(s,"id",h="message-"+n[7].id)},m(v,R){$(e,v,R),N(v,l,R),N(v,s,R),I&&I.m(s,null),p(s,r),p(s,i),V&&V.m(i,null),p(i,o),p(i,a),b&&b.m(a,null),p(a,f),T&&T.m(a,null),g=!0},p(v,R){var L,S;const P={};R[0]&8192&&(P.title=v[13].t("Delete message?")),!t&&R[0]&256&&(t=!0,P.show=v[8],Ze(()=>t=!1)),e.$set(P),((L=v[14])==null?void 0:L.chatBubble)??!0?I&&(le(),D(I,1,1,()=>{I=null}),se()):I?(I.p(v,R),R[0]&16384&&k(I,1)):(I=Gs(v),I.c(),k(I,1),I.m(s,r)),((S=v[14])==null?void 0:S.chatBubble)??!0?V&&(le(),D(V,1,1,()=>{V=null}),se()):V?(V.p(v,R),R[0]&16384&&k(V,1)):(V=Zs(v),V.c(),k(V,1),V.m(i,o)),v[7].files?b?(b.p(v,R),R[0]&128&&k(b,1)):(b=Qs(v),b.c(),k(b,1),b.m(a,f)):b&&(le(),D(b,1,1,()=>{b=null}),se()),v[7].content!==""?T?(T.p(v,R),R[0]&128&&k(T,1)):(T=Xs(v),T.c(),k(T,1),T.m(a,null)):T&&(le(),D(T,1,1,()=>{T=null}),se()),(!g||R[0]&128&&u!==(u="chat-"+v[7].role+" w-full min-w-full markdown-prose"))&&d(a,"class",u),(!g||R[0]&16384&&c!==(c=v[14].chatDirection))&&d(s,"dir",c),(!g||R[0]&128&&h!==(h="message-"+v[7].id))&&d(s,"id",h)},i(v){g||(k(e.$$.fragment,v),k(I),k(V),k(b),k(T),g=!0)},o(v){D(e.$$.fragment,v),D(I),D(V),D(b),D(T),g=!1},d(v){v&&(m(l),m(s)),x(e,v),I&&I.d(),V&&V.d(),b&&b.d(),T&&T.d()}}}const Ka=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Qa=n=>{n.target.select()},Ya=n=>{n.target.select()};function Xa(n,e,t){let l,s,r,i;Ce(n,zt,K=>t(14,s=K)),Ce(n,At,K=>t(15,r=K)),Ce(n,Ut,K=>t(16,i=K));const o=Ye("i18n");Ce(n,o,K=>t(13,l=K)),at.extend(Vn);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{gotoMessage:h}=e,{showPreviousMessage:g}=e,{showNextMessage:_}=e,{editMessage:w}=e,{deleteMessage:I}=e,{isFirstMessage:V}=e,{readOnly:b}=e,T=!1,B=!1,C=!1,v="",R,P=JSON.parse(JSON.stringify(f.messages[u]));const L=async K=>{await Nn(K)&&qe.success(l.t("Copying to clipboard was successful!"))},S=async()=>{t(10,C=!0),t(11,v=P.content),await Be(),t(12,R.style.height="",R),t(12,R.style.height=`${R.scrollHeight}px`,R),R==null||R.focus()},O=async(K=!0)=>{w(P.id,v,K),t(10,C=!1),t(11,v="")},J=()=>{t(10,C=!1),t(11,v="")},ee=async()=>{I(P.id)};kt(()=>{});function fe(K){T=K,t(8,T)}const te=()=>{ee()},Q=K=>K.id===P.user;function he(K){Fe[K?"unshift":"push"](()=>{R=K,t(12,R)})}function de(){v=this.value,t(11,v)}const we=K=>{var ge,be;K.key==="Escape"&&((ge=document.getElementById("close-edit-message-button"))==null||ge.click());const z=K.metaKey||K.ctrlKey,ne=K.key==="Enter";z&&ne&&((be=document.getElementById("confirm-edit-message-button"))==null||be.click())},A=()=>{O(!1)},G=()=>{J()},ue=()=>{O()},ke=()=>{g(P)},U=K=>{h(P,K.target.value-1),t(9,B=!1)},ie=K=>{K.key==="Enter"&&(h(P,K.target.value-1),t(9,B=!1))},oe=async()=>{t(9,B=!0),await Be();const K=document.getElementById(`message-index-input-${P.id}`);K&&(K.focus(),K.select())},me=()=>{_(P)},Me=()=>{S()},pe=()=>{L(P.content)},ye=()=>{t(8,T=!0)},_e=()=>{g(P)},re=K=>{h(P,K.target.value-1),t(9,B=!1)},ve=K=>{K.key==="Enter"&&(h(P,K.target.value-1),t(9,B=!1))},Oe=async()=>{t(9,B=!0),await Be();const K=document.getElementById(`message-index-input-${P.id}`);K&&(K.focus(),K.select())},Ae=()=>{_(P)};return n.$$set=K=>{"user"in K&&t(0,a=K.user),"history"in K&&t(23,f=K.history),"messageId"in K&&t(24,u=K.messageId),"siblings"in K&&t(1,c=K.siblings),"gotoMessage"in K&&t(2,h=K.gotoMessage),"showPreviousMessage"in K&&t(3,g=K.showPreviousMessage),"showNextMessage"in K&&t(4,_=K.showNextMessage),"editMessage"in K&&t(25,w=K.editMessage),"deleteMessage"in K&&t(26,I=K.deleteMessage),"isFirstMessage"in K&&t(5,V=K.isFirstMessage),"readOnly"in K&&t(6,b=K.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&25165952&&f.messages&&JSON.stringify(P)!==JSON.stringify(f.messages[u])&&t(7,P=JSON.parse(JSON.stringify(f.messages[u])))},[a,c,h,g,_,V,b,P,T,B,C,v,R,l,s,r,i,o,L,S,O,J,ee,f,u,w,I,fe,te,Q,he,de,we,A,G,ue,ke,U,ie,oe,me,Me,pe,ye,_e,re,ve,Oe,Ae]}class $a extends ze{constructor(e){super(),Ue(this,e,Xa,Za,Pe,{user:0,history:23,messageId:24,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,editMessage:25,deleteMessage:26,isFirstMessage:5,readOnly:6},null,[-1,-1])}}function rn(n){let e,t,l,s;const r=[tf,ef,xa],i=[];function o(a,f){var u,c;return a[0].messages[a[3]].role==="user"?0:(((c=(u=a[0].messages[a[0].messages[a[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),N(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(le(),D(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),k(t,1),t.m(l.parentNode,l))},i(a){s||(k(t),s=!0)},o(a){D(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function xa(n){var i;let e,t,l;function s(o){n[22](o)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],mergeResponses:n[17],triggerScroll:n[19],addMessages:n[18],readOnly:n[20]};return n[0]!==void 0&&(r.history=n[0]),e=new Ta({props:r}),Fe.push(()=>Ke(e,"history",s)),{c(){Y(e.$$.fragment)},l(o){X(e.$$.fragment,o)},m(o,a){$(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&8&&(f.messageId=o[3]),a&9&&(f.isLastMessage=o[3]===((u=o[0])==null?void 0:u.currentId)),a&256&&(f.updateChat=o[8]),a&512&&(f.editMessage=o[9]),a&1024&&(f.saveMessage=o[10]),a&4096&&(f.rateMessage=o[12]),a&8192&&(f.actionMessage=o[13]),a&16384&&(f.submitMessage=o[14]),a&2048&&(f.deleteMessage=o[11]),a&65536&&(f.continueResponse=o[16]),a&32768&&(f.regenerateResponse=o[15]),a&131072&&(f.mergeResponses=o[17]),a&524288&&(f.triggerScroll=o[19]),a&262144&&(f.addMessages=o[18]),a&1048576&&(f.readOnly=o[20]),!t&&a&1&&(t=!0,f.history=o[0],Ze(()=>t=!1)),e.$set(f)},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){D(e.$$.fragment,o),l=!1},d(o){x(e,o)}}}function ef(n){var l;let e,t;return e=new Pn({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],addMessages:n[18],readOnly:n[20]}}),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&256&&(i.updateChat=s[8]),r&512&&(i.editMessage=s[9]),r&1024&&(i.saveMessage=s[10]),r&4096&&(i.rateMessage=s[12]),r&8192&&(i.actionMessage=s[13]),r&16384&&(i.submitMessage=s[14]),r&2048&&(i.deleteMessage=s[11]),r&65536&&(i.continueResponse=s[16]),r&32768&&(i.regenerateResponse=s[15]),r&262144&&(i.addMessages=s[18]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function tf(n){var l;let e,t;return e=new $a({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(on).map(an)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],editMessage:n[9],deleteMessage:n[11],readOnly:n[20]}}),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,r){$(e,s,r),t=!0},p(s,r){var o;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(on).map(an)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&512&&(i.editMessage=s[9]),r&2048&&(i.deleteMessage=s[11]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function lf(n){let e,t,l,s=n[0].messages[n[3]]&&rn(n);return{c(){e=M("div"),s&&s.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=y(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;d(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[21])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){N(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&k(s,1)):(s=rn(r),s.c(),k(s,1),s.m(e,null)):s&&(le(),D(s,1,1,()=>{s=null}),se()),(!l||i&2097152&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[21])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&d(e,"class",t)},i(r){l||(k(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const on=n=>(n==null?void 0:n.parentId)===null,an=n=>n==null?void 0:n.id;function sf(n,e,t){let l;Ce(n,zt,S=>t(21,l=S)),_t(),Ye("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:o}=e,{user:a}=e,{gotoMessage:f}=e,{showPreviousMessage:u}=e,{showNextMessage:c}=e,{updateChat:h}=e,{editMessage:g}=e,{saveMessage:_}=e,{deleteMessage:w}=e,{rateMessage:I}=e,{actionMessage:V}=e,{submitMessage:b}=e,{regenerateResponse:T}=e,{continueResponse:B}=e,{mergeResponses:C}=e,{addMessages:v}=e,{triggerScroll:R}=e,{readOnly:P=!1}=e;function L(S){i=S,t(0,i)}return n.$$set=S=>{"chatId"in S&&t(1,s=S.chatId),"idx"in S&&t(2,r=S.idx),"history"in S&&t(0,i=S.history),"messageId"in S&&t(3,o=S.messageId),"user"in S&&t(4,a=S.user),"gotoMessage"in S&&t(5,f=S.gotoMessage),"showPreviousMessage"in S&&t(6,u=S.showPreviousMessage),"showNextMessage"in S&&t(7,c=S.showNextMessage),"updateChat"in S&&t(8,h=S.updateChat),"editMessage"in S&&t(9,g=S.editMessage),"saveMessage"in S&&t(10,_=S.saveMessage),"deleteMessage"in S&&t(11,w=S.deleteMessage),"rateMessage"in S&&t(12,I=S.rateMessage),"actionMessage"in S&&t(13,V=S.actionMessage),"submitMessage"in S&&t(14,b=S.submitMessage),"regenerateResponse"in S&&t(15,T=S.regenerateResponse),"continueResponse"in S&&t(16,B=S.continueResponse),"mergeResponses"in S&&t(17,C=S.mergeResponses),"addMessages"in S&&t(18,v=S.addMessages),"triggerScroll"in S&&t(19,R=S.triggerScroll),"readOnly"in S&&t(20,P=S.readOnly)},[i,s,r,o,a,f,u,c,h,g,_,w,I,V,b,T,B,C,v,R,P,l,L]}class nf extends ze{constructor(e){super(),Ue(this,e,sf,lf,Pe,{chatId:1,idx:2,history:0,messageId:3,user:4,gotoMessage:5,showPreviousMessage:6,showNextMessage:7,updateChat:8,editMessage:9,saveMessage:10,deleteMessage:11,rateMessage:12,actionMessage:13,submitMessage:14,regenerateResponse:15,continueResponse:16,mergeResponses:17,addMessages:18,triggerScroll:19,readOnly:20})}}function fn(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function rf(n){let e,t,l,s;return{c(){e=M("div"),t=q(n[3]),l=q(" ‧ v"),s=q(dl),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=y(e);t=F(i,n[3]),l=F(i," ‧ v"),s=F(i,dl),i.forEach(m),this.h()},h(){d(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(r,i){N(r,e,i),p(e,t),p(e,l),p(e,s)},p(r,i){i&8&&Z(t,r[3])},i:Ie,o:Ie,d(r){r&&m(e)}}}function of(n){let e,t,l=n[2].t("Suggested")+"",s,r;return e=new Rr({}),{c(){Y(e.$$.fragment),t=H(),s=q(l)},l(i){X(e.$$.fragment,i),t=j(i),s=F(i,l)},m(i,o){$(e,i,o),N(i,t,o),N(i,s,o),r=!0},p(i,o){(!r||o&4)&&l!==(l=i[2].t("Suggested")+"")&&Z(s,l)},i(i){r||(k(e.$$.fragment,i),r=!0)},o(i){D(e.$$.fragment,i),r=!1},d(i){i&&(m(t),m(s)),x(e,i)}}}function un(n){let e=[],t=new Map,l,s=Se(n[1]);const r=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let o=fn(n,s,i),a=r(o);t.set(a,e[i]=cn(a,o))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=ce()},l(i){for(let o=0;o<e.length;o+=1)e[o].l(i);l=ce()},m(i,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,o);N(i,l,o)},p(i,o){o&38&&(s=Se(i[1]),e=Gt(e,o,r,1,i,s,t,l.parentNode,_r,cn,l,fn))},d(i){i&&m(l);for(let o=0;o<e.length;o+=1)e[o].d(i)}}}function af(n){let e,t=n[13].content+"",l,s,r,i=n[2].t("Prompt")+"",o;return{c(){e=M("div"),l=q(t),s=H(),r=M("div"),o=q(i),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=y(e);l=F(f,t),f.forEach(m),s=j(a),r=E(a,"DIV",{class:!0});var u=y(r);o=F(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){N(a,e,f),p(e,l),N(a,s,f),N(a,r,f),p(r,o)},p(a,f){f&2&&t!==(t=a[13].content+"")&&Z(l,t),f&4&&i!==(i=a[2].t("Prompt")+"")&&Z(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function ff(n){let e,t=n[13].title[0]+"",l,s,r,i=n[13].title[1]+"",o;return{c(){e=M("div"),l=q(t),s=H(),r=M("div"),o=q(i),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=y(e);l=F(f,t),f.forEach(m),s=j(a),r=E(a,"DIV",{class:!0});var u=y(r);o=F(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){N(a,e,f),p(e,l),N(a,s,f),N(a,r,f),p(r,o)},p(a,f){f&2&&t!==(t=a[13].title[0]+"")&&Z(l,t),f&2&&i!==(i=a[13].title[1]+"")&&Z(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function cn(n,e){let t,l,s,r,i;function o(c,h){return c[13].title&&c[13].title[0]!==""?ff:af}let a=o(e),f=a(e);function u(){return e[9](e[13])}return{key:n,first:null,c(){t=M("button"),l=M("div"),f.c(),s=H(),this.h()},l(c){t=E(c,"BUTTON",{class:!0,style:!0});var h=y(t);l=E(h,"DIV",{class:!0});var g=y(l);f.l(g),g.forEach(m),s=j(h),h.forEach(m),this.h()},h(){d(l,"class","flex flex-col text-left"),d(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),gt(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(c,h){N(c,t,h),p(t,l),f.m(l,null),p(t,s),r||(i=ae(t,"click",u),r=!0)},p(c,h){e=c,a===(a=o(e))&&f?f.p(e,h):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),h&2&&gt(t,"animation-delay",e[15]*60+"ms")},d(c){c&&m(t),f.d(),r=!1,i()}}}function uf(n){let e,t,l,s,r,i,o;const a=[of,rf],f=[];function u(h,g){return h[1].length>0?0:1}t=u(n),l=f[t]=a[t](n);let c=n[1].length>0&&un(n);return{c(){e=M("div"),l.c(),s=H(),r=M("div"),c&&c.c(),this.h()},l(h){e=E(h,"DIV",{class:!0});var g=y(e);l.l(g),g.forEach(m),s=j(h),r=E(h,"DIV",{class:!0});var _=y(r);c&&c.l(_),_.forEach(m),this.h()},h(){d(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),d(r,"class",i="h-40 overflow-auto scrollbar-none "+n[0]+" items-start svelte-1co34if")},m(h,g){N(h,e,g),f[t].m(e,null),N(h,s,g),N(h,r,g),c&&c.m(r,null),o=!0},p(h,[g]){let _=t;t=u(h),t===_?f[t].p(h,g):(le(),D(f[_],1,1,()=>{f[_]=null}),se(),l=f[t],l?l.p(h,g):(l=f[t]=a[t](h),l.c()),k(l,1),l.m(e,null)),h[1].length>0?c?c.p(h,g):(c=un(h),c.c(),c.m(r,null)):c&&(c.d(1),c=null),(!o||g&1&&i!==(i="h-40 overflow-auto scrollbar-none "+h[0]+" items-start svelte-1co34if"))&&d(r,"class",i)},i(h){o||(k(l),o=!0)},o(h){D(l),o=!1},d(h){h&&(m(e),m(s),m(r)),f[t].d(),c&&c.d()}}}function cf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function df(n,e,t){let l,s;Ce(n,kr,I=>t(3,s=I));const r=Ye("i18n");Ce(n,r,I=>t(2,l=I));const i=_t();let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,u=[];const c={keys:["content","title"],threshold:.5};let h,g=[];const _=I=>{if(I.length>500)t(1,g=[]);else{const V=I.trim()&&h?h.search(I.trim()).map(b=>b.item):u;cf(g,V)||t(1,g=V)}},w=I=>i("select",I.content);return n.$$set=I=>{"suggestionPrompts"in I&&t(6,o=I.suggestionPrompts),"className"in I&&t(0,a=I.className),"inputValue"in I&&t(7,f=I.inputValue)},n.$$.update=()=>{n.$$.dirty&192&&o&&(t(8,u=[...o??[]].sort(()=>Math.random()-.5)),_(f)),n.$$.dirty&256&&(h=new Fr(u,c)),n.$$.dirty&128&&_(f)},[a,g,l,s,r,i,o,f,u,w]}class hf extends ze{constructor(e){super(),Ue(this,e,df,uf,Pe,{suggestionPrompts:6,className:0,inputValue:7})}}function dn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function mf(n){let e,t;return{c(){e=M("img"),this.h()},l(l){e=E(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;d(e,"crossorigin","anonymous"),Lt(e.src,t=((r=(s=(l=n[14])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`))||d(e,"src",t),d(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),d(e,"alt","logo"),d(e,"draggable","false")},m(l,s){N(l,e,s)},p(l,s){var r,i,o;s&33&&!Lt(e.src,t=((o=(i=(r=l[14])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[5].language==="dg-DG"?"/doge.png":`${Pt}/static/favicon.png`))&&d(e,"src",t)},d(l){l&&m(e)}}}function hn(n){var a,f,u;let e,t,l,s,r,i;t=new He({props:{content:jt.parse(bt(((u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[mf]},$$scope:{ctx:n}}});function o(){return n[12](n[16])}return{c(){e=M("button"),Y(t.$$.fragment),l=H()},l(c){e=E(c,"BUTTON",{});var h=y(e);X(t.$$.fragment,h),l=j(h),h.forEach(m)},m(c,h){N(c,e,h),$(t,e,null),p(e,l),s=!0,r||(i=ae(e,"click",o),r=!0)},p(c,h){var _,w,I;n=c;const g={};h&17&&(g.content=jt.parse(bt(((I=(w=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:w.meta)==null?void 0:I.description)??""))),h&131105&&(g.$$scope={dirty:h,ctx:n}),t.$set(g)},i(c){s||(k(t.$$.fragment,c),s=!0)},o(c){D(t.$$.fragment,c),s=!1},d(c){c&&m(e),x(t),r=!1,i()}}}function mn(n){let e,t;return e=new He({props:{content:n[5].t("This chat won’t appear in history and your messages will not be saved."),className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[gf]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("This chat won’t appear in history and your messages will not be saved.")),s&131104&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function gf(n){let e,t,l=n[5].t("Temporary Chat")+"",s,r;return t=new Br({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=M("div"),Y(t.$$.fragment),s=q(l),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=y(e);X(t.$$.fragment,o),s=F(o,l),o.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(i,o){N(i,e,o),$(t,e,null),p(e,s),r=!0},p(i,o){(!r||o&32)&&l!==(l=i[5].t("Temporary Chat")+"")&&Z(s,l)},i(i){r||(k(t.$$.fragment,i),r=!0)},o(i){D(t.$$.fragment,i),r=!1},d(i){i&&m(e),x(t)}}}function _f(n){var l;let e=n[5].t("Hello, {{name}}",{name:(l=n[7])==null?void 0:l.name})+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){N(s,t,r)},p(s,r){var i;r&160&&e!==(e=s[5].t("Hello, {{name}}",{name:(i=s[7])==null?void 0:i.name})+"")&&Z(t,e)},d(s){s&&m(t)}}}function pf(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=q(e)},l(s){t=F(s,e)},m(s,r){N(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&Z(t,e)},d(s){s&&m(t)}}}function vf(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=M("div"),l=q(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=y(e);l=F(r,t),r.forEach(m),this.h()},h(){d(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){N(s,e,r),p(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&Z(l,t)},d(s){s&&m(e)}}}function bf(n){var o,a,f,u,c,h;let e,t,l=jt.parse(bt((f=(a=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description))+"",s,r,i=((h=(c=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:h.user)&&gn(n);return{c(){e=M("div"),t=new mr(!1),s=H(),i&&i.c(),r=ce(),this.h()},l(g){e=E(g,"DIV",{class:!0});var _=y(e);t=gr(_,!1),_.forEach(m),s=j(g),i&&i.l(g),r=ce(),this.h()},h(){t.a=null,d(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(g,_){N(g,e,_),t.m(l,e),N(g,s,_),i&&i.m(g,_),N(g,r,_)},p(g,_){var w,I,V,b,T,B;_&17&&l!==(l=jt.parse(bt((V=(I=(w=g[0][g[4]])==null?void 0:w.info)==null?void 0:I.meta)==null?void 0:V.description))+"")&&t.p(l),(B=(T=(b=g[0][g[4]])==null?void 0:b.info)==null?void 0:T.meta)!=null&&B.user?i?i.p(g,_):(i=gn(g),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(g){g&&(m(e),m(s),m(r)),i&&i.d(g)}}}function gn(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?wf:kf}let s=l(n),r=s(n);return{c(){e=M("div"),t=q(`By
								`),r.c(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=y(e);t=F(o,`By
								`),r.l(o),o.forEach(m),this.h()},h(){d(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){N(i,e,o),p(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function kf(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=q(e)},l(i){t=F(i,e)},m(i,o){N(i,t,o)},p(i,o){var a,f,u;o&17&&e!==(e=((u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&Z(t,e)},d(i){i&&m(t)}}}function wf(n){var r,i,o,a,f,u,c,h,g;let e,t=((o=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(g=(h=(c=n[0][n[4]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:g.user.username}`)+"",l,s;return{c(){e=M("a"),l=q(t),this.h()},l(_){e=E(_,"A",{href:!0});var w=y(e);l=F(w,t),w.forEach(m),this.h()},h(){var _,w,I;d(e,"href",s="https://openwebui.com/m/"+((I=(w=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:w.meta)==null?void 0:I.user.username))},m(_,w){N(_,e,w),p(e,l)},p(_,w){var I,V,b,T,B,C,v,R,P,L,S,O;w&17&&t!==(t=((b=(V=(I=_[0][_[4]])==null?void 0:I.info)==null?void 0:V.meta)!=null&&b.user.name?(C=(B=(T=_[0][_[4]])==null?void 0:T.info)==null?void 0:B.meta)==null?void 0:C.user.name:`@${(P=(R=(v=_[0][_[4]])==null?void 0:v.info)==null?void 0:R.meta)==null?void 0:P.user.username}`)+"")&&Z(l,t),w&17&&s!==(s="https://openwebui.com/m/"+((O=(S=(L=_[0][_[4]])==null?void 0:L.info)==null?void 0:S.meta)==null?void 0:O.user.username))&&d(e,"href",s)},d(_){_&&m(e)}}}function _n(n){var ee,fe,te,Q,he,de,we;let e,t,l,s,r,i,o,a,f,u,c,h,g,_,w,I,V,b,T=Se(n[0]),B=[];for(let A=0;A<T.length;A+=1)B[A]=hn(dn(n,T,A));const C=A=>D(B[A],1,1,()=>{B[A]=null});let v=n[6]&&mn(n);function R(A,G){var ue;return(ue=A[0][A[4]])!=null&&ue.name?pf:_f}let P=R(n),L=P(n);function S(A,G){var ue,ke,U;return((U=(ke=(ue=A[0][A[4]])==null?void 0:ue.info)==null?void 0:ke.meta)==null?void 0:U.description)??null?bf:vf}let O=S(n),J=O(n);return I=new hf({props:{className:"grid grid-cols-2",suggestionPrompts:((te=(fe=(ee=n[1])==null?void 0:ee.info)==null?void 0:fe.meta)==null?void 0:te.suggestion_prompts)??((de=(he=(Q=n[0][n[4]])==null?void 0:Q.info)==null?void 0:he.meta)==null?void 0:de.suggestion_prompts)??((we=n[8])==null?void 0:we.default_prompt_suggestions)??[]}}),I.$on("select",n[13]),{c(){e=M("div"),t=M("div"),l=M("div");for(let A=0;A<B.length;A+=1)B[A].c();r=H(),v&&v.c(),i=H(),o=M("div"),a=M("div"),f=M("div"),L.c(),c=H(),h=M("div"),J.c(),_=H(),w=M("div"),Y(I.$$.fragment),this.h()},l(A){e=E(A,"DIV",{class:!0});var G=y(e);t=E(G,"DIV",{class:!0});var ue=y(t);l=E(ue,"DIV",{class:!0});var ke=y(l);for(let pe=0;pe<B.length;pe+=1)B[pe].l(ke);ke.forEach(m),ue.forEach(m),r=j(G),v&&v.l(G),i=j(G),o=E(G,"DIV",{class:!0});var U=y(o);a=E(U,"DIV",{});var ie=y(a);f=E(ie,"DIV",{class:!0});var oe=y(f);L.l(oe),oe.forEach(m),c=j(ie),h=E(ie,"DIV",{});var me=y(h);J.l(me),me.forEach(m),ie.forEach(m),U.forEach(m),_=j(G),w=E(G,"DIV",{class:!0});var Me=y(w);X(I.$$.fragment,Me),Me.forEach(m),G.forEach(m),this.h()},h(){d(l,"class","flex -space-x-4 mb-0.5"),d(t,"class","flex justify-start"),d(f,"class","capitalize line-clamp-1"),d(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),d(w,"class","w-full font-primary"),d(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(A,G){N(A,e,G),p(e,t),p(t,l);for(let ue=0;ue<B.length;ue+=1)B[ue]&&B[ue].m(l,null);p(e,r),v&&v.m(e,null),p(e,i),p(e,o),p(o,a),p(a,f),L.m(f,null),p(a,c),p(a,h),J.m(h,null),p(e,_),p(e,w),$(I,w,null),b=!0},p(A,G){var ke,U,ie,oe,me,Me,pe;if(G&49){T=Se(A[0]);let ye;for(ye=0;ye<T.length;ye+=1){const _e=dn(A,T,ye);B[ye]?(B[ye].p(_e,G),k(B[ye],1)):(B[ye]=hn(_e),B[ye].c(),k(B[ye],1),B[ye].m(l,null))}for(le(),ye=T.length;ye<B.length;ye+=1)C(ye);se()}A[6]?v?(v.p(A,G),G&64&&k(v,1)):(v=mn(A),v.c(),k(v,1),v.m(e,i)):v&&(le(),D(v,1,1,()=>{v=null}),se()),P===(P=R(A))&&L?L.p(A,G):(L.d(1),L=P(A),L&&(L.c(),L.m(f,null))),O===(O=S(A))&&J?J.p(A,G):(J.d(1),J=O(A),J&&(J.c(),J.m(h,null)));const ue={};G&275&&(ue.suggestionPrompts=((ie=(U=(ke=A[1])==null?void 0:ke.info)==null?void 0:U.meta)==null?void 0:ie.suggestion_prompts)??((Me=(me=(oe=A[0][A[4]])==null?void 0:oe.info)==null?void 0:me.meta)==null?void 0:Me.suggestion_prompts)??((pe=A[8])==null?void 0:pe.default_prompt_suggestions)??[]),I.$set(ue)},i(A){if(!b){for(let G=0;G<T.length;G+=1)k(B[G]);A&&(s||St(()=>{s=Ot(l,Rt,{duration:200}),s.start()})),k(v),A&&(u||St(()=>{u=Ot(f,Rt,{duration:200}),u.start()})),A&&(g||St(()=>{g=Ot(h,Rt,{duration:200,delay:200}),g.start()})),k(I.$$.fragment,A),A&&(V||St(()=>{V=Ot(w,Rt,{duration:200,delay:300}),V.start()})),b=!0}},o(A){B=B.filter(Boolean);for(let G=0;G<B.length;G+=1)D(B[G]);D(v),D(I.$$.fragment,A),b=!1},d(A){A&&m(e),Qe(B,A),v&&v.d(),L.d(),J.d(),x(I)}}}function yf(n){let e=n[3],t,l,s=_n(n);return{c(){s.c(),t=ce()},l(r){s.l(r),t=ce()},m(r,i){s.m(r,i),N(r,t,i),l=!0},p(r,[i]){i&8&&Pe(e,e=r[3])?(le(),D(s,1,1,Ie),se(),s=_n(r),s.c(),k(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(k(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(t),s.d(r)}}}function If(n,e,t){let l,s,r,i,o;Ce(n,At,V=>t(11,l=V)),Ce(n,Zt,V=>t(6,r=V)),Ce(n,Ut,V=>t(7,i=V)),Ce(n,Dn,V=>t(8,o=V));const a=Ye("i18n");Ce(n,a,V=>t(5,s=V));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{submitPrompt:h}=e,g=!1,_=0;kt(()=>{t(3,g=!0)});const w=V=>{t(4,_=V)},I=V=>{h(V.detail)};return n.$$set=V=>{"modelIds"in V&&t(10,f=V.modelIds),"models"in V&&t(0,u=V.models),"atSelectedModel"in V&&t(1,c=V.atSelectedModel),"submitPrompt"in V&&t(2,h=V.submitPrompt)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(V=>l.find(b=>b.id===V))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,h,g,_,s,r,i,o,a,f,l,w,I]}class Mf extends ze{constructor(e){super(),Ue(this,e,If,yf,Pe,{modelIds:10,models:0,atSelectedModel:1,submitPrompt:2})}}function pn(n,e,t){const l=n.slice();return l[51]=e[t],l[53]=t,l}function Ef(n){let e,t=n[3],l,s=In(n);return{c(){e=M("div"),s.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=y(e);s.l(i),i.forEach(m),this.h()},h(){d(e,"class","w-full pt-2")},m(r,i){N(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&Pe(t,t=r[3])?(le(),D(s,1,1,Ie),se(),s=In(r),s.c(),k(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(k(s),l=!0)},o(r){D(s),l=!1},d(r){r&&m(e),s.d(r)}}}function Df(n){let e,t;return e=new Mf({props:{modelIds:n[5],atSelectedModel:n[6],submitPrompt:n[41]}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&64&&(r.atSelectedModel=l[6]),s[0]&1048578&&(r.submitPrompt=l[41]),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function vn(n){let e,t;return e=new Wr({props:{$$slots:{default:[Nf]},$$scope:{ctx:n}}}),e.$on("visible",n[42]),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const r={};s[1]&8388608&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Nf(n){let e,t,l,s,r="Loading...",i;return t=new Mt({props:{className:" size-4"}}),{c(){e=M("div"),Y(t.$$.fragment),l=H(),s=M("div"),s.textContent=r,this.h()},l(o){e=E(o,"DIV",{class:!0});var a=y(e);X(t.$$.fragment,a),l=j(a),s=E(a,"DIV",{class:!0,"data-svelte-h":!0}),We(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(m),this.h()},h(){d(s,"class",""),d(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){N(o,e,a),$(t,e,null),p(e,l),p(e,s),i=!0},p:Ie,i(o){i||(k(t.$$.fragment,o),i=!0)},o(o){D(t.$$.fragment,o),i=!1},d(o){o&&m(e),x(t)}}}function bn(n,e){let t,l,s,r;function i(a){e[43](a)}let o={chatId:e[3],messageId:e[51].id,idx:e[53],user:e[4],gotoMessage:e[25],showPreviousMessage:e[26],showNextMessage:e[27],updateChat:e[24],editMessage:e[29],deleteMessage:e[32],rateMessage:e[28],actionMessage:e[30],saveMessage:e[31],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[33],readOnly:e[12]};return e[0]!==void 0&&(o.history=e[0]),l=new nf({props:o}),Fe.push(()=>Ke(l,"history",i)),{key:n,first:null,c(){t=ce(),Y(l.$$.fragment),this.h()},l(a){t=ce(),X(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){N(a,t,f),$(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&262144&&(u.messageId=e[51].id),f[0]&262144&&(u.idx=e[53]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ze(()=>s=!1)),l.$set(u)},i(a){r||(k(l.$$.fragment,a),r=!0)},o(a){D(l.$$.fragment,a),r=!1},d(a){a&&m(t),x(l,a)}}}function kn(n){let e,t,l,s,r="Loading...",i;return t=new Mt({props:{className:" size-4"}}),{c(){e=M("div"),Y(t.$$.fragment),l=H(),s=M("div"),s.textContent=r,this.h()},l(o){e=E(o,"DIV",{class:!0});var a=y(e);X(t.$$.fragment,a),l=j(a),s=E(a,"DIV",{class:!0,"data-svelte-h":!0}),We(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(m),this.h()},h(){d(s,"class",""),d(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){N(o,e,a),$(t,e,null),p(e,l),p(e,s),i=!0},i(o){i||(k(t.$$.fragment,o),i=!0)},o(o){D(t.$$.fragment,o),i=!1},d(o){o&&m(e),x(t)}}}function wn(n){var ee;let e,t,l,s,r,i,o,a,f,u,c,h,g=((ee=n[21])==null?void 0:ee.cost)+"",_,w,I,V="<div>Upgrade to the Plus plan  or try again tomorrow</div>",b,T,B,C,v,R="Subscribe to Plus and Get more wirh <strong>$15</strong>",P,L,S="",O,J;return{c(){e=M("div"),t=M("div"),l=M("div"),s=M("div"),r=M("div"),i=M("div"),o=M("div"),a=M("div"),f=M("div"),u=q("You've reached your daily usage limit. You have spent "),c=M("strong"),h=q("USD $"),_=q(g),w=H(),I=M("div"),I.innerHTML=V,b=H(),T=M("div"),B=M("button"),C=M("div"),v=M("button"),v.innerHTML=R,P=H(),L=M("div"),L.innerHTML=S,this.h()},l(fe){e=E(fe,"DIV",{class:!0});var te=y(e);t=E(te,"DIV",{class:!0});var Q=y(t);l=E(Q,"DIV",{class:!0});var he=y(l);s=E(he,"DIV",{style:!0});var de=y(s);r=E(de,"DIV",{class:!0});var we=y(r);i=E(we,"DIV",{class:!0});var A=y(i);o=E(A,"DIV",{class:!0});var G=y(o);a=E(G,"DIV",{class:!0});var ue=y(a);f=E(ue,"DIV",{class:!0});var ke=y(f);u=F(ke,"You've reached your daily usage limit. You have spent "),c=E(ke,"STRONG",{});var U=y(c);h=F(U,"USD $"),_=F(U,g),U.forEach(m),ke.forEach(m),w=j(ue),I=E(ue,"DIV",{class:!0,"data-svelte-h":!0}),We(I)!=="svelte-vyo7wz"&&(I.innerHTML=V),ue.forEach(m),b=j(G),T=E(G,"DIV",{class:!0});var ie=y(T);B=E(ie,"BUTTON",{class:!0});var oe=y(B);C=E(oe,"DIV",{class:!0});var me=y(C);v=E(me,"BUTTON",{class:!0,"data-svelte-h":!0}),We(v)!=="svelte-3u8002"&&(v.innerHTML=R),me.forEach(m),oe.forEach(m),ie.forEach(m),G.forEach(m),P=j(A),L=E(A,"DIV",{class:!0,"data-svelte-h":!0}),We(L)!=="svelte-yzis9k"&&(L.innerHTML=S),A.forEach(m),we.forEach(m),de.forEach(m),he.forEach(m),Q.forEach(m),te.forEach(m),this.h()},h(){d(f,"class","font-bold text-token-text-primary"),d(I,"class","text-token-text-secondary"),d(a,"class","flex max-w-none flex-col"),d(v,"class","btn relative btn-primary shrink-0"),d(C,"class","flex items-center justify-center"),d(B,"class","btn relative btn-primary shrink-0"),d(T,"class","flex shrink-0 gap-2 pb-1 md:pb-0"),d(o,"class","mt-1.5 flex grow items-start gap-4 md:mt-0 md:flex-row md:items-center md:justify-between md:gap-8 flex-col"),d(L,"class","flex shrink-0 items-center gap-2"),d(i,"class","flex h-full w-full items-start gap-3 md:items-center"),d(r,"class","flex w-full items-start gap-4 rounded-3xl border py-4 pl-5 pr-3 text-sm [text-wrap:pretty] dark:border-transparent lg:mx-auto shadow-xxs md:items-center border-token-border-light bg-token-main-surface-primary text-token-text-primary dark:bg-token-main-surface-secondary"),gt(s,"opacity","1"),gt(s,"transform","translateY(0px)"),gt(s,"will-change","auto"),d(l,"class","flex flex-col gap-3.5 "),d(t,"class","relative h-full w-full border-1 rounded-2xl border-token-border-light bg-token-main-surface-primary text-token-text-primary dark:bg-token-main-surface-secondary"),d(e,"class","flex flex-col justify-between px-5 mb-3 w-full max-w-5xl mx-auto rounded-lg group")},m(fe,te){N(fe,e,te),p(e,t),p(t,l),p(l,s),p(s,r),p(r,i),p(i,o),p(o,a),p(a,f),p(f,u),p(f,c),p(c,h),p(c,_),p(a,w),p(a,I),p(o,b),p(o,T),p(T,B),p(B,C),p(C,v),p(i,P),p(i,L),O||(J=ae(v,"click",n[44]),O=!0)},p(fe,te){var Q;te[0]&2097152&&g!==(g=((Q=fe[21])==null?void 0:Q.cost)+"")&&Z(_,g)},d(fe){fe&&m(e),O=!1,J()}}}function yn(n){let e;return{c(){e=M("div"),this.h()},l(t){e=E(t,"DIV",{class:!0}),y(e).forEach(m),this.h()},h(){d(e,"class","pb-6")},m(t,l){N(t,e,l)},d(t){t&&m(e)}}}function In(n){var T;let e,t=((T=n[18].at(0))==null?void 0:T.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,c,h,g=t&&vn(n),_=Se(n[18]);const w=B=>B[51].id;for(let B=0;B<_.length;B+=1){let C=pn(n,_,B),v=w(C);r.set(v,s[B]=bn(v,C))}let I=n[19]&&kn(),V=n[21].cost>1&&n[21].is_user_subscription_valid==!1&&wn(n),b=n[13]&&yn();return{c(){e=M("div"),g&&g.c(),l=H();for(let B=0;B<s.length;B+=1)s[B].c();i=H(),I&&I.c(),o=H(),V&&V.c(),a=H(),f=M("div"),u=H(),b&&b.c(),c=ce(),this.h()},l(B){e=E(B,"DIV",{class:!0});var C=y(e);g&&g.l(C),l=j(C);for(let v=0;v<s.length;v+=1)s[v].l(C);i=j(C),I&&I.l(C),o=j(C),V&&V.l(C),C.forEach(m),a=j(B),f=E(B,"DIV",{class:!0}),y(f).forEach(m),u=j(B),b&&b.l(B),c=ce(),this.h()},h(){d(e,"class","w-full"),d(f,"class","pb-12")},m(B,C){N(B,e,C),g&&g.m(e,null),p(e,l);for(let v=0;v<s.length;v+=1)s[v]&&s[v].m(e,null);p(e,i),I&&I.m(e,null),p(e,o),V&&V.m(e,null),N(B,a,C),N(B,f,C),N(B,u,C),b&&b.m(B,C),N(B,c,C),h=!0},p(B,C){var v;C[0]&262144&&(t=((v=B[18].at(0))==null?void 0:v.parentId)!==null),t?g?(g.p(B,C),C[0]&262144&&k(g,1)):(g=vn(B),g.c(),k(g,1),g.m(e,l)):g&&(le(),D(g,1,1,()=>{g=null}),se()),C[0]&2130976665|C[1]&7&&(_=Se(B[18]),le(),s=Gt(s,C,w,1,B,_,r,e,Mn,bn,i,pn),se()),B[19]?I?C[0]&524288&&k(I,1):(I=kn(),I.c(),k(I,1),I.m(e,o)):I&&(le(),D(I,1,1,()=>{I=null}),se()),B[21].cost>1&&B[21].is_user_subscription_valid==!1?V?V.p(B,C):(V=wn(B),V.c(),V.m(e,null)):V&&(V.d(1),V=null),B[13]?b||(b=yn(),b.c(),b.m(c.parentNode,c)):b&&(b.d(1),b=null)},i(B){if(!h){k(g);for(let C=0;C<_.length;C+=1)k(s[C]);k(I),h=!0}},o(B){D(g);for(let C=0;C<s.length;C+=1)D(s[C]);D(I),h=!1},d(B){B&&(m(e),m(a),m(f),m(u),m(c)),g&&g.d();for(let C=0;C<s.length;C+=1)s[C].d();I&&I.d(),V&&V.d(),b&&b.d(B)}}}function Vf(n){let e,t,l,s,r,i,o,a;function f(_){n[40](_)}let u={citation:n[15],showPercentage:n[16],showRelevance:n[17]};n[14]!==void 0&&(u.show=n[14]),e=new qr({props:u}),Fe.push(()=>Ke(e,"show",f));const c=[Df,Ef],h=[];function g(_,w){var I;return w[0]&1&&(r=null),r==null&&(r=Object.keys(((I=_[0])==null?void 0:I.messages)??{}).length==0),r?0:1}return i=g(n,[-1,-1]),o=h[i]=c[i](n),{c(){Y(e.$$.fragment),l=H(),s=M("div"),o.c(),this.h()},l(_){X(e.$$.fragment,_),l=j(_),s=E(_,"DIV",{class:!0});var w=y(s);o.l(w),w.forEach(m),this.h()},h(){d(s,"class",n[2])},m(_,w){$(e,_,w),N(_,l,w),N(_,s,w),h[i].m(s,null),a=!0},p(_,w){const I={};w[0]&32768&&(I.citation=_[15]),w[0]&65536&&(I.showPercentage=_[16]),w[0]&131072&&(I.showRelevance=_[17]),!t&&w[0]&16384&&(t=!0,I.show=_[14],Ze(()=>t=!1)),e.$set(I);let V=i;i=g(_,w),i===V?h[i].p(_,w):(le(),D(h[V],1,1,()=>{h[V]=null}),se(),o=h[i],o?o.p(_,w):(o=h[i]=c[i](_),o.c()),k(o,1),o.m(s,null)),(!a||w[0]&4)&&d(s,"class",_[2])},i(_){a||(k(e.$$.fragment,_),k(o),a=!0)},o(_){D(e.$$.fragment,_),D(o),a=!1},d(_){_&&(m(l),m(s)),x(e,_),h[i].d()}}}function Cf(n,e,t){let l,s,r,i,o,a;Ce(n,zt,z=>t(45,l=z)),Ce(n,hl,z=>t(46,s=z)),Ce(n,Zt,z=>t(47,r=z)),Ce(n,Ut,z=>t(48,i=z)),Ce(n,wr,z=>t(21,a=z)),_t();let f=!1,u=null,c=!1,h=!0;const g=Ye("i18n");Ce(n,g,z=>t(20,o=z));let{className:_="h-full flex pt-8"}=e,{chatId:w=""}=e,{user:I=i}=e,{prompt:V}=e,{history:b=[]}=e,{selectedModels:T}=e,{atSelectedModel:B}=e,C=[],{sendPrompt:v}=e,{continueResponse:R}=e,{regenerateResponse:P}=e,{mergeResponses:L}=e,{chatActionHandler:S}=e,{showMessage:O=()=>{}}=e,{submitMessage:J=()=>{}}=e,{addMessages:ee=()=>{}}=e,{readOnly:fe=!1}=e,{bottomPadding:te=!1}=e,{autoScroll:Q}=e,{userSettings:he={}}=e,de=20,we=!1;const A=async()=>{const z=document.getElementById("messages-container");z.scrollTop=z.scrollTop+100,t(19,we=!0),t(39,de+=20),await Be(),t(19,we=!1)},G=()=>{const z=document.getElementById("messages-container");z.scrollTop=z.scrollHeight},ue=async()=>{r||(t(0,b),await Be(),await Mr(localStorage.token,w,{history:b,messages:C}),hl.set(1),await yr.set(await Er(localStorage.token,s)))},ke=async(z,ne)=>{let ge;z.parentId!==null?ge=b.messages[z.parentId].childrenIds:ge=Object.values(b.messages).filter(Ve=>Ve.parentId===null).map(Ve=>Ve.id),ne=Math.max(0,Math.min(ne,ge.length-1));let be=ge[ne];if(z.id!==be){let Ve=b.messages[be].childrenIds;for(;Ve.length!==0;)be=Ve.at(-1),Ve=b.messages[be].childrenIds;t(0,b.currentId=be,b)}if(await Be(),(l==null?void 0:l.scrollOnBranchChange)??!0){const Ve=document.getElementById("messages-container");t(34,Q=Ve.scrollHeight-Ve.scrollTop<=Ve.clientHeight+50),setTimeout(()=>{G()},100)}},U=async z=>{if(z.parentId!==null){let ne=b.messages[z.parentId].childrenIds[Math.max(b.messages[z.parentId].childrenIds.indexOf(z.id)-1,0)];if(z.id!==ne){let ge=b.messages[ne].childrenIds;for(;ge.length!==0;)ne=ge.at(-1),ge=b.messages[ne].childrenIds;t(0,b.currentId=ne,b)}}else{let ne=Object.values(b.messages).filter(be=>be.parentId===null).map(be=>be.id),ge=ne[Math.max(ne.indexOf(z.id)-1,0)];if(z.id!==ge){let be=b.messages[ge].childrenIds;for(;be.length!==0;)ge=be.at(-1),be=b.messages[ge].childrenIds;t(0,b.currentId=ge,b)}}if(await Be(),(l==null?void 0:l.scrollOnBranchChange)??!0){const ne=document.getElementById("messages-container");t(34,Q=ne.scrollHeight-ne.scrollTop<=ne.clientHeight+50),setTimeout(()=>{G()},100)}},ie=async z=>{if(z.parentId!==null){let ne=b.messages[z.parentId].childrenIds[Math.min(b.messages[z.parentId].childrenIds.indexOf(z.id)+1,b.messages[z.parentId].childrenIds.length-1)];if(z.id!==ne){let ge=b.messages[ne].childrenIds;for(;ge.length!==0;)ne=ge.at(-1),ge=b.messages[ne].childrenIds;t(0,b.currentId=ne,b)}}else{let ne=Object.values(b.messages).filter(be=>be.parentId===null).map(be=>be.id),ge=ne[Math.min(ne.indexOf(z.id)+1,ne.length-1)];if(z.id!==ge){let be=b.messages[ge].childrenIds;for(;be.length!==0;)ge=be.at(-1),be=b.messages[ge].childrenIds;t(0,b.currentId=ge,b)}}if(await Be(),(l==null?void 0:l.scrollOnBranchChange)??!0){const ne=document.getElementById("messages-container");t(34,Q=ne.scrollHeight-ne.scrollTop<=ne.clientHeight+50),setTimeout(()=>{G()},100)}},oe=async(z,ne)=>{t(0,b.messages[z].annotation={...b.messages[z].annotation,rating:ne},b),await ue()},me=async(z,ne,ge=!0)=>{if(b.messages[z].role==="user")if(ge){let be=ne,Ve=uuidv4(),Re={id:Ve,parentId:b.messages[z].parentId,childrenIds:[],role:"user",content:be,...b.messages[z].files&&{files:b.messages[z].files},models:T,timestamp:Math.floor(Date.now()/1e3)},Je=b.messages[z].parentId;Je!==null&&t(0,b.messages[Je].childrenIds=[...b.messages[Je].childrenIds,Ve],b),t(0,b.messages[Ve]=Re,b),t(0,b.currentId=Ve,b),await Be(),await v(b,be,Ve)}else t(0,b.messages[z].content=ne,b),await ue();else if(ge){const be=uuidv4(),Ve=b.messages[z],Re=Ve.parentId,Je={...Ve,id:be,parentId:Re,childrenIds:[],files:void 0,content:ne,timestamp:Math.floor(Date.now()/1e3)};t(0,b.messages[be]=Je,b),t(0,b.currentId=be,b),Re!==null&&t(0,b.messages[Re].childrenIds=[...b.messages[Re].childrenIds,be],b),await ue()}else t(0,b.messages[z].originalContent=b.messages[z].content,b),t(0,b.messages[z].content=ne,b),await ue()},Me=async(z,ne,ge=null)=>{await S(w,z,ne.model,ne.id,ge)},pe=async(z,ne)=>{t(0,b.messages[z]=ne,b),await ue()},ye=async z=>{const ne=b.messages[z],ge=ne.parentId,be=ne.childrenIds??[],Ve=be.flatMap(Re=>{var Je;return((Je=b.messages[Re])==null?void 0:Je.childrenIds)??[]});ge&&b.messages[ge]&&t(0,b.messages[ge].childrenIds=[...b.messages[ge].childrenIds.filter(Re=>Re!==z),...Ve],b),Ve.forEach(Re=>{b.messages[Re]&&t(0,b.messages[Re].parentId=ge,b)}),[z,...be].forEach(Re=>{delete b.messages[Re]}),await Be(),O({id:ge}),await ue()},_e=()=>{if(Q){const z=document.getElementById("messages-container");t(34,Q=z.scrollHeight-z.scrollTop<=z.clientHeight+50),setTimeout(()=>{G()},100)}};function re(z){f=z,t(14,f)}const ve=async z=>{let ne=z;if(z.includes("{{CLIPBOARD}}")){const ge=await navigator.clipboard.readText().catch(be=>(qe.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));ne=z.replaceAll("{{CLIPBOARD}}",ge)}t(1,V=ne),await Be()},Oe=z=>{console.log("visible"),we||A()};function Ae(z){b=z,t(0,b)}const K=()=>{t(14,f=!0),t(16,c=!0),t(17,h=!0),t(16,c=!0),t(15,u="plus")};return n.$$set=z=>{"className"in z&&t(2,_=z.className),"chatId"in z&&t(3,w=z.chatId),"user"in z&&t(4,I=z.user),"prompt"in z&&t(1,V=z.prompt),"history"in z&&t(0,b=z.history),"selectedModels"in z&&t(5,T=z.selectedModels),"atSelectedModel"in z&&t(6,B=z.atSelectedModel),"sendPrompt"in z&&t(35,v=z.sendPrompt),"continueResponse"in z&&t(7,R=z.continueResponse),"regenerateResponse"in z&&t(8,P=z.regenerateResponse),"mergeResponses"in z&&t(9,L=z.mergeResponses),"chatActionHandler"in z&&t(36,S=z.chatActionHandler),"showMessage"in z&&t(37,O=z.showMessage),"submitMessage"in z&&t(10,J=z.submitMessage),"addMessages"in z&&t(11,ee=z.addMessages),"readOnly"in z&&t(12,fe=z.readOnly),"bottomPadding"in z&&t(13,te=z.bottomPadding),"autoScroll"in z&&t(34,Q=z.autoScroll),"userSettings"in z&&t(38,he=z.userSettings)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&256)if(b.currentId){let z=[],ne=b.messages[b.currentId];for(;ne&&z.length<=de;)z.unshift({...ne}),ne=ne.parentId!==null?b.messages[ne.parentId]:null;t(18,C=z)}else t(18,C=[]);n.$$.dirty[0]&8192|n.$$.dirty[1]&8&&Q&&te&&(async()=>(await Be(),G()))()},[b,V,_,w,I,T,B,R,P,L,J,ee,fe,te,f,u,c,h,C,we,o,a,g,A,ue,ke,U,ie,oe,me,Me,pe,ye,_e,Q,v,S,O,he,de,re,ve,Oe,Ae,K]}class hu extends ze{constructor(e){super(),Ue(this,e,Cf,Vf,Pe,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:35,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:36,showMessage:37,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:34,userSettings:38},null,[-1,-1])}}export{Gr as K,hu as M,hf as S};
//# sourceMappingURL=DvsQLqqp.js.map
